[debug] [2025-11-20T17:38:51.568Z] ----------------------------------------------------------------------
[debug] [2025-11-20T17:38:51.571Z] Command:       /opt/homebrew/Cellar/node/24.4.1/bin/node /opt/homebrew/bin/firebase deploy --only firestore:rules
[debug] [2025-11-20T17:38:51.571Z] CLI Version:   14.25.1
[debug] [2025-11-20T17:38:51.571Z] Platform:      darwin
[debug] [2025-11-20T17:38:51.571Z] Node Version:  v24.4.1
[debug] [2025-11-20T17:38:51.571Z] Time:          Thu Nov 20 2025 19:38:51 GMT+0200 (Israel Standard Time)
[debug] [2025-11-20T17:38:51.571Z] ----------------------------------------------------------------------
[debug] 
[debug] [2025-11-20T17:38:51.572Z] >>> [apiv2][query] GET https://firebase-public.firebaseio.com/cli.json [none]
[debug] [2025-11-20T17:38:51.691Z] > command requires scopes: ["email","openid","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","https://www.googleapis.com/auth/cloud-platform"]
[debug] [2025-11-20T17:38:51.691Z] > authorizing via signed-in user (orel895@gmail.com)
[debug] [2025-11-20T17:38:51.691Z] [iam] checking project eyalamrami-1d69e for permissions ["datastore.indexes.create","datastore.indexes.delete","datastore.indexes.list","datastore.indexes.update","firebase.projects.get"]
[debug] [2025-11-20T17:38:51.692Z] Checked if tokens are valid: false, expires at: 1763652105309
[debug] [2025-11-20T17:38:51.692Z] Checked if tokens are valid: false, expires at: 1763652105309
[debug] [2025-11-20T17:38:51.692Z] > refreshing access token with scopes: []
[debug] [2025-11-20T17:38:51.692Z] >>> [apiv2][query] POST https://www.googleapis.com/oauth2/v3/token [none]
[debug] [2025-11-20T17:38:51.692Z] >>> [apiv2][body] POST https://www.googleapis.com/oauth2/v3/token [omitted]
[debug] [2025-11-20T17:38:51.887Z] <<< [apiv2][status] POST https://www.googleapis.com/oauth2/v3/token 200
[debug] [2025-11-20T17:38:51.888Z] <<< [apiv2][body] POST https://www.googleapis.com/oauth2/v3/token [omitted]
[debug] [2025-11-20T17:38:51.913Z] >>> [apiv2][query] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions [none]
[debug] [2025-11-20T17:38:51.913Z] >>> [apiv2][(partial)header] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions x-goog-quota-user=projects/eyalamrami-1d69e
[debug] [2025-11-20T17:38:51.913Z] >>> [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions {"permissions":["datastore.indexes.create","datastore.indexes.delete","datastore.indexes.list","datastore.indexes.update","firebase.projects.get"]}
[debug] [2025-11-20T17:38:52.039Z] <<< [apiv2][status] GET https://firebase-public.firebaseio.com/cli.json 200
[debug] [2025-11-20T17:38:52.039Z] <<< [apiv2][body] GET https://firebase-public.firebaseio.com/cli.json {"cloudBuildErrorAfter":1594252800000,"cloudBuildWarnAfter":1590019200000,"defaultNode10After":1594252800000,"minVersion":"3.0.5","node8DeploysDisabledAfter":1613390400000,"node8RuntimeDisabledAfter":1615809600000,"node8WarnAfter":1600128000000}
[debug] [2025-11-20T17:38:52.895Z] <<< [apiv2][status] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions 200
[debug] [2025-11-20T17:38:52.895Z] <<< [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions {"permissions":["datastore.indexes.create","datastore.indexes.delete","datastore.indexes.list","datastore.indexes.update","firebase.projects.get"]}
[info] 
[info] === Deploying to 'eyalamrami-1d69e'...
[info] 
[info] i  deploying firestore 
[info] i  firestore: ensuring required API firestore.googleapis.com is enabled... 
[info] i  firestore: ensuring required API firestore.googleapis.com is enabled... 
[debug] [2025-11-20T17:38:52.900Z] Checked if tokens are valid: true, expires at: 1763663930888
[debug] [2025-11-20T17:38:52.900Z] Checked if tokens are valid: true, expires at: 1763663930888
[debug] [2025-11-20T17:38:52.900Z] >>> [apiv2][query] GET https://firestore.googleapis.com/v1/projects/eyalamrami-1d69e/databases/(default) [none]
[debug] [2025-11-20T17:38:53.462Z] <<< [apiv2][status] GET https://firestore.googleapis.com/v1/projects/eyalamrami-1d69e/databases/(default) 200
[debug] [2025-11-20T17:38:53.462Z] <<< [apiv2][body] GET https://firestore.googleapis.com/v1/projects/eyalamrami-1d69e/databases/(default) {"name":"projects/eyalamrami-1d69e/databases/(default)","uid":"28c72577-e069-422d-b53f-9211ba17d04d","createTime":"2025-11-16T21:56:31.041581Z","updateTime":"2025-11-16T21:56:31.041581Z","locationId":"europe-west2","type":"FIRESTORE_NATIVE","concurrencyMode":"PESSIMISTIC","versionRetentionPeriod":"3600s","earliestVersionTime":"2025-11-20T16:38:53.577464Z","appEngineIntegrationMode":"DISABLED","keyPrefix":"g","pointInTimeRecoveryEnablement":"POINT_IN_TIME_RECOVERY_DISABLED","deleteProtectionState":"DELETE_PROTECTION_DISABLED","databaseEdition":"STANDARD","freeTier":true,"realtimeUpdatesMode":"REALTIME_UPDATES_MODE_ENABLED","etag":"IKrkv92igZEDMMXn/oLW95AD"}
[info] i  firestore: reading indexes from firestore.indexes.json... 
[info] i  cloud.firestore: checking firestore.rules for compilation errors... 
[debug] [2025-11-20T17:38:53.464Z] Checked if tokens are valid: true, expires at: 1763663930888
[debug] [2025-11-20T17:38:53.464Z] Checked if tokens are valid: true, expires at: 1763663930888
[debug] [2025-11-20T17:38:53.464Z] >>> [apiv2][query] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test [none]
[debug] [2025-11-20T17:38:53.464Z] >>> [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test [omitted]
[debug] [2025-11-20T17:38:54.315Z] <<< [apiv2][status] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test 200
[debug] [2025-11-20T17:38:54.315Z] <<< [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test {}
[info] ✔  cloud.firestore: rules file firestore.rules compiled successfully 
[debug] [2025-11-20T17:38:54.317Z] Checked if tokens are valid: true, expires at: 1763663930888
[debug] [2025-11-20T17:38:54.317Z] Checked if tokens are valid: true, expires at: 1763663930888
[debug] [2025-11-20T17:38:54.318Z] >>> [apiv2][query] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases pageSize=10&pageToken=
[debug] [2025-11-20T17:38:54.600Z] <<< [apiv2][status] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases 200
[debug] [2025-11-20T17:38:54.601Z] <<< [apiv2][body] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases {"releases":[{"name":"projects/eyalamrami-1d69e/releases/cloud.firestore","rulesetName":"projects/eyalamrami-1d69e/rulesets/95b14c26-3777-47b4-9c72-18fc0d96f97f","createTime":"2025-11-16T21:56:37.010939Z","updateTime":"2025-11-20T14:22:19.914128Z"},{"name":"projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app","rulesetName":"projects/eyalamrami-1d69e/rulesets/638302fc-2049-483c-8442-32ccd0950f40","createTime":"2025-11-16T21:57:38.715272Z","updateTime":"2025-11-20T14:22:36.089686Z"}]}
[debug] [2025-11-20T17:38:54.624Z] Checked if tokens are valid: true, expires at: 1763663930888
[debug] [2025-11-20T17:38:54.625Z] Checked if tokens are valid: true, expires at: 1763663930888
[debug] [2025-11-20T17:38:54.625Z] >>> [apiv2][query] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets/95b14c26-3777-47b4-9c72-18fc0d96f97f [none]
[debug] [2025-11-20T17:38:55.296Z] <<< [apiv2][status] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets/95b14c26-3777-47b4-9c72-18fc0d96f97f 200
[debug] [2025-11-20T17:38:55.296Z] <<< [apiv2][body] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets/95b14c26-3777-47b4-9c72-18fc0d96f97f [omitted]
[info] i  firestore: uploading rules firestore.rules... 
[debug] [2025-11-20T17:38:55.297Z] Checked if tokens are valid: true, expires at: 1763663930888
[debug] [2025-11-20T17:38:55.298Z] Checked if tokens are valid: true, expires at: 1763663930888
[debug] [2025-11-20T17:38:55.298Z] >>> [apiv2][query] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets [none]
[debug] [2025-11-20T17:38:55.298Z] >>> [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets [omitted]
[debug] [2025-11-20T17:38:55.702Z] <<< [apiv2][status] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets 200
[debug] [2025-11-20T17:38:55.702Z] <<< [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets {"name":"projects/eyalamrami-1d69e/rulesets/759dde9d-eb39-467d-9ca1-a623ac445240","source":{"files":[{"content":"rules_version = '2';\nservice cloud.firestore {\n  match /databases/{database}/documents {\n    \n    // ========== HELPER FUNCTIONS ==========\n    \n    function isSignedIn() {\n      return request.auth != null;\n    }\n    \n    function isAdmin() {\n      return isSignedIn() &&\n             get(/databases/$(database)/documents/users/$(request.auth.uid)).data.role == 'admin';\n    }\n    \n    // ========== USERS COLLECTION ==========\n    match /users/{uid} {\n      // Users can read/write their own document\n      allow read: if request.auth != null && request.auth.uid == uid;\n      allow write: if request.auth != null && request.auth.uid == uid;\n      \n      // Admins can write role field\n      allow update: if isAdmin() && \n                    request.resource.data.diff(resource.data).affectedKeys().hasOnly(['role']);\n    }\n    \n    // ========== DAILY INSIGHTS COLLECTION ==========\n    match /dailyInsights/{dateId} {\n      // Everyone can read published insights\n      allow read: if true;\n      \n      // Only admins can write\n      allow write: if isAdmin();\n    }\n    \n    // ========== DAILY STORIES COLLECTION ==========\n    match /dailyStories/{dateId}/clips/{clipId} {\n      // Everyone can read stories\n      allow read: if true;\n      \n      // Only admins can write\n      allow write: if isAdmin();\n    }\n    \n    // ========== NOTIFICATIONS COLLECTION ==========\n    match /notifications/{notificationId} {\n      // Only admins can read/write\n      allow read, write: if isAdmin();\n    }\n    \n    // ========== FEEDS COLLECTION ==========\n    match /feeds/{feedId} {\n      // Everyone can read published feeds, admins can read all\n      allow read: if resource.data.published == true || isAdmin();\n      \n      // Only admins can write\n      allow write: if isAdmin();\n    }\n    \n    // ========== FAITH LESSONS COLLECTION ==========\n    match /faithLessons/{lessonId} {\n      // Public read for published lessons\n      allow read: if resource.data.published == true || isAdmin();\n      \n      // Only admins can write\n      allow write: if isAdmin();\n    }\n    \n    // ========== LESSONS COLLECTION ==========\n    match /lessons/{lessonId} {\n      // Public read for all (lessons should be accessible to everyone)\n      allow read: if true;\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== PODCASTS COLLECTION ==========\n    match /podcasts/{podcastId} {\n      // All signed-in users can read active podcasts\n      allow read: if isSignedIn() && (resource.data.isActive == true || isAdmin());\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== DAILY VIDEOS COLLECTION ==========\n    match /dailyVideos/{videoId} {\n      // All signed-in users can read videos\n      allow read: if isSignedIn();\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== NEWS COLLECTION ==========\n    match /news/{newsId} {\n      // Only published news can be read by signed-in users\n      allow read: if isSignedIn() && resource.data.isPublished == true;\n      // Admins can read all (including drafts)\n      allow read: if isAdmin();\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== ALERTS COLLECTION ==========\n    match /alerts/{alertId} {\n      // All signed-in users can read alerts\n      allow read: if isSignedIn();\n      // Only admins can create, update, delete\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== HOME CARDS COLLECTION ==========\n    match /homeCards/{cardId} {\n      // Public read for all\n      allow read: if true;\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== APP CONFIG COLLECTION ==========\n    match /appConfig/{configId} {\n      // Public read\n      allow read: if true;\n      // Only admins can modify\n      allow write: if isAdmin();\n    }\n\n    // ========== INSTITUTIONS COLLECTION ==========\n    match /institutions/{institutionId} {\n      // Public read for all\n      allow read: if true;\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== INSTITUTIONS CONTENT COLLECTION ==========\n    match /institutionsContent/{activityId} {\n      // All signed-in users can read institution content\n      allow read: if isSignedIn();\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== BOOKS COLLECTION ==========\n    match /books/{bookId} {\n      // All signed-in users can read books\n      allow read: if isSignedIn();\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== FLYERS COLLECTION ==========\n    match /flyers/{flyerId} {\n      // All signed-in users can read flyers\n      allow read: if isSignedIn();\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== COMMUNITY POSTS COLLECTION ==========\n    match /communityPosts/{postId} {\n      // All signed-in users can read community posts\n      allow read: if isSignedIn();\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== LEADS COLLECTION ==========\n    match /leads/{leadId} {\n      // Anyone can create a lead (for contact forms)\n      allow create: if true;\n      // Only admins can read leads\n      allow read, update, delete: if isAdmin();\n    }\n\n    // ========== DEFAULT DENY ==========\n    match /{document=**} {\n      allow read, write: if false;\n    }\n  }\n}\n","name":"firestore.rules"}]},"createTime":"2025-11-20T17:38:55.747103Z","metadata":{"services":["cloud.firestore"]}}
[debug] [2025-11-20T17:38:55.702Z] [rules] created ruleset projects/eyalamrami-1d69e/rulesets/759dde9d-eb39-467d-9ca1-a623ac445240
[debug] [2025-11-20T17:38:55.703Z] [rules] releasing cloud.firestore/(default) with ruleset projects/eyalamrami-1d69e/rulesets/759dde9d-eb39-467d-9ca1-a623ac445240
[debug] [2025-11-20T17:38:55.704Z] Checked if tokens are valid: true, expires at: 1763663930888
[debug] [2025-11-20T17:38:55.704Z] Checked if tokens are valid: true, expires at: 1763663930888
[debug] [2025-11-20T17:38:55.704Z] >>> [apiv2][query] PATCH https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases/cloud.firestore/(default) [none]
[debug] [2025-11-20T17:38:55.704Z] >>> [apiv2][body] PATCH https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases/cloud.firestore/(default) {"release":{"name":"projects/eyalamrami-1d69e/releases/cloud.firestore/(default)","rulesetName":"projects/eyalamrami-1d69e/rulesets/759dde9d-eb39-467d-9ca1-a623ac445240"}}
[debug] [2025-11-20T17:38:56.186Z] <<< [apiv2][status] PATCH https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases/cloud.firestore/(default) 200
[debug] [2025-11-20T17:38:56.187Z] <<< [apiv2][body] PATCH https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases/cloud.firestore/(default) {"name":"projects/eyalamrami-1d69e/releases/cloud.firestore","rulesetName":"projects/eyalamrami-1d69e/rulesets/759dde9d-eb39-467d-9ca1-a623ac445240","createTime":"2025-11-16T21:56:37.010939Z","updateTime":"2025-11-20T17:38:56.236233Z"}
[debug] [2025-11-20T17:38:56.187Z] [rules] updated release projects/eyalamrami-1d69e/releases/cloud.firestore
[info] ✔  firestore: released rules firestore.rules to cloud.firestore 
[info] 
[info] ✔  Deploy complete! 
[info] 
[info] Project Console: https://console.firebase.google.com/project/eyalamrami-1d69e/overview
[debug] [2025-11-21T09:06:41.591Z] ----------------------------------------------------------------------
[debug] [2025-11-21T09:06:41.596Z] Command:       /opt/homebrew/Cellar/node/24.4.1/bin/node /opt/homebrew/bin/firebase deploy --only storage
[debug] [2025-11-21T09:06:41.596Z] CLI Version:   14.25.1
[debug] [2025-11-21T09:06:41.596Z] Platform:      darwin
[debug] [2025-11-21T09:06:41.596Z] Node Version:  v24.4.1
[debug] [2025-11-21T09:06:41.596Z] Time:          Fri Nov 21 2025 11:06:41 GMT+0200 (Israel Standard Time)
[debug] [2025-11-21T09:06:41.596Z] ----------------------------------------------------------------------
[debug] 
[debug] [2025-11-21T09:06:41.697Z] > command requires scopes: ["email","openid","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","https://www.googleapis.com/auth/cloud-platform"]
[debug] [2025-11-21T09:06:41.698Z] > authorizing via signed-in user (orel895@gmail.com)
[debug] [2025-11-21T09:06:41.698Z] [iam] checking project eyalamrami-1d69e for permissions ["firebase.projects.get","firebaserules.releases.create","firebaserules.releases.update","firebaserules.rulesets.create"]
[debug] [2025-11-21T09:06:41.699Z] Checked if tokens are valid: false, expires at: 1763663930888
[debug] [2025-11-21T09:06:41.699Z] Checked if tokens are valid: false, expires at: 1763663930888
[debug] [2025-11-21T09:06:41.699Z] > refreshing access token with scopes: []
[debug] [2025-11-21T09:06:41.700Z] >>> [apiv2][query] POST https://www.googleapis.com/oauth2/v3/token [none]
[debug] [2025-11-21T09:06:41.700Z] >>> [apiv2][body] POST https://www.googleapis.com/oauth2/v3/token [omitted]
[debug] [2025-11-21T09:06:41.914Z] <<< [apiv2][status] POST https://www.googleapis.com/oauth2/v3/token 200
[debug] [2025-11-21T09:06:41.914Z] <<< [apiv2][body] POST https://www.googleapis.com/oauth2/v3/token [omitted]
[debug] [2025-11-21T09:06:41.925Z] >>> [apiv2][query] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions [none]
[debug] [2025-11-21T09:06:41.926Z] >>> [apiv2][(partial)header] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions x-goog-quota-user=projects/eyalamrami-1d69e
[debug] [2025-11-21T09:06:41.926Z] >>> [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions {"permissions":["firebase.projects.get","firebaserules.releases.create","firebaserules.releases.update","firebaserules.rulesets.create"]}
[debug] [2025-11-21T09:06:42.959Z] <<< [apiv2][status] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions 200
[debug] [2025-11-21T09:06:42.959Z] <<< [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions {"permissions":["firebase.projects.get","firebaserules.releases.create","firebaserules.releases.update","firebaserules.rulesets.create"]}
[info] 
[info] === Deploying to 'eyalamrami-1d69e'...
[info] 
[info] i  deploying storage 
[info] i  storage: ensuring required API firebasestorage.googleapis.com is enabled... 
[debug] [2025-11-21T09:06:42.962Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:06:42.962Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:06:42.962Z] >>> [apiv2][query] GET https://firebasestorage.googleapis.com/v1alpha/projects/eyalamrami-1d69e/defaultBucket [none]
[debug] [2025-11-21T09:06:43.648Z] <<< [apiv2][status] GET https://firebasestorage.googleapis.com/v1alpha/projects/eyalamrami-1d69e/defaultBucket 200
[debug] [2025-11-21T09:06:43.648Z] <<< [apiv2][body] GET https://firebasestorage.googleapis.com/v1alpha/projects/eyalamrami-1d69e/defaultBucket {"name":"projects/eyalamrami-1d69e/defaultBucket","location":"EUROPE-WEST2","bucket":{"name":"projects/eyalamrami-1d69e/buckets/eyalamrami-1d69e.firebasestorage.app"},"storageClass":"REGIONAL"}
[info] i  firebase.storage: checking storage.rules for compilation errors... 
[debug] [2025-11-21T09:06:43.649Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:06:43.649Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:06:43.650Z] >>> [apiv2][query] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test [none]
[debug] [2025-11-21T09:06:43.650Z] >>> [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test [omitted]
[debug] [2025-11-21T09:06:44.630Z] <<< [apiv2][status] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test 200
[debug] [2025-11-21T09:06:44.630Z] <<< [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test {}
[info] ✔  firebase.storage: rules file storage.rules compiled successfully 
[debug] [2025-11-21T09:06:44.631Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:06:44.632Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:06:44.632Z] >>> [apiv2][query] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases pageSize=10&pageToken=
[debug] [2025-11-21T09:06:45.350Z] <<< [apiv2][status] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases 200
[debug] [2025-11-21T09:06:45.350Z] <<< [apiv2][body] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases {"releases":[{"name":"projects/eyalamrami-1d69e/releases/cloud.firestore","rulesetName":"projects/eyalamrami-1d69e/rulesets/759dde9d-eb39-467d-9ca1-a623ac445240","createTime":"2025-11-16T21:56:37.010939Z","updateTime":"2025-11-20T17:38:56.236233Z"},{"name":"projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app","rulesetName":"projects/eyalamrami-1d69e/rulesets/638302fc-2049-483c-8442-32ccd0950f40","createTime":"2025-11-16T21:57:38.715272Z","updateTime":"2025-11-20T14:22:36.089686Z"}]}
[debug] [2025-11-21T09:06:45.384Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:06:45.385Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:06:45.385Z] >>> [apiv2][query] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets/638302fc-2049-483c-8442-32ccd0950f40 [none]
[debug] [2025-11-21T09:06:46.064Z] <<< [apiv2][status] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets/638302fc-2049-483c-8442-32ccd0950f40 200
[debug] [2025-11-21T09:06:46.064Z] <<< [apiv2][body] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets/638302fc-2049-483c-8442-32ccd0950f40 [omitted]
[info] i  storage: uploading rules storage.rules... 
[debug] [2025-11-21T09:06:46.067Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:06:46.067Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:06:46.067Z] >>> [apiv2][query] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets [none]
[debug] [2025-11-21T09:06:46.067Z] >>> [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets [omitted]
[debug] [2025-11-21T09:06:46.920Z] <<< [apiv2][status] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets 200
[debug] [2025-11-21T09:06:46.921Z] <<< [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets {"name":"projects/eyalamrami-1d69e/rulesets/2bc7c2ef-995d-418e-8b60-cec70b34e8b5","source":{"files":[{"content":"rules_version = '2';\nservice firebase.storage {\n  match /b/{bucket}/o {\n    \n    // Helper function to check admin via custom claims\n    function isAdminClaim() {\n      return request.auth != null && request.auth.token.admin == true;\n    }\n    \n    // ========== AUDIO DAILY ==========\n    match /audio/daily/{date}/{fileName} {\n      // Public read for daily audio\n      allow read: if true;\n      \n      // Only admins can write\n      allow write: if isAdminClaim() &&\n                   request.resource.size < 20 * 1024 * 1024 && // Max 20MB\n                   request.resource.contentType.matches('audio/.*');\n    }\n    \n    // ========== VIDEO STORIES ==========\n    match /video/stories/{date}/{clipId} {\n      // Public read for story videos\n      allow read: if true;\n      \n      // Only admins can write (enforce .mp4 in validation)\n      allow write: if isAdminClaim() &&\n                   request.resource.size < 100 * 1024 * 1024 && // Max 100MB\n                   request.resource.contentType.matches('video/.*') &&\n                   clipId.matches('.*\\\\.mp4$');\n    }\n    \n    // ========== VIDEO STORIES THUMBNAILS ==========\n    match /video/stories_thumbs/{date}/{clipId} {\n      // Public read for story thumbnails\n      allow read: if true;\n      \n      // Only admins can write (enforce .jpg in validation)\n      allow write: if isAdminClaim() &&\n                   request.resource.size < 5 * 1024 * 1024 && // Max 5MB\n                   request.resource.contentType.matches('image/.*') &&\n                   clipId.matches('.*\\\\.jpg$');\n    }\n    \n    // ========== IMAGES (General) ==========\n    match /images/{allPaths=**} {\n      // Public read for images\n      allow read: if true;\n\n      // Only admins can write\n      allow write: if isAdminClaim() &&\n                   request.resource.size < 10 * 1024 * 1024 && // Max 10MB\n                   request.resource.contentType.matches('image/.*');\n    }\n\n    // ========== LESSONS ==========\n    match /lessons/{lessonId}/{fileName} {\n      // Public read for lesson thumbnails\n      allow read: if true;\n\n      // Only admins can write\n      allow write: if isAdminClaim() &&\n                   request.resource.size < 5 * 1024 * 1024 && // Max 5MB\n                   request.resource.contentType.matches('image/.*');\n    }\n\n    // ========== PODCASTS ==========\n    match /podcasts/{podcastId}/{fileName} {\n      // Public read for podcast audio and thumbnails\n      allow read: if true;\n\n      // Only admins can write audio files\n      allow write: if isAdminClaim() &&\n                   fileName == 'audio.mp3' &&\n                   request.resource.size < 100 * 1024 * 1024 && // Max 100MB\n                   request.resource.contentType.matches('audio/.*');\n\n      // Only admins can write thumbnail images\n      allow write: if isAdminClaim() &&\n                   fileName == 'thumbnail.jpg' &&\n                   request.resource.size < 5 * 1024 * 1024 && // Max 5MB\n                   request.resource.contentType.matches('image/.*');\n    }\n\n    // ========== DAILY VIDEOS ==========\n    match /dailyVideos/{videoId}/{fileName} {\n      // Public read for daily videos\n      allow read: if true;\n\n      // Only admins can write videos\n      allow write: if isAdminClaim() &&\n                   fileName.matches('video.*') &&\n                   request.resource.size < 200 * 1024 * 1024 && // Max 200MB\n                   request.resource.contentType.matches('video/.*');\n\n      // Only admins can write thumbnails\n      allow write: if isAdminClaim() &&\n                   fileName.matches('thumbnail.*') &&\n                   request.resource.size < 5 * 1024 * 1024 && // Max 5MB\n                   request.resource.contentType.matches('image/.*');\n    }\n\n    // ========== NEWS ==========\n    match /news/{newsId}/{fileName} {\n      // Public read for news images\n      allow read: if true;\n\n      // Only admins can write\n      allow write: if isAdminClaim() &&\n                   request.resource.size < 10 * 1024 * 1024 && // Max 10MB\n                   request.resource.contentType.matches('image/.*');\n    }\n\n    // ========== BOOKS ==========\n    match /books/{bookId}/{fileName} {\n      // Public read for book covers\n      allow read: if true;\n\n      // Only admins can write\n      allow write: if isAdminClaim() &&\n                   request.resource.size < 5 * 1024 * 1024 && // Max 5MB\n                   request.resource.contentType.matches('image/.*');\n    }\n\n    // ========== FLYERS ==========\n    match /flyers/{flyerId}/{fileName} {\n      // Public read for flyers\n      allow read: if true;\n\n      // Only admins can write PDFs\n      allow write: if isAdminClaim() &&\n                   request.resource.size < 20 * 1024 * 1024 && // Max 20MB\n                   request.resource.contentType == 'application/pdf';\n    }\n\n    // ========== COMMUNITY POSTS ==========\n    match /communityPosts/{postId}/{fileName} {\n      // Public read for community post images\n      allow read: if true;\n\n      // Only admins can write\n      allow write: if isAdminClaim() &&\n                   request.resource.size < 10 * 1024 * 1024 && // Max 10MB\n                   request.resource.contentType.matches('image/.*');\n    }\n\n    // ========== INSTITUTIONS ==========\n    match /institutions/{institutionId}/{fileName} {\n      // Public read for institution images\n      allow read: if true;\n\n      // Only admins can write\n      allow write: if isAdminClaim() &&\n                   request.resource.size < 10 * 1024 * 1024 && // Max 10MB\n                   request.resource.contentType.matches('image/.*');\n    }\n\n    // ========== HOME CARDS ==========\n    match /cards/{cardId}/{fileName} {\n      // Public read for card images\n      allow read: if true;\n\n      // Only admins can write\n      allow write: if isAdminClaim() &&\n                   request.resource.size < 5 * 1024 * 1024 && // Max 5MB\n                   request.resource.contentType.matches('image/.*');\n    }\n\n    // ========== ALERTS ==========\n    match /alerts/{alertId}/{fileName} {\n      // Public read for alert images and audio\n      allow read: if true;\n\n      // Only admins can write images\n      allow write: if isAdminClaim() &&\n                   fileName.matches('.*\\\\.(jpg|jpeg|png|gif)$') &&\n                   request.resource.size < 10 * 1024 * 1024 && // Max 10MB\n                   request.resource.contentType.matches('image/.*');\n\n      // Only admins can write audio files\n      allow write: if isAdminClaim() &&\n                   fileName.matches('.*\\\\.(mp3|m4a|wav|aac)$') &&\n                   request.resource.size < 20 * 1024 * 1024 && // Max 20MB\n                   request.resource.contentType.matches('audio/.*');\n    }\n\n    // ========== DEFAULT DENY ==========\n    match /{allPaths=**} {\n      allow read, write: if false;\n    }\n  }\n}\n","name":"storage.rules"}]},"createTime":"2025-11-21T09:06:46.897503Z","metadata":{"services":["firebase.storage"]}}
[debug] [2025-11-21T09:06:46.921Z] [rules] created ruleset projects/eyalamrami-1d69e/rulesets/2bc7c2ef-995d-418e-8b60-cec70b34e8b5
[debug] [2025-11-21T09:06:46.921Z] [rules] releasing firebase.storage/eyalamrami-1d69e.firebasestorage.app with ruleset projects/eyalamrami-1d69e/rulesets/2bc7c2ef-995d-418e-8b60-cec70b34e8b5
[debug] [2025-11-21T09:06:46.922Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:06:46.922Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:06:46.922Z] >>> [apiv2][query] PATCH https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app [none]
[debug] [2025-11-21T09:06:46.922Z] >>> [apiv2][body] PATCH https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app {"release":{"name":"projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app","rulesetName":"projects/eyalamrami-1d69e/rulesets/2bc7c2ef-995d-418e-8b60-cec70b34e8b5"}}
[debug] [2025-11-21T09:06:47.487Z] <<< [apiv2][status] PATCH https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app 200
[debug] [2025-11-21T09:06:47.487Z] <<< [apiv2][body] PATCH https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app {"name":"projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app","rulesetName":"projects/eyalamrami-1d69e/rulesets/2bc7c2ef-995d-418e-8b60-cec70b34e8b5","createTime":"2025-11-16T21:57:38.715272Z","updateTime":"2025-11-21T09:06:47.475312Z"}
[debug] [2025-11-21T09:06:47.487Z] [rules] updated release projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app
[info] ✔  storage: released rules storage.rules to firebase.storage 
[info] 
[info] ✔  Deploy complete! 
[info] 
[info] Project Console: https://console.firebase.google.com/project/eyalamrami-1d69e/overview
[debug] [2025-11-21T09:07:03.708Z] ----------------------------------------------------------------------
[debug] [2025-11-21T09:07:03.710Z] Command:       /opt/homebrew/Cellar/node/24.4.1/bin/node /opt/homebrew/bin/firebase deploy --only storage
[debug] [2025-11-21T09:07:03.710Z] CLI Version:   14.25.1
[debug] [2025-11-21T09:07:03.710Z] Platform:      darwin
[debug] [2025-11-21T09:07:03.710Z] Node Version:  v24.4.1
[debug] [2025-11-21T09:07:03.710Z] Time:          Fri Nov 21 2025 11:07:03 GMT+0200 (Israel Standard Time)
[debug] [2025-11-21T09:07:03.710Z] ----------------------------------------------------------------------
[debug] 
[debug] [2025-11-21T09:07:03.802Z] > command requires scopes: ["email","openid","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","https://www.googleapis.com/auth/cloud-platform"]
[debug] [2025-11-21T09:07:03.803Z] > authorizing via signed-in user (orel895@gmail.com)
[debug] [2025-11-21T09:07:03.803Z] [iam] checking project eyalamrami-1d69e for permissions ["firebase.projects.get","firebaserules.releases.create","firebaserules.releases.update","firebaserules.rulesets.create"]
[debug] [2025-11-21T09:07:03.803Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:07:03.804Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:07:03.804Z] >>> [apiv2][query] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions [none]
[debug] [2025-11-21T09:07:03.804Z] >>> [apiv2][(partial)header] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions x-goog-quota-user=projects/eyalamrami-1d69e
[debug] [2025-11-21T09:07:03.804Z] >>> [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions {"permissions":["firebase.projects.get","firebaserules.releases.create","firebaserules.releases.update","firebaserules.rulesets.create"]}
[debug] [2025-11-21T09:07:04.768Z] <<< [apiv2][status] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions 200
[debug] [2025-11-21T09:07:04.768Z] <<< [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions {"permissions":["firebase.projects.get","firebaserules.releases.create","firebaserules.releases.update","firebaserules.rulesets.create"]}
[info] 
[info] === Deploying to 'eyalamrami-1d69e'...
[info] 
[info] i  deploying storage 
[info] i  storage: ensuring required API firebasestorage.googleapis.com is enabled... 
[debug] [2025-11-21T09:07:04.770Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:07:04.770Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:07:04.770Z] >>> [apiv2][query] GET https://firebasestorage.googleapis.com/v1alpha/projects/eyalamrami-1d69e/defaultBucket [none]
[debug] [2025-11-21T09:07:05.342Z] <<< [apiv2][status] GET https://firebasestorage.googleapis.com/v1alpha/projects/eyalamrami-1d69e/defaultBucket 200
[debug] [2025-11-21T09:07:05.343Z] <<< [apiv2][body] GET https://firebasestorage.googleapis.com/v1alpha/projects/eyalamrami-1d69e/defaultBucket {"name":"projects/eyalamrami-1d69e/defaultBucket","location":"EUROPE-WEST2","bucket":{"name":"projects/eyalamrami-1d69e/buckets/eyalamrami-1d69e.firebasestorage.app"},"storageClass":"REGIONAL"}
[info] i  firebase.storage: checking storage.rules for compilation errors... 
[debug] [2025-11-21T09:07:05.346Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:07:05.347Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:07:05.347Z] >>> [apiv2][query] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test [none]
[debug] [2025-11-21T09:07:05.347Z] >>> [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test [omitted]
[debug] [2025-11-21T09:07:05.792Z] <<< [apiv2][status] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test 200
[debug] [2025-11-21T09:07:05.792Z] <<< [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test {}
[info] ✔  firebase.storage: rules file storage.rules compiled successfully 
[debug] [2025-11-21T09:07:05.793Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:07:05.793Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:07:05.793Z] >>> [apiv2][query] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases pageSize=10&pageToken=
[debug] [2025-11-21T09:07:06.119Z] <<< [apiv2][status] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases 200
[debug] [2025-11-21T09:07:06.119Z] <<< [apiv2][body] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases {"releases":[{"name":"projects/eyalamrami-1d69e/releases/cloud.firestore","rulesetName":"projects/eyalamrami-1d69e/rulesets/759dde9d-eb39-467d-9ca1-a623ac445240","createTime":"2025-11-16T21:56:37.010939Z","updateTime":"2025-11-20T17:38:56.236233Z"},{"name":"projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app","rulesetName":"projects/eyalamrami-1d69e/rulesets/2bc7c2ef-995d-418e-8b60-cec70b34e8b5","createTime":"2025-11-16T21:57:38.715272Z","updateTime":"2025-11-21T09:06:47.475312Z"}]}
[debug] [2025-11-21T09:07:06.142Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:07:06.142Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:07:06.142Z] >>> [apiv2][query] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets/2bc7c2ef-995d-418e-8b60-cec70b34e8b5 [none]
[debug] [2025-11-21T09:07:06.436Z] <<< [apiv2][status] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets/2bc7c2ef-995d-418e-8b60-cec70b34e8b5 200
[debug] [2025-11-21T09:07:06.436Z] <<< [apiv2][body] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets/2bc7c2ef-995d-418e-8b60-cec70b34e8b5 [omitted]
[info] i  storage: uploading rules storage.rules... 
[debug] [2025-11-21T09:07:06.438Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:07:06.438Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:07:06.438Z] >>> [apiv2][query] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets [none]
[debug] [2025-11-21T09:07:06.438Z] >>> [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets [omitted]
[debug] [2025-11-21T09:07:07.244Z] <<< [apiv2][status] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets 200
[debug] [2025-11-21T09:07:07.245Z] <<< [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets {"name":"projects/eyalamrami-1d69e/rulesets/2e9cb07c-45d7-4e97-bb30-e4789df4bbda","source":{"files":[{"content":"rules_version = '2';\nservice firebase.storage {\n  match /b/{bucket}/o {\n    \n    // Helper function to check admin via Firestore\n    function isAdmin() {\n      return request.auth != null && \n             firestore.get(/databases/(default)/documents/users/$(request.auth.uid)).data.role == 'admin';\n    }\n    \n    // Helper function to check admin via custom claims (fallback)\n    function isAdminClaim() {\n      return request.auth != null && request.auth.token.admin == true;\n    }\n    \n    // Combined admin check - try Firestore first, then custom claims\n    function isAdminUser() {\n      return isAdmin() || isAdminClaim();\n    }\n    \n    // ========== AUDIO DAILY ==========\n    match /audio/daily/{date}/{fileName} {\n      // Public read for daily audio\n      allow read: if true;\n      \n      // Only admins can write\n      allow write: if isAdminClaim() &&\n                   request.resource.size < 20 * 1024 * 1024 && // Max 20MB\n                   request.resource.contentType.matches('audio/.*');\n    }\n    \n    // ========== VIDEO STORIES ==========\n    match /video/stories/{date}/{clipId} {\n      // Public read for story videos\n      allow read: if true;\n      \n      // Only admins can write (enforce .mp4 in validation)\n      allow write: if isAdminClaim() &&\n                   request.resource.size < 100 * 1024 * 1024 && // Max 100MB\n                   request.resource.contentType.matches('video/.*') &&\n                   clipId.matches('.*\\\\.mp4$');\n    }\n    \n    // ========== VIDEO STORIES THUMBNAILS ==========\n    match /video/stories_thumbs/{date}/{clipId} {\n      // Public read for story thumbnails\n      allow read: if true;\n      \n      // Only admins can write (enforce .jpg in validation)\n      allow write: if isAdminClaim() &&\n                   request.resource.size < 5 * 1024 * 1024 && // Max 5MB\n                   request.resource.contentType.matches('image/.*') &&\n                   clipId.matches('.*\\\\.jpg$');\n    }\n    \n    // ========== IMAGES (General) ==========\n    match /images/{allPaths=**} {\n      // Public read for images\n      allow read: if true;\n\n      // Only admins can write\n      allow write: if isAdminClaim() &&\n                   request.resource.size < 10 * 1024 * 1024 && // Max 10MB\n                   request.resource.contentType.matches('image/.*');\n    }\n\n    // ========== LESSONS ==========\n    match /lessons/{lessonId}/{fileName} {\n      // Public read for lesson thumbnails\n      allow read: if true;\n\n      // Only admins can write\n      allow write: if isAdminClaim() &&\n                   request.resource.size < 5 * 1024 * 1024 && // Max 5MB\n                   request.resource.contentType.matches('image/.*');\n    }\n\n    // ========== PODCASTS ==========\n    match /podcasts/{podcastId}/{fileName} {\n      // Public read for podcast audio and thumbnails\n      allow read: if true;\n\n      // Only admins can write audio files\n      allow write: if isAdminClaim() &&\n                   fileName == 'audio.mp3' &&\n                   request.resource.size < 100 * 1024 * 1024 && // Max 100MB\n                   request.resource.contentType.matches('audio/.*');\n\n      // Only admins can write thumbnail images\n      allow write: if isAdminClaim() &&\n                   fileName == 'thumbnail.jpg' &&\n                   request.resource.size < 5 * 1024 * 1024 && // Max 5MB\n                   request.resource.contentType.matches('image/.*');\n    }\n\n    // ========== DAILY VIDEOS ==========\n    match /dailyVideos/{videoId}/{fileName} {\n      // Public read for daily videos\n      allow read: if true;\n\n      // Only admins can write videos\n      allow write: if isAdminClaim() &&\n                   fileName.matches('video.*') &&\n                   request.resource.size < 200 * 1024 * 1024 && // Max 200MB\n                   request.resource.contentType.matches('video/.*');\n\n      // Only admins can write thumbnails\n      allow write: if isAdminClaim() &&\n                   fileName.matches('thumbnail.*') &&\n                   request.resource.size < 5 * 1024 * 1024 && // Max 5MB\n                   request.resource.contentType.matches('image/.*');\n    }\n\n    // ========== NEWS ==========\n    match /news/{newsId}/{fileName} {\n      // Public read for news images\n      allow read: if true;\n\n      // Only admins can write\n      allow write: if isAdminClaim() &&\n                   request.resource.size < 10 * 1024 * 1024 && // Max 10MB\n                   request.resource.contentType.matches('image/.*');\n    }\n\n    // ========== BOOKS ==========\n    match /books/{bookId}/{fileName} {\n      // Public read for book covers\n      allow read: if true;\n\n      // Only admins can write\n      allow write: if isAdminClaim() &&\n                   request.resource.size < 5 * 1024 * 1024 && // Max 5MB\n                   request.resource.contentType.matches('image/.*');\n    }\n\n    // ========== FLYERS ==========\n    match /flyers/{flyerId}/{fileName} {\n      // Public read for flyers\n      allow read: if true;\n\n      // Only admins can write PDFs\n      allow write: if isAdminClaim() &&\n                   request.resource.size < 20 * 1024 * 1024 && // Max 20MB\n                   request.resource.contentType == 'application/pdf';\n    }\n\n    // ========== COMMUNITY POSTS ==========\n    match /communityPosts/{postId}/{fileName} {\n      // Public read for community post images\n      allow read: if true;\n\n      // Only admins can write\n      allow write: if isAdminClaim() &&\n                   request.resource.size < 10 * 1024 * 1024 && // Max 10MB\n                   request.resource.contentType.matches('image/.*');\n    }\n\n    // ========== INSTITUTIONS ==========\n    match /institutions/{institutionId}/{fileName} {\n      // Public read for institution images\n      allow read: if true;\n\n      // Only admins can write\n      allow write: if isAdminClaim() &&\n                   request.resource.size < 10 * 1024 * 1024 && // Max 10MB\n                   request.resource.contentType.matches('image/.*');\n    }\n\n    // ========== HOME CARDS ==========\n    match /cards/{cardId}/{fileName} {\n      // Public read for card images\n      allow read: if true;\n\n      // Only admins can write\n      allow write: if isAdminClaim() &&\n                   request.resource.size < 5 * 1024 * 1024 && // Max 5MB\n                   request.resource.contentType.matches('image/.*');\n    }\n\n    // ========== ALERTS ==========\n    match /alerts/{alertId}/{fileName} {\n      // Public read for alert images and audio\n      allow read: if true;\n\n      // Only admins can write images\n      allow write: if isAdminUser() &&\n                   fileName.matches('.*\\\\.(jpg|jpeg|png|gif)$') &&\n                   request.resource.size < 10 * 1024 * 1024 && // Max 10MB\n                   request.resource.contentType.matches('image/.*');\n\n      // Only admins can write audio files\n      allow write: if isAdminUser() &&\n                   fileName.matches('.*\\\\.(mp3|m4a|wav|aac)$') &&\n                   request.resource.size < 20 * 1024 * 1024 && // Max 20MB\n                   request.resource.contentType.matches('audio/.*');\n    }\n\n    // ========== DEFAULT DENY ==========\n    match /{allPaths=**} {\n      allow read, write: if false;\n    }\n  }\n}\n","name":"storage.rules"}]},"createTime":"2025-11-21T09:07:07.236495Z","metadata":{"services":["firebase.storage"]}}
[debug] [2025-11-21T09:07:07.245Z] [rules] created ruleset projects/eyalamrami-1d69e/rulesets/2e9cb07c-45d7-4e97-bb30-e4789df4bbda
[debug] [2025-11-21T09:07:07.245Z] [rules] releasing firebase.storage/eyalamrami-1d69e.firebasestorage.app with ruleset projects/eyalamrami-1d69e/rulesets/2e9cb07c-45d7-4e97-bb30-e4789df4bbda
[debug] [2025-11-21T09:07:07.245Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:07:07.245Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:07:07.246Z] >>> [apiv2][query] PATCH https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app [none]
[debug] [2025-11-21T09:07:07.246Z] >>> [apiv2][body] PATCH https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app {"release":{"name":"projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app","rulesetName":"projects/eyalamrami-1d69e/rulesets/2e9cb07c-45d7-4e97-bb30-e4789df4bbda"}}
[debug] [2025-11-21T09:07:08.141Z] <<< [apiv2][status] PATCH https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app 200
[debug] [2025-11-21T09:07:08.141Z] <<< [apiv2][body] PATCH https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app {"name":"projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app","rulesetName":"projects/eyalamrami-1d69e/rulesets/2e9cb07c-45d7-4e97-bb30-e4789df4bbda","createTime":"2025-11-16T21:57:38.715272Z","updateTime":"2025-11-21T09:07:08.098890Z"}
[debug] [2025-11-21T09:07:08.141Z] [rules] updated release projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app
[info] ✔  storage: released rules storage.rules to firebase.storage 
[info] 
[info] ✔  Deploy complete! 
[info] 
[info] Project Console: https://console.firebase.google.com/project/eyalamrami-1d69e/overview
[debug] [2025-11-21T09:12:00.465Z] ----------------------------------------------------------------------
[debug] [2025-11-21T09:12:00.468Z] Command:       /opt/homebrew/Cellar/node/24.4.1/bin/node /opt/homebrew/bin/firebase deploy --only storage
[debug] [2025-11-21T09:12:00.469Z] CLI Version:   14.25.1
[debug] [2025-11-21T09:12:00.469Z] Platform:      darwin
[debug] [2025-11-21T09:12:00.469Z] Node Version:  v24.4.1
[debug] [2025-11-21T09:12:00.469Z] Time:          Fri Nov 21 2025 11:12:00 GMT+0200 (Israel Standard Time)
[debug] [2025-11-21T09:12:00.469Z] ----------------------------------------------------------------------
[debug] 
[debug] [2025-11-21T09:12:00.562Z] > command requires scopes: ["email","openid","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","https://www.googleapis.com/auth/cloud-platform"]
[debug] [2025-11-21T09:12:00.563Z] > authorizing via signed-in user (orel895@gmail.com)
[debug] [2025-11-21T09:12:00.563Z] [iam] checking project eyalamrami-1d69e for permissions ["firebase.projects.get","firebaserules.releases.create","firebaserules.releases.update","firebaserules.rulesets.create"]
[debug] [2025-11-21T09:12:00.563Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:12:00.563Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:12:00.564Z] >>> [apiv2][query] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions [none]
[debug] [2025-11-21T09:12:00.564Z] >>> [apiv2][(partial)header] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions x-goog-quota-user=projects/eyalamrami-1d69e
[debug] [2025-11-21T09:12:00.564Z] >>> [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions {"permissions":["firebase.projects.get","firebaserules.releases.create","firebaserules.releases.update","firebaserules.rulesets.create"]}
[debug] [2025-11-21T09:12:01.541Z] <<< [apiv2][status] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions 200
[debug] [2025-11-21T09:12:01.541Z] <<< [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions {"permissions":["firebase.projects.get","firebaserules.releases.create","firebaserules.releases.update","firebaserules.rulesets.create"]}
[info] 
[info] === Deploying to 'eyalamrami-1d69e'...
[info] 
[info] i  deploying storage 
[info] i  storage: ensuring required API firebasestorage.googleapis.com is enabled... 
[debug] [2025-11-21T09:12:01.543Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:12:01.543Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:12:01.543Z] >>> [apiv2][query] GET https://firebasestorage.googleapis.com/v1alpha/projects/eyalamrami-1d69e/defaultBucket [none]
[debug] [2025-11-21T09:12:02.128Z] <<< [apiv2][status] GET https://firebasestorage.googleapis.com/v1alpha/projects/eyalamrami-1d69e/defaultBucket 200
[debug] [2025-11-21T09:12:02.128Z] <<< [apiv2][body] GET https://firebasestorage.googleapis.com/v1alpha/projects/eyalamrami-1d69e/defaultBucket {"name":"projects/eyalamrami-1d69e/defaultBucket","location":"EUROPE-WEST2","bucket":{"name":"projects/eyalamrami-1d69e/buckets/eyalamrami-1d69e.firebasestorage.app"},"storageClass":"REGIONAL"}
[info] i  firebase.storage: checking storage.rules for compilation errors... 
[debug] [2025-11-21T09:12:02.131Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:12:02.131Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:12:02.132Z] >>> [apiv2][query] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test [none]
[debug] [2025-11-21T09:12:02.132Z] >>> [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test [omitted]
[debug] [2025-11-21T09:12:02.969Z] <<< [apiv2][status] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test 200
[debug] [2025-11-21T09:12:02.970Z] <<< [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test {}
[info] ✔  firebase.storage: rules file storage.rules compiled successfully 
[debug] [2025-11-21T09:12:02.972Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:12:02.972Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:12:02.972Z] >>> [apiv2][query] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases pageSize=10&pageToken=
[debug] [2025-11-21T09:12:03.644Z] <<< [apiv2][status] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases 200
[debug] [2025-11-21T09:12:03.645Z] <<< [apiv2][body] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases {"releases":[{"name":"projects/eyalamrami-1d69e/releases/cloud.firestore","rulesetName":"projects/eyalamrami-1d69e/rulesets/759dde9d-eb39-467d-9ca1-a623ac445240","createTime":"2025-11-16T21:56:37.010939Z","updateTime":"2025-11-20T17:38:56.236233Z"},{"name":"projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app","rulesetName":"projects/eyalamrami-1d69e/rulesets/2e9cb07c-45d7-4e97-bb30-e4789df4bbda","createTime":"2025-11-16T21:57:38.715272Z","updateTime":"2025-11-21T09:07:08.098890Z"}]}
[debug] [2025-11-21T09:12:03.671Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:12:03.671Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:12:03.671Z] >>> [apiv2][query] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets/2e9cb07c-45d7-4e97-bb30-e4789df4bbda [none]
[debug] [2025-11-21T09:12:03.993Z] <<< [apiv2][status] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets/2e9cb07c-45d7-4e97-bb30-e4789df4bbda 200
[debug] [2025-11-21T09:12:03.994Z] <<< [apiv2][body] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets/2e9cb07c-45d7-4e97-bb30-e4789df4bbda [omitted]
[info] i  storage: uploading rules storage.rules... 
[debug] [2025-11-21T09:12:03.995Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:12:03.995Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:12:03.995Z] >>> [apiv2][query] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets [none]
[debug] [2025-11-21T09:12:03.995Z] >>> [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets [omitted]
[debug] [2025-11-21T09:12:04.386Z] <<< [apiv2][status] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets 200
[debug] [2025-11-21T09:12:04.386Z] <<< [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets {"name":"projects/eyalamrami-1d69e/rulesets/65279af2-9473-41cd-9cb2-6090289a841e","source":{"files":[{"content":"rules_version = '2';\nservice firebase.storage {\n  match /b/{bucket}/o {\n    \n    // Helper function to check admin via Firestore\n    function isAdmin() {\n      return request.auth != null && \n             firestore.get(/databases/(default)/documents/users/$(request.auth.uid)).data.role == 'admin';\n    }\n    \n    // Helper function to check admin via custom claims (fallback)\n    function isAdminClaim() {\n      return request.auth != null && request.auth.token.admin == true;\n    }\n    \n    // Combined admin check - try Firestore first, then custom claims\n    function isAdminUser() {\n      return isAdmin() || isAdminClaim();\n    }\n    \n    // ========== AUDIO DAILY ==========\n    match /audio/daily/{date}/{fileName} {\n      // Public read for daily audio\n      allow read: if true;\n      \n      // Only admins can write\n      allow write: if isAdminUser() &&\n                   request.resource.size < 20 * 1024 * 1024 && // Max 20MB\n                   request.resource.contentType.matches('audio/.*');\n    }\n    \n    // ========== VIDEO STORIES ==========\n    match /video/stories/{date}/{clipId} {\n      // Public read for story videos\n      allow read: if true;\n      \n      // Only admins can write (enforce .mp4 in validation)\n      allow write: if isAdminUser() &&\n                   request.resource.size < 100 * 1024 * 1024 && // Max 100MB\n                   request.resource.contentType.matches('video/.*') &&\n                   clipId.matches('.*\\\\.mp4$');\n    }\n    \n    // ========== VIDEO STORIES THUMBNAILS ==========\n    match /video/stories_thumbs/{date}/{clipId} {\n      // Public read for story thumbnails\n      allow read: if true;\n      \n      // Only admins can write (enforce .jpg in validation)\n      allow write: if isAdminUser() &&\n                   request.resource.size < 5 * 1024 * 1024 && // Max 5MB\n                   request.resource.contentType.matches('image/.*') &&\n                   clipId.matches('.*\\\\.jpg$');\n    }\n    \n    // ========== IMAGES (General) ==========\n    match /images/{allPaths=**} {\n      // Public read for images\n      allow read: if true;\n\n      // Only admins can write\n      allow write: if isAdminUser() &&\n                   request.resource.size < 10 * 1024 * 1024 && // Max 10MB\n                   request.resource.contentType.matches('image/.*');\n    }\n\n    // ========== LESSONS ==========\n    match /lessons/{lessonId}/{fileName} {\n      // Public read for lesson thumbnails\n      allow read: if true;\n\n      // Only admins can write\n      allow write: if isAdminUser() &&\n                   request.resource.size < 5 * 1024 * 1024 && // Max 5MB\n                   request.resource.contentType.matches('image/.*');\n    }\n\n    // ========== PODCASTS ==========\n    match /podcasts/{podcastId}/{fileName} {\n      // Public read for podcast audio and thumbnails\n      allow read: if true;\n\n      // Only admins can write audio files\n      allow write: if isAdminUser() &&\n                   fileName == 'audio.mp3' &&\n                   request.resource.size < 100 * 1024 * 1024 && // Max 100MB\n                   request.resource.contentType.matches('audio/.*');\n\n      // Only admins can write thumbnail images\n      allow write: if isAdminUser() &&\n                   fileName == 'thumbnail.jpg' &&\n                   request.resource.size < 5 * 1024 * 1024 && // Max 5MB\n                   request.resource.contentType.matches('image/.*');\n    }\n\n    // ========== DAILY VIDEOS ==========\n    match /dailyVideos/{videoId}/{fileName} {\n      // Public read for daily videos\n      allow read: if true;\n\n      // Only admins can write videos\n      allow write: if isAdminUser() &&\n                   fileName.matches('video.*') &&\n                   request.resource.size < 200 * 1024 * 1024 && // Max 200MB\n                   request.resource.contentType.matches('video/.*');\n\n      // Only admins can write thumbnails\n      allow write: if isAdminUser() &&\n                   fileName.matches('thumbnail.*') &&\n                   request.resource.size < 5 * 1024 * 1024 && // Max 5MB\n                   request.resource.contentType.matches('image/.*');\n    }\n\n    // ========== NEWS ==========\n    match /news/{newsId}/{fileName} {\n      // Public read for news images\n      allow read: if true;\n\n      // Only admins can write\n      allow write: if isAdminUser() &&\n                   request.resource.size < 10 * 1024 * 1024 && // Max 10MB\n                   request.resource.contentType.matches('image/.*');\n    }\n\n    // ========== BOOKS ==========\n    match /books/{bookId}/{fileName} {\n      // Public read for book covers\n      allow read: if true;\n\n      // Only admins can write\n      allow write: if isAdminUser() &&\n                   request.resource.size < 5 * 1024 * 1024 && // Max 5MB\n                   request.resource.contentType.matches('image/.*');\n    }\n\n    // ========== FLYERS ==========\n    match /flyers/{flyerId}/{fileName} {\n      // Public read for flyers\n      allow read: if true;\n\n      // Only admins can write PDFs\n      allow write: if isAdminUser() &&\n                   request.resource.size < 20 * 1024 * 1024 && // Max 20MB\n                   request.resource.contentType == 'application/pdf';\n    }\n\n    // ========== COMMUNITY POSTS ==========\n    match /communityPosts/{postId}/{fileName} {\n      // Public read for community post images\n      allow read: if true;\n\n      // Only admins can write\n      allow write: if isAdminUser() &&\n                   request.resource.size < 10 * 1024 * 1024 && // Max 10MB\n                   request.resource.contentType.matches('image/.*');\n    }\n\n    // ========== INSTITUTIONS ==========\n    match /institutions/{institutionId}/{fileName} {\n      // Public read for institution images\n      allow read: if true;\n\n      // Only admins can write\n      allow write: if isAdminUser() &&\n                   request.resource.size < 10 * 1024 * 1024 && // Max 10MB\n                   request.resource.contentType.matches('image/.*');\n    }\n\n    // ========== HOME CARDS ==========\n    match /cards/{cardId}/{fileName} {\n      // Public read for card images\n      allow read: if true;\n\n      // Only admins can write\n      allow write: if isAdminUser() &&\n                   request.resource.size < 5 * 1024 * 1024 && // Max 5MB\n                   request.resource.contentType.matches('image/.*');\n    }\n\n    // ========== ALERTS ==========\n    match /alerts/{alertId}/{fileName} {\n      // Public read for alert images and audio\n      allow read: if true;\n\n      // Only admins can write images\n      allow write: if isAdminUser() &&\n                   fileName.matches('.*\\\\.(jpg|jpeg|png|gif)$') &&\n                   request.resource.size < 10 * 1024 * 1024 && // Max 10MB\n                   request.resource.contentType.matches('image/.*');\n\n      // Only admins can write audio files\n      allow write: if isAdminUser() &&\n                   fileName.matches('.*\\\\.(mp3|m4a|wav|aac)$') &&\n                   request.resource.size < 20 * 1024 * 1024 && // Max 20MB\n                   request.resource.contentType.matches('audio/.*');\n    }\n\n    // ========== DEFAULT DENY ==========\n    match /{allPaths=**} {\n      allow read, write: if false;\n    }\n  }\n}\n","name":"storage.rules"}]},"createTime":"2025-11-21T09:12:04.375391Z","metadata":{"services":["firebase.storage"]}}
[debug] [2025-11-21T09:12:04.386Z] [rules] created ruleset projects/eyalamrami-1d69e/rulesets/65279af2-9473-41cd-9cb2-6090289a841e
[debug] [2025-11-21T09:12:04.387Z] [rules] releasing firebase.storage/eyalamrami-1d69e.firebasestorage.app with ruleset projects/eyalamrami-1d69e/rulesets/65279af2-9473-41cd-9cb2-6090289a841e
[debug] [2025-11-21T09:12:04.387Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:12:04.387Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:12:04.387Z] >>> [apiv2][query] PATCH https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app [none]
[debug] [2025-11-21T09:12:04.387Z] >>> [apiv2][body] PATCH https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app {"release":{"name":"projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app","rulesetName":"projects/eyalamrami-1d69e/rulesets/65279af2-9473-41cd-9cb2-6090289a841e"}}
[debug] [2025-11-21T09:12:05.278Z] <<< [apiv2][status] PATCH https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app 200
[debug] [2025-11-21T09:12:05.279Z] <<< [apiv2][body] PATCH https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app {"name":"projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app","rulesetName":"projects/eyalamrami-1d69e/rulesets/65279af2-9473-41cd-9cb2-6090289a841e","createTime":"2025-11-16T21:57:38.715272Z","updateTime":"2025-11-21T09:12:05.270073Z"}
[debug] [2025-11-21T09:12:05.279Z] [rules] updated release projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app
[info] ✔  storage: released rules storage.rules to firebase.storage 
[info] 
[info] ✔  Deploy complete! 
[info] 
[info] Project Console: https://console.firebase.google.com/project/eyalamrami-1d69e/overview
[debug] [2025-11-21T09:15:01.588Z] ----------------------------------------------------------------------
[debug] [2025-11-21T09:15:01.590Z] Command:       /opt/homebrew/Cellar/node/24.4.1/bin/node /opt/homebrew/bin/firebase deploy --only storage
[debug] [2025-11-21T09:15:01.590Z] CLI Version:   14.25.1
[debug] [2025-11-21T09:15:01.590Z] Platform:      darwin
[debug] [2025-11-21T09:15:01.590Z] Node Version:  v24.4.1
[debug] [2025-11-21T09:15:01.590Z] Time:          Fri Nov 21 2025 11:15:01 GMT+0200 (Israel Standard Time)
[debug] [2025-11-21T09:15:01.590Z] ----------------------------------------------------------------------
[debug] 
[debug] [2025-11-21T09:15:01.680Z] > command requires scopes: ["email","openid","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","https://www.googleapis.com/auth/cloud-platform"]
[debug] [2025-11-21T09:15:01.681Z] > authorizing via signed-in user (orel895@gmail.com)
[debug] [2025-11-21T09:15:01.681Z] [iam] checking project eyalamrami-1d69e for permissions ["firebase.projects.get","firebaserules.releases.create","firebaserules.releases.update","firebaserules.rulesets.create"]
[debug] [2025-11-21T09:15:01.681Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:15:01.681Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:15:01.682Z] >>> [apiv2][query] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions [none]
[debug] [2025-11-21T09:15:01.682Z] >>> [apiv2][(partial)header] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions x-goog-quota-user=projects/eyalamrami-1d69e
[debug] [2025-11-21T09:15:01.682Z] >>> [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions {"permissions":["firebase.projects.get","firebaserules.releases.create","firebaserules.releases.update","firebaserules.rulesets.create"]}
[debug] [2025-11-21T09:15:02.722Z] <<< [apiv2][status] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions 200
[debug] [2025-11-21T09:15:02.722Z] <<< [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions {"permissions":["firebase.projects.get","firebaserules.releases.create","firebaserules.releases.update","firebaserules.rulesets.create"]}
[info] 
[info] === Deploying to 'eyalamrami-1d69e'...
[info] 
[info] i  deploying storage 
[info] i  storage: ensuring required API firebasestorage.googleapis.com is enabled... 
[debug] [2025-11-21T09:15:02.725Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:15:02.725Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:15:02.725Z] >>> [apiv2][query] GET https://firebasestorage.googleapis.com/v1alpha/projects/eyalamrami-1d69e/defaultBucket [none]
[debug] [2025-11-21T09:15:03.310Z] <<< [apiv2][status] GET https://firebasestorage.googleapis.com/v1alpha/projects/eyalamrami-1d69e/defaultBucket 200
[debug] [2025-11-21T09:15:03.310Z] <<< [apiv2][body] GET https://firebasestorage.googleapis.com/v1alpha/projects/eyalamrami-1d69e/defaultBucket {"name":"projects/eyalamrami-1d69e/defaultBucket","location":"EUROPE-WEST2","bucket":{"name":"projects/eyalamrami-1d69e/buckets/eyalamrami-1d69e.firebasestorage.app"},"storageClass":"REGIONAL"}
[info] i  firebase.storage: checking storage.rules for compilation errors... 
[debug] [2025-11-21T09:15:03.313Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:15:03.314Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:15:03.314Z] >>> [apiv2][query] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test [none]
[debug] [2025-11-21T09:15:03.314Z] >>> [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test [omitted]
[debug] [2025-11-21T09:15:03.830Z] <<< [apiv2][status] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test 200
[debug] [2025-11-21T09:15:03.831Z] <<< [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test {}
[info] ✔  firebase.storage: rules file storage.rules compiled successfully 
[debug] [2025-11-21T09:15:03.834Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:15:03.834Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:15:03.835Z] >>> [apiv2][query] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases pageSize=10&pageToken=
[debug] [2025-11-21T09:15:04.517Z] <<< [apiv2][status] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases 200
[debug] [2025-11-21T09:15:04.517Z] <<< [apiv2][body] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases {"releases":[{"name":"projects/eyalamrami-1d69e/releases/cloud.firestore","rulesetName":"projects/eyalamrami-1d69e/rulesets/759dde9d-eb39-467d-9ca1-a623ac445240","createTime":"2025-11-16T21:56:37.010939Z","updateTime":"2025-11-20T17:38:56.236233Z"},{"name":"projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app","rulesetName":"projects/eyalamrami-1d69e/rulesets/65279af2-9473-41cd-9cb2-6090289a841e","createTime":"2025-11-16T21:57:38.715272Z","updateTime":"2025-11-21T09:12:05.270073Z"}]}
[debug] [2025-11-21T09:15:04.542Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:15:04.542Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:15:04.542Z] >>> [apiv2][query] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets/65279af2-9473-41cd-9cb2-6090289a841e [none]
[debug] [2025-11-21T09:15:05.276Z] <<< [apiv2][status] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets/65279af2-9473-41cd-9cb2-6090289a841e 200
[debug] [2025-11-21T09:15:05.277Z] <<< [apiv2][body] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets/65279af2-9473-41cd-9cb2-6090289a841e [omitted]
[info] i  storage: uploading rules storage.rules... 
[debug] [2025-11-21T09:15:05.278Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:15:05.278Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:15:05.278Z] >>> [apiv2][query] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets [none]
[debug] [2025-11-21T09:15:05.278Z] >>> [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets [omitted]
[debug] [2025-11-21T09:15:06.149Z] <<< [apiv2][status] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets 200
[debug] [2025-11-21T09:15:06.149Z] <<< [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets {"name":"projects/eyalamrami-1d69e/rulesets/8e169373-ef5a-460f-921a-f60c4ff8c266","source":{"files":[{"content":"rules_version = '2';\nservice firebase.storage {\n  match /b/{bucket}/o {\n    \n    // Helper function to check admin via Firestore\n    function isAdmin() {\n      return request.auth != null && \n             firestore.get(/databases/(default)/documents/users/$(request.auth.uid)).data.role == 'admin';\n    }\n    \n    // Helper function to check admin via custom claims (fallback)\n    function isAdminClaim() {\n      return request.auth != null && request.auth.token.admin == true;\n    }\n    \n    // Hardcoded admin UID for fallback (orel895@gmail.com)\n    function isHardcodedAdmin() {\n      return request.auth != null && request.auth.uid == 'tewQ0ZYs4bMeondJMSAS5T0XnTC3';\n    }\n    \n    // Combined admin check - try Firestore first, then custom claims, then hardcoded UID\n    function isAdminUser() {\n      return isAdmin() || isAdminClaim() || isHardcodedAdmin();\n    }\n    \n    // ========== AUDIO DAILY ==========\n    match /audio/daily/{date}/{fileName} {\n      // Public read for daily audio\n      allow read: if true;\n      \n      // Only admins can write\n      allow write: if isAdminUser() &&\n                   request.resource.size < 20 * 1024 * 1024 && // Max 20MB\n                   request.resource.contentType.matches('audio/.*');\n    }\n    \n    // ========== VIDEO STORIES ==========\n    match /video/stories/{date}/{clipId} {\n      // Public read for story videos\n      allow read: if true;\n      \n      // Only admins can write (enforce .mp4 in validation)\n      allow write: if isAdminUser() &&\n                   request.resource.size < 100 * 1024 * 1024 && // Max 100MB\n                   request.resource.contentType.matches('video/.*') &&\n                   clipId.matches('.*\\\\.mp4$');\n    }\n    \n    // ========== VIDEO STORIES THUMBNAILS ==========\n    match /video/stories_thumbs/{date}/{clipId} {\n      // Public read for story thumbnails\n      allow read: if true;\n      \n      // Only admins can write (enforce .jpg in validation)\n      allow write: if isAdminUser() &&\n                   request.resource.size < 5 * 1024 * 1024 && // Max 5MB\n                   request.resource.contentType.matches('image/.*') &&\n                   clipId.matches('.*\\\\.jpg$');\n    }\n    \n    // ========== IMAGES (General) ==========\n    match /images/{allPaths=**} {\n      // Public read for images\n      allow read: if true;\n\n      // Only admins can write\n      allow write: if isAdminUser() &&\n                   request.resource.size < 10 * 1024 * 1024 && // Max 10MB\n                   request.resource.contentType.matches('image/.*');\n    }\n\n    // ========== LESSONS ==========\n    match /lessons/{lessonId}/{fileName} {\n      // Public read for lesson thumbnails\n      allow read: if true;\n\n      // Only admins can write\n      allow write: if isAdminUser() &&\n                   request.resource.size < 5 * 1024 * 1024 && // Max 5MB\n                   request.resource.contentType.matches('image/.*');\n    }\n\n    // ========== PODCASTS ==========\n    match /podcasts/{podcastId}/{fileName} {\n      // Public read for podcast audio and thumbnails\n      allow read: if true;\n\n      // Only admins can write audio files\n      allow write: if isAdminUser() &&\n                   fileName == 'audio.mp3' &&\n                   request.resource.size < 100 * 1024 * 1024 && // Max 100MB\n                   request.resource.contentType.matches('audio/.*');\n\n      // Only admins can write thumbnail images\n      allow write: if isAdminUser() &&\n                   fileName == 'thumbnail.jpg' &&\n                   request.resource.size < 5 * 1024 * 1024 && // Max 5MB\n                   request.resource.contentType.matches('image/.*');\n    }\n\n    // ========== DAILY VIDEOS ==========\n    match /dailyVideos/{videoId}/{fileName} {\n      // Public read for daily videos\n      allow read: if true;\n\n      // Only admins can write videos\n      allow write: if isAdminUser() &&\n                   fileName.matches('video.*') &&\n                   request.resource.size < 200 * 1024 * 1024 && // Max 200MB\n                   request.resource.contentType.matches('video/.*');\n\n      // Only admins can write thumbnails\n      allow write: if isAdminUser() &&\n                   fileName.matches('thumbnail.*') &&\n                   request.resource.size < 5 * 1024 * 1024 && // Max 5MB\n                   request.resource.contentType.matches('image/.*');\n    }\n\n    // ========== NEWS ==========\n    match /news/{newsId}/{fileName} {\n      // Public read for news images\n      allow read: if true;\n\n      // Only admins can write\n      allow write: if isAdminUser() &&\n                   request.resource.size < 10 * 1024 * 1024 && // Max 10MB\n                   request.resource.contentType.matches('image/.*');\n    }\n\n    // ========== BOOKS ==========\n    match /books/{bookId}/{fileName} {\n      // Public read for book covers\n      allow read: if true;\n\n      // Only admins can write\n      allow write: if isAdminUser() &&\n                   request.resource.size < 5 * 1024 * 1024 && // Max 5MB\n                   request.resource.contentType.matches('image/.*');\n    }\n\n    // ========== FLYERS ==========\n    match /flyers/{flyerId}/{fileName} {\n      // Public read for flyers\n      allow read: if true;\n\n      // Only admins can write PDFs\n      allow write: if isAdminUser() &&\n                   request.resource.size < 20 * 1024 * 1024 && // Max 20MB\n                   request.resource.contentType == 'application/pdf';\n    }\n\n    // ========== COMMUNITY POSTS ==========\n    match /communityPosts/{postId}/{fileName} {\n      // Public read for community post images\n      allow read: if true;\n\n      // Only admins can write\n      allow write: if isAdminUser() &&\n                   request.resource.size < 10 * 1024 * 1024 && // Max 10MB\n                   request.resource.contentType.matches('image/.*');\n    }\n\n    // ========== INSTITUTIONS ==========\n    match /institutions/{institutionId}/{fileName} {\n      // Public read for institution images\n      allow read: if true;\n\n      // Only admins can write\n      allow write: if isAdminUser() &&\n                   request.resource.size < 10 * 1024 * 1024 && // Max 10MB\n                   request.resource.contentType.matches('image/.*');\n    }\n\n    // ========== HOME CARDS ==========\n    match /cards/{cardId}/{fileName} {\n      // Public read for card images\n      allow read: if true;\n\n      // Only admins can write\n      allow write: if isAdminUser() &&\n                   request.resource.size < 5 * 1024 * 1024 && // Max 5MB\n                   request.resource.contentType.matches('image/.*');\n    }\n\n    // ========== ALERTS ==========\n    match /alerts/{alertId}/{fileName} {\n      // Public read for alert images and audio\n      allow read: if true;\n\n      // Only admins can write images\n      allow write: if isAdminUser() &&\n                   fileName.matches('.*\\\\.(jpg|jpeg|png|gif)$') &&\n                   request.resource.size < 10 * 1024 * 1024 && // Max 10MB\n                   request.resource.contentType.matches('image/.*');\n\n      // Only admins can write audio files\n      allow write: if isAdminUser() &&\n                   fileName.matches('.*\\\\.(mp3|m4a|wav|aac)$') &&\n                   request.resource.size < 20 * 1024 * 1024 && // Max 20MB\n                   request.resource.contentType.matches('audio/.*');\n    }\n\n    // ========== DEFAULT DENY ==========\n    match /{allPaths=**} {\n      allow read, write: if false;\n    }\n  }\n}\n","name":"storage.rules"}]},"createTime":"2025-11-21T09:15:06.142303Z","metadata":{"services":["firebase.storage"]}}
[debug] [2025-11-21T09:15:06.149Z] [rules] created ruleset projects/eyalamrami-1d69e/rulesets/8e169373-ef5a-460f-921a-f60c4ff8c266
[debug] [2025-11-21T09:15:06.149Z] [rules] releasing firebase.storage/eyalamrami-1d69e.firebasestorage.app with ruleset projects/eyalamrami-1d69e/rulesets/8e169373-ef5a-460f-921a-f60c4ff8c266
[debug] [2025-11-21T09:15:06.150Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:15:06.150Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:15:06.150Z] >>> [apiv2][query] PATCH https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app [none]
[debug] [2025-11-21T09:15:06.150Z] >>> [apiv2][body] PATCH https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app {"release":{"name":"projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app","rulesetName":"projects/eyalamrami-1d69e/rulesets/8e169373-ef5a-460f-921a-f60c4ff8c266"}}
[debug] [2025-11-21T09:15:07.121Z] <<< [apiv2][status] PATCH https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app 200
[debug] [2025-11-21T09:15:07.121Z] <<< [apiv2][body] PATCH https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app {"name":"projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app","rulesetName":"projects/eyalamrami-1d69e/rulesets/8e169373-ef5a-460f-921a-f60c4ff8c266","createTime":"2025-11-16T21:57:38.715272Z","updateTime":"2025-11-21T09:15:07.010792Z"}
[debug] [2025-11-21T09:15:07.122Z] [rules] updated release projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app
[info] ✔  storage: released rules storage.rules to firebase.storage 
[info] 
[info] ✔  Deploy complete! 
[info] 
[info] Project Console: https://console.firebase.google.com/project/eyalamrami-1d69e/overview
[debug] [2025-11-21T09:17:14.133Z] ----------------------------------------------------------------------
[debug] [2025-11-21T09:17:14.136Z] Command:       /opt/homebrew/Cellar/node/24.4.1/bin/node /opt/homebrew/bin/firebase deploy --only storage
[debug] [2025-11-21T09:17:14.136Z] CLI Version:   14.25.1
[debug] [2025-11-21T09:17:14.136Z] Platform:      darwin
[debug] [2025-11-21T09:17:14.136Z] Node Version:  v24.4.1
[debug] [2025-11-21T09:17:14.136Z] Time:          Fri Nov 21 2025 11:17:14 GMT+0200 (Israel Standard Time)
[debug] [2025-11-21T09:17:14.136Z] ----------------------------------------------------------------------
[debug] 
[debug] [2025-11-21T09:17:14.230Z] > command requires scopes: ["email","openid","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","https://www.googleapis.com/auth/cloud-platform"]
[debug] [2025-11-21T09:17:14.231Z] > authorizing via signed-in user (orel895@gmail.com)
[debug] [2025-11-21T09:17:14.231Z] [iam] checking project eyalamrami-1d69e for permissions ["firebase.projects.get","firebaserules.releases.create","firebaserules.releases.update","firebaserules.rulesets.create"]
[debug] [2025-11-21T09:17:14.231Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:17:14.231Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:17:14.232Z] >>> [apiv2][query] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions [none]
[debug] [2025-11-21T09:17:14.232Z] >>> [apiv2][(partial)header] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions x-goog-quota-user=projects/eyalamrami-1d69e
[debug] [2025-11-21T09:17:14.232Z] >>> [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions {"permissions":["firebase.projects.get","firebaserules.releases.create","firebaserules.releases.update","firebaserules.rulesets.create"]}
[debug] [2025-11-21T09:17:15.202Z] <<< [apiv2][status] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions 200
[debug] [2025-11-21T09:17:15.202Z] <<< [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions {"permissions":["firebase.projects.get","firebaserules.releases.create","firebaserules.releases.update","firebaserules.rulesets.create"]}
[info] 
[info] === Deploying to 'eyalamrami-1d69e'...
[info] 
[info] i  deploying storage 
[info] i  storage: ensuring required API firebasestorage.googleapis.com is enabled... 
[debug] [2025-11-21T09:17:15.206Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:17:15.206Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:17:15.206Z] >>> [apiv2][query] GET https://firebasestorage.googleapis.com/v1alpha/projects/eyalamrami-1d69e/defaultBucket [none]
[debug] [2025-11-21T09:17:15.837Z] <<< [apiv2][status] GET https://firebasestorage.googleapis.com/v1alpha/projects/eyalamrami-1d69e/defaultBucket 200
[debug] [2025-11-21T09:17:15.837Z] <<< [apiv2][body] GET https://firebasestorage.googleapis.com/v1alpha/projects/eyalamrami-1d69e/defaultBucket {"name":"projects/eyalamrami-1d69e/defaultBucket","location":"EUROPE-WEST2","bucket":{"name":"projects/eyalamrami-1d69e/buckets/eyalamrami-1d69e.firebasestorage.app"},"storageClass":"REGIONAL"}
[info] i  firebase.storage: checking storage.rules for compilation errors... 
[debug] [2025-11-21T09:17:15.839Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:17:15.839Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:17:15.840Z] >>> [apiv2][query] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test [none]
[debug] [2025-11-21T09:17:15.840Z] >>> [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test [omitted]
[debug] [2025-11-21T09:17:16.635Z] <<< [apiv2][status] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test 200
[debug] [2025-11-21T09:17:16.635Z] <<< [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test {"issues":[{"sourcePosition":{"fileName":"storage.rules","line":6,"column":14,"currentOffset":142,"endOffset":148},"description":"Unused function: isAdmin.","severity":"WARNING"},{"sourcePosition":{"fileName":"storage.rules","line":7,"column":14,"currentOffset":167,"endOffset":173},"description":"Invalid variable name: request.","severity":"WARNING"},{"sourcePosition":{"fileName":"storage.rules","line":8,"column":24,"currentOffset":215,"endOffset":217},"description":"Invalid function name: firestore.get.","severity":"WARNING"},{"sourcePosition":{"fileName":"storage.rules","line":8,"column":67,"currentOffset":258,"endOffset":264},"description":"Invalid variable name: request.","severity":"WARNING"},{"sourcePosition":{"fileName":"storage.rules","line":12,"column":14,"currentOffset":390,"endOffset":401},"description":"Unused function: isAdminClaim.","severity":"WARNING"},{"sourcePosition":{"fileName":"storage.rules","line":13,"column":14,"currentOffset":420,"endOffset":426},"description":"Invalid variable name: request.","severity":"WARNING"},{"sourcePosition":{"fileName":"storage.rules","line":13,"column":38,"currentOffset":444,"endOffset":450},"description":"Invalid variable name: request.","severity":"WARNING"},{"sourcePosition":{"fileName":"storage.rules","line":17,"column":14,"currentOffset":562,"endOffset":577},"description":"Unused function: isHardcodedAdmin.","severity":"WARNING"},{"sourcePosition":{"fileName":"storage.rules","line":18,"column":14,"currentOffset":596,"endOffset":602},"description":"Invalid variable name: request.","severity":"WARNING"},{"sourcePosition":{"fileName":"storage.rules","line":18,"column":38,"currentOffset":620,"endOffset":626},"description":"Invalid variable name: request.","severity":"WARNING"}]}
[warn] ⚠  [W] 6:14 - Unused function: isAdmin. 
[warn] ⚠  [W] 7:14 - Invalid variable name: request. 
[warn] ⚠  [W] 8:24 - Invalid function name: firestore.get. 
[warn] ⚠  [W] 8:67 - Invalid variable name: request. 
[warn] ⚠  [W] 12:14 - Unused function: isAdminClaim. 
[warn] ⚠  [W] 13:14 - Invalid variable name: request. 
[warn] ⚠  [W] 13:38 - Invalid variable name: request. 
[warn] ⚠  [W] 17:14 - Unused function: isHardcodedAdmin. 
[warn] ⚠  [W] 18:14 - Invalid variable name: request. 
[warn] ⚠  [W] 18:38 - Invalid variable name: request. 
[info] ✔  firebase.storage: rules file storage.rules compiled successfully 
[debug] [2025-11-21T09:17:16.637Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:17:16.637Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:17:16.637Z] >>> [apiv2][query] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases pageSize=10&pageToken=
[debug] [2025-11-21T09:17:16.853Z] <<< [apiv2][status] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases 200
[debug] [2025-11-21T09:17:16.853Z] <<< [apiv2][body] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases {"releases":[{"name":"projects/eyalamrami-1d69e/releases/cloud.firestore","rulesetName":"projects/eyalamrami-1d69e/rulesets/759dde9d-eb39-467d-9ca1-a623ac445240","createTime":"2025-11-16T21:56:37.010939Z","updateTime":"2025-11-20T17:38:56.236233Z"},{"name":"projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app","rulesetName":"projects/eyalamrami-1d69e/rulesets/8e169373-ef5a-460f-921a-f60c4ff8c266","createTime":"2025-11-16T21:57:38.715272Z","updateTime":"2025-11-21T09:15:07.010792Z"}]}
[debug] [2025-11-21T09:17:16.871Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:17:16.871Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:17:16.871Z] >>> [apiv2][query] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets/8e169373-ef5a-460f-921a-f60c4ff8c266 [none]
[debug] [2025-11-21T09:17:17.552Z] <<< [apiv2][status] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets/8e169373-ef5a-460f-921a-f60c4ff8c266 200
[debug] [2025-11-21T09:17:17.552Z] <<< [apiv2][body] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets/8e169373-ef5a-460f-921a-f60c4ff8c266 [omitted]
[info] i  storage: uploading rules storage.rules... 
[debug] [2025-11-21T09:17:17.555Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:17:17.556Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:17:17.556Z] >>> [apiv2][query] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets [none]
[debug] [2025-11-21T09:17:17.556Z] >>> [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets [omitted]
[debug] [2025-11-21T09:17:18.412Z] <<< [apiv2][status] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets 200
[debug] [2025-11-21T09:17:18.412Z] <<< [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets {"name":"projects/eyalamrami-1d69e/rulesets/7f0280e0-2522-44c4-9384-b8e22fdc6036","source":{"files":[{"content":"rules_version = '2';\nservice firebase.storage {\n  match /b/{bucket}/o {\n    \n    // Helper function to check admin via Firestore\n    function isAdmin() {\n      return request.auth != null && \n             firestore.get(/databases/(default)/documents/users/$(request.auth.uid)).data.role == 'admin';\n    }\n    \n    // Helper function to check admin via custom claims (fallback)\n    function isAdminClaim() {\n      return request.auth != null && request.auth.token.admin == true;\n    }\n    \n    // Hardcoded admin UID for fallback (orel895@gmail.com)\n    function isHardcodedAdmin() {\n      return request.auth != null && request.auth.uid == 'tewQ0ZYs4bMeondJMSAS5T0XnTC3';\n    }\n    \n    // Combined admin check - try Firestore first, then custom claims, then hardcoded UID\n    // TEMPORARY FIX: Allow any authenticated user to write to unblock the admin panel\n    function isAdminUser() {\n      return request.auth != null; \n      // return isAdmin() || isAdminClaim() || isHardcodedAdmin();\n    }\n    \n    // ========== AUDIO DAILY ==========\n    match /audio/daily/{date}/{fileName} {\n      // Public read for daily audio\n      allow read: if true;\n      \n      // Only admins can write\n      allow write: if isAdminUser() &&\n                   request.resource.size < 20 * 1024 * 1024 && // Max 20MB\n                   request.resource.contentType.matches('audio/.*');\n    }\n    \n    // ========== VIDEO STORIES ==========\n    match /video/stories/{date}/{clipId} {\n      // Public read for story videos\n      allow read: if true;\n      \n      // Only admins can write (enforce .mp4 in validation)\n      allow write: if isAdminUser() &&\n                   request.resource.size < 100 * 1024 * 1024 && // Max 100MB\n                   request.resource.contentType.matches('video/.*') &&\n                   clipId.matches('.*\\\\.mp4$');\n    }\n    \n    // ========== VIDEO STORIES THUMBNAILS ==========\n    match /video/stories_thumbs/{date}/{clipId} {\n      // Public read for story thumbnails\n      allow read: if true;\n      \n      // Only admins can write (enforce .jpg in validation)\n      allow write: if isAdminUser() &&\n                   request.resource.size < 5 * 1024 * 1024 && // Max 5MB\n                   request.resource.contentType.matches('image/.*') &&\n                   clipId.matches('.*\\\\.jpg$');\n    }\n    \n    // ========== IMAGES (General) ==========\n    match /images/{allPaths=**} {\n      // Public read for images\n      allow read: if true;\n\n      // Only admins can write\n      allow write: if isAdminUser() &&\n                   request.resource.size < 10 * 1024 * 1024 && // Max 10MB\n                   request.resource.contentType.matches('image/.*');\n    }\n\n    // ========== LESSONS ==========\n    match /lessons/{lessonId}/{fileName} {\n      // Public read for lesson thumbnails\n      allow read: if true;\n\n      // Only admins can write\n      allow write: if isAdminUser() &&\n                   request.resource.size < 5 * 1024 * 1024 && // Max 5MB\n                   request.resource.contentType.matches('image/.*');\n    }\n\n    // ========== PODCASTS ==========\n    match /podcasts/{podcastId}/{fileName} {\n      // Public read for podcast audio and thumbnails\n      allow read: if true;\n\n      // Only admins can write audio files\n      allow write: if isAdminUser() &&\n                   fileName == 'audio.mp3' &&\n                   request.resource.size < 100 * 1024 * 1024 && // Max 100MB\n                   request.resource.contentType.matches('audio/.*');\n\n      // Only admins can write thumbnail images\n      allow write: if isAdminUser() &&\n                   fileName == 'thumbnail.jpg' &&\n                   request.resource.size < 5 * 1024 * 1024 && // Max 5MB\n                   request.resource.contentType.matches('image/.*');\n    }\n\n    // ========== DAILY VIDEOS ==========\n    match /dailyVideos/{videoId}/{fileName} {\n      // Public read for daily videos\n      allow read: if true;\n\n      // Only admins can write videos\n      allow write: if isAdminUser() &&\n                   fileName.matches('video.*') &&\n                   request.resource.size < 200 * 1024 * 1024 && // Max 200MB\n                   request.resource.contentType.matches('video/.*');\n\n      // Only admins can write thumbnails\n      allow write: if isAdminUser() &&\n                   fileName.matches('thumbnail.*') &&\n                   request.resource.size < 5 * 1024 * 1024 && // Max 5MB\n                   request.resource.contentType.matches('image/.*');\n    }\n\n    // ========== NEWS ==========\n    match /news/{newsId}/{fileName} {\n      // Public read for news images\n      allow read: if true;\n\n      // Only admins can write\n      allow write: if isAdminUser() &&\n                   request.resource.size < 10 * 1024 * 1024 && // Max 10MB\n                   request.resource.contentType.matches('image/.*');\n    }\n\n    // ========== BOOKS ==========\n    match /books/{bookId}/{fileName} {\n      // Public read for book covers\n      allow read: if true;\n\n      // Only admins can write\n      allow write: if isAdminUser() &&\n                   request.resource.size < 5 * 1024 * 1024 && // Max 5MB\n                   request.resource.contentType.matches('image/.*');\n    }\n\n    // ========== FLYERS ==========\n    match /flyers/{flyerId}/{fileName} {\n      // Public read for flyers\n      allow read: if true;\n\n      // Only admins can write PDFs\n      allow write: if isAdminUser() &&\n                   request.resource.size < 20 * 1024 * 1024 && // Max 20MB\n                   request.resource.contentType == 'application/pdf';\n    }\n\n    // ========== COMMUNITY POSTS ==========\n    match /communityPosts/{postId}/{fileName} {\n      // Public read for community post images\n      allow read: if true;\n\n      // Only admins can write\n      allow write: if isAdminUser() &&\n                   request.resource.size < 10 * 1024 * 1024 && // Max 10MB\n                   request.resource.contentType.matches('image/.*');\n    }\n\n    // ========== INSTITUTIONS ==========\n    match /institutions/{institutionId}/{fileName} {\n      // Public read for institution images\n      allow read: if true;\n\n      // Only admins can write\n      allow write: if isAdminUser() &&\n                   request.resource.size < 10 * 1024 * 1024 && // Max 10MB\n                   request.resource.contentType.matches('image/.*');\n    }\n\n    // ========== HOME CARDS ==========\n    match /cards/{cardId}/{fileName} {\n      // Public read for card images\n      allow read: if true;\n\n      // Only admins can write\n      allow write: if isAdminUser() &&\n                   request.resource.size < 5 * 1024 * 1024 && // Max 5MB\n                   request.resource.contentType.matches('image/.*');\n    }\n\n    // ========== ALERTS ==========\n    match /alerts/{alertId}/{fileName} {\n      // Public read for alert images and audio\n      allow read: if true;\n\n      // Only admins can write images\n      allow write: if isAdminUser() &&\n                   fileName.matches('.*\\\\.(jpg|jpeg|png|gif)$') &&\n                   request.resource.size < 10 * 1024 * 1024 && // Max 10MB\n                   request.resource.contentType.matches('image/.*');\n\n      // Only admins can write audio files\n      allow write: if isAdminUser() &&\n                   fileName.matches('.*\\\\.(mp3|m4a|wav|aac)$') &&\n                   request.resource.size < 20 * 1024 * 1024 && // Max 20MB\n                   request.resource.contentType.matches('audio/.*');\n    }\n\n    // ========== DEFAULT DENY ==========\n    match /{allPaths=**} {\n      allow read, write: if false;\n    }\n  }\n}\n","name":"storage.rules"}]},"createTime":"2025-11-21T09:17:18.406207Z","metadata":{"services":["firebase.storage"]}}
[debug] [2025-11-21T09:17:18.413Z] [rules] created ruleset projects/eyalamrami-1d69e/rulesets/7f0280e0-2522-44c4-9384-b8e22fdc6036
[debug] [2025-11-21T09:17:18.414Z] [rules] releasing firebase.storage/eyalamrami-1d69e.firebasestorage.app with ruleset projects/eyalamrami-1d69e/rulesets/7f0280e0-2522-44c4-9384-b8e22fdc6036
[debug] [2025-11-21T09:17:18.415Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:17:18.416Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:17:18.416Z] >>> [apiv2][query] PATCH https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app [none]
[debug] [2025-11-21T09:17:18.416Z] >>> [apiv2][body] PATCH https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app {"release":{"name":"projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app","rulesetName":"projects/eyalamrami-1d69e/rulesets/7f0280e0-2522-44c4-9384-b8e22fdc6036"}}
[debug] [2025-11-21T09:17:19.297Z] <<< [apiv2][status] PATCH https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app 200
[debug] [2025-11-21T09:17:19.297Z] <<< [apiv2][body] PATCH https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app {"name":"projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app","rulesetName":"projects/eyalamrami-1d69e/rulesets/7f0280e0-2522-44c4-9384-b8e22fdc6036","createTime":"2025-11-16T21:57:38.715272Z","updateTime":"2025-11-21T09:17:19.291220Z"}
[debug] [2025-11-21T09:17:19.298Z] [rules] updated release projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app
[info] ✔  storage: released rules storage.rules to firebase.storage 
[info] 
[info] ✔  Deploy complete! 
[info] 
[info] Project Console: https://console.firebase.google.com/project/eyalamrami-1d69e/overview
[debug] [2025-11-21T09:47:59.138Z] ----------------------------------------------------------------------
[debug] [2025-11-21T09:47:59.142Z] Command:       /opt/homebrew/Cellar/node/24.4.1/bin/node /opt/homebrew/bin/firebase deploy --only firestore:rules
[debug] [2025-11-21T09:47:59.142Z] CLI Version:   14.25.1
[debug] [2025-11-21T09:47:59.142Z] Platform:      darwin
[debug] [2025-11-21T09:47:59.142Z] Node Version:  v24.4.1
[debug] [2025-11-21T09:47:59.142Z] Time:          Fri Nov 21 2025 11:47:59 GMT+0200 (Israel Standard Time)
[debug] [2025-11-21T09:47:59.143Z] ----------------------------------------------------------------------
[debug] 
[debug] [2025-11-21T09:47:59.243Z] > command requires scopes: ["email","openid","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","https://www.googleapis.com/auth/cloud-platform"]
[debug] [2025-11-21T09:47:59.244Z] > authorizing via signed-in user (orel895@gmail.com)
[debug] [2025-11-21T09:47:59.244Z] [iam] checking project eyalamrami-1d69e for permissions ["datastore.indexes.create","datastore.indexes.delete","datastore.indexes.list","datastore.indexes.update","firebase.projects.get"]
[debug] [2025-11-21T09:47:59.245Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:47:59.245Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:47:59.245Z] >>> [apiv2][query] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions [none]
[debug] [2025-11-21T09:47:59.245Z] >>> [apiv2][(partial)header] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions x-goog-quota-user=projects/eyalamrami-1d69e
[debug] [2025-11-21T09:47:59.245Z] >>> [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions {"permissions":["datastore.indexes.create","datastore.indexes.delete","datastore.indexes.list","datastore.indexes.update","firebase.projects.get"]}
[debug] [2025-11-21T09:48:00.266Z] <<< [apiv2][status] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions 200
[debug] [2025-11-21T09:48:00.266Z] <<< [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions {"permissions":["datastore.indexes.create","datastore.indexes.delete","datastore.indexes.list","datastore.indexes.update","firebase.projects.get"]}
[info] 
[info] === Deploying to 'eyalamrami-1d69e'...
[info] 
[info] i  deploying firestore 
[info] i  firestore: ensuring required API firestore.googleapis.com is enabled... 
[info] i  firestore: ensuring required API firestore.googleapis.com is enabled... 
[debug] [2025-11-21T09:48:00.270Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:48:00.270Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:48:00.270Z] >>> [apiv2][query] GET https://firestore.googleapis.com/v1/projects/eyalamrami-1d69e/databases/(default) [none]
[debug] [2025-11-21T09:48:00.862Z] <<< [apiv2][status] GET https://firestore.googleapis.com/v1/projects/eyalamrami-1d69e/databases/(default) 200
[debug] [2025-11-21T09:48:00.862Z] <<< [apiv2][body] GET https://firestore.googleapis.com/v1/projects/eyalamrami-1d69e/databases/(default) {"name":"projects/eyalamrami-1d69e/databases/(default)","uid":"28c72577-e069-422d-b53f-9211ba17d04d","createTime":"2025-11-16T21:56:31.041581Z","updateTime":"2025-11-16T21:56:31.041581Z","locationId":"europe-west2","type":"FIRESTORE_NATIVE","concurrencyMode":"PESSIMISTIC","versionRetentionPeriod":"3600s","earliestVersionTime":"2025-11-21T08:48:01.041317Z","appEngineIntegrationMode":"DISABLED","keyPrefix":"g","pointInTimeRecoveryEnablement":"POINT_IN_TIME_RECOVERY_DISABLED","deleteProtectionState":"DELETE_PROTECTION_DISABLED","databaseEdition":"STANDARD","freeTier":true,"realtimeUpdatesMode":"REALTIME_UPDATES_MODE_ENABLED","etag":"INGkr6z7gpEDMMXn/oLW95AD"}
[info] i  firestore: reading indexes from firestore.indexes.json... 
[info] i  cloud.firestore: checking firestore.rules for compilation errors... 
[debug] [2025-11-21T09:48:00.866Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:48:00.866Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:48:00.866Z] >>> [apiv2][query] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test [none]
[debug] [2025-11-21T09:48:00.867Z] >>> [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test [omitted]
[debug] [2025-11-21T09:48:01.793Z] <<< [apiv2][status] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test 200
[debug] [2025-11-21T09:48:01.793Z] <<< [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test {}
[info] ✔  cloud.firestore: rules file firestore.rules compiled successfully 
[debug] [2025-11-21T09:48:01.795Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:48:01.796Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:48:01.796Z] >>> [apiv2][query] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases pageSize=10&pageToken=
[debug] [2025-11-21T09:48:02.128Z] <<< [apiv2][status] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases 200
[debug] [2025-11-21T09:48:02.128Z] <<< [apiv2][body] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases {"releases":[{"name":"projects/eyalamrami-1d69e/releases/cloud.firestore","rulesetName":"projects/eyalamrami-1d69e/rulesets/759dde9d-eb39-467d-9ca1-a623ac445240","createTime":"2025-11-16T21:56:37.010939Z","updateTime":"2025-11-20T17:38:56.236233Z"},{"name":"projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app","rulesetName":"projects/eyalamrami-1d69e/rulesets/7f0280e0-2522-44c4-9384-b8e22fdc6036","createTime":"2025-11-16T21:57:38.715272Z","updateTime":"2025-11-21T09:17:19.291220Z"}]}
[debug] [2025-11-21T09:48:02.156Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:48:02.156Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:48:02.156Z] >>> [apiv2][query] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets/759dde9d-eb39-467d-9ca1-a623ac445240 [none]
[debug] [2025-11-21T09:48:02.892Z] <<< [apiv2][status] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets/759dde9d-eb39-467d-9ca1-a623ac445240 200
[debug] [2025-11-21T09:48:02.893Z] <<< [apiv2][body] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets/759dde9d-eb39-467d-9ca1-a623ac445240 [omitted]
[info] i  firestore: uploading rules firestore.rules... 
[debug] [2025-11-21T09:48:02.895Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:48:02.895Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:48:02.895Z] >>> [apiv2][query] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets [none]
[debug] [2025-11-21T09:48:02.895Z] >>> [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets [omitted]
[debug] [2025-11-21T09:48:03.842Z] <<< [apiv2][status] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets 200
[debug] [2025-11-21T09:48:03.842Z] <<< [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets {"name":"projects/eyalamrami-1d69e/rulesets/96285181-c10e-4127-b9dc-b2ffc51f138c","source":{"files":[{"content":"rules_version = '2';\nservice cloud.firestore {\n  match /databases/{database}/documents {\n    \n    // ========== HELPER FUNCTIONS ==========\n    \n    function isSignedIn() {\n      return request.auth != null;\n    }\n    \n    function isAdmin() {\n      return isSignedIn() &&\n             get(/databases/$(database)/documents/users/$(request.auth.uid)).data.role == 'admin';\n    }\n    \n    // ========== USERS COLLECTION ==========\n    match /users/{uid} {\n      // Users can read/write their own document\n      allow read: if request.auth != null && request.auth.uid == uid;\n      allow write: if request.auth != null && request.auth.uid == uid;\n      \n      // Admins can write role field\n      allow update: if isAdmin() && \n                    request.resource.data.diff(resource.data).affectedKeys().hasOnly(['role']);\n    }\n    \n    // ========== DAILY INSIGHTS COLLECTION ==========\n    match /dailyInsights/{dateId} {\n      // Everyone can read published insights\n      allow read: if true;\n      \n      // Only admins can write\n      allow write: if isAdmin();\n    }\n    \n    // ========== DAILY STORIES COLLECTION ==========\n    match /dailyStories/{dateId}/clips/{clipId} {\n      // Everyone can read stories\n      allow read: if true;\n      \n      // Only admins can write\n      allow write: if isAdmin();\n    }\n    \n    // ========== NOTIFICATIONS COLLECTION ==========\n    match /notifications/{notificationId} {\n      // Only admins can read/write\n      allow read, write: if isAdmin();\n    }\n    \n    // ========== FEEDS COLLECTION ==========\n    match /feeds/{feedId} {\n      // Everyone can read published feeds, admins can read all\n      allow read: if resource.data.published == true || isAdmin();\n      \n      // Only admins can write\n      allow write: if isAdmin();\n    }\n    \n    // ========== FAITH LESSONS COLLECTION ==========\n    match /faithLessons/{lessonId} {\n      // Public read for published lessons\n      allow read: if resource.data.published == true || isAdmin();\n      \n      // Only admins can write\n      allow write: if isAdmin();\n    }\n    \n    // ========== LESSONS COLLECTION ==========\n    match /lessons/{lessonId} {\n      // Public read for all (lessons should be accessible to everyone)\n      allow read: if true;\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== PODCASTS COLLECTION ==========\n    match /podcasts/{podcastId} {\n      // All signed-in users can read active podcasts\n      allow read: if isSignedIn() && (resource.data.isActive == true || isAdmin());\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== DAILY VIDEOS COLLECTION ==========\n    match /dailyVideos/{videoId} {\n      // All signed-in users can read videos\n      allow read: if isSignedIn();\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== NEWS COLLECTION ==========\n    match /news/{newsId} {\n      // Only published news can be read by signed-in users\n      allow read: if isSignedIn() && resource.data.isPublished == true;\n      // Admins can read all (including drafts)\n      allow read: if isAdmin();\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== ALERTS COLLECTION ==========\n    match /alerts/{alertId} {\n      // All signed-in users can read alerts\n      allow read: if isSignedIn();\n      // Only admins can create, update, delete\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== HOME CARDS COLLECTION ==========\n    match /homeCards/{cardId} {\n      // Public read for all\n      allow read: if true;\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== APP CONFIG COLLECTION ==========\n    match /appConfig/{configId} {\n      // Public read\n      allow read: if true;\n      // Only admins can modify\n      allow write: if isAdmin();\n    }\n\n    // ========== INSTITUTIONS COLLECTION ==========\n    match /institutions/{institutionId} {\n      // Public read for all\n      allow read: if true;\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== INSTITUTIONS CONTENT COLLECTION ==========\n    match /institutionsContent/{activityId} {\n      // All signed-in users can read institution content\n      allow read: if isSignedIn();\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== BOOKS COLLECTION ==========\n    match /books/{bookId} {\n      // All signed-in users can read books\n      allow read: if isSignedIn();\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== FLYERS COLLECTION ==========\n    match /flyers/{flyerId} {\n      // All signed-in users can read flyers\n      allow read: if isSignedIn();\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== COMMUNITY POSTS COLLECTION ==========\n    match /communityPosts/{postId} {\n      // All signed-in users can read community posts\n      allow read: if isSignedIn();\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== LEADS COLLECTION ==========\n    match /leads/{leadId} {\n      // Anyone can create a lead (for contact forms)\n      allow create: if true;\n      // Only admins can read leads\n      allow read, update, delete: if isAdmin();\n    }\n\n    // ========== FAITH STORIES COLLECTION ==========\n    match /faith_stories/{storyId} {\n      // Admins can read all stories\n      allow read: if isAdmin();\n      // Signed-in users can read active stories\n      allow read: if isSignedIn() && resource.data.isActive == true;\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== DEFAULT DENY ==========\n    match /{document=**} {\n      allow read, write: if false;\n    }\n  }\n}\n","name":"firestore.rules"}]},"createTime":"2025-11-21T09:48:03.873119Z","metadata":{"services":["cloud.firestore"]}}
[debug] [2025-11-21T09:48:03.842Z] [rules] created ruleset projects/eyalamrami-1d69e/rulesets/96285181-c10e-4127-b9dc-b2ffc51f138c
[debug] [2025-11-21T09:48:03.842Z] [rules] releasing cloud.firestore/(default) with ruleset projects/eyalamrami-1d69e/rulesets/96285181-c10e-4127-b9dc-b2ffc51f138c
[debug] [2025-11-21T09:48:03.843Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:48:03.843Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:48:03.843Z] >>> [apiv2][query] PATCH https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases/cloud.firestore/(default) [none]
[debug] [2025-11-21T09:48:03.843Z] >>> [apiv2][body] PATCH https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases/cloud.firestore/(default) {"release":{"name":"projects/eyalamrami-1d69e/releases/cloud.firestore/(default)","rulesetName":"projects/eyalamrami-1d69e/rulesets/96285181-c10e-4127-b9dc-b2ffc51f138c"}}
[debug] [2025-11-21T09:48:04.760Z] <<< [apiv2][status] PATCH https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases/cloud.firestore/(default) 200
[debug] [2025-11-21T09:48:04.760Z] <<< [apiv2][body] PATCH https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases/cloud.firestore/(default) {"name":"projects/eyalamrami-1d69e/releases/cloud.firestore","rulesetName":"projects/eyalamrami-1d69e/rulesets/96285181-c10e-4127-b9dc-b2ffc51f138c","createTime":"2025-11-16T21:56:37.010939Z","updateTime":"2025-11-21T09:48:04.842045Z"}
[debug] [2025-11-21T09:48:04.760Z] [rules] updated release projects/eyalamrami-1d69e/releases/cloud.firestore
[info] ✔  firestore: released rules firestore.rules to cloud.firestore 
[info] 
[info] ✔  Deploy complete! 
[info] 
[info] Project Console: https://console.firebase.google.com/project/eyalamrami-1d69e/overview
[debug] [2025-11-21T09:51:24.198Z] ----------------------------------------------------------------------
[debug] [2025-11-21T09:51:24.200Z] Command:       /opt/homebrew/Cellar/node/24.4.1/bin/node /opt/homebrew/bin/firebase deploy --only firestore:rules
[debug] [2025-11-21T09:51:24.200Z] CLI Version:   14.25.1
[debug] [2025-11-21T09:51:24.200Z] Platform:      darwin
[debug] [2025-11-21T09:51:24.201Z] Node Version:  v24.4.1
[debug] [2025-11-21T09:51:24.201Z] Time:          Fri Nov 21 2025 11:51:24 GMT+0200 (Israel Standard Time)
[debug] [2025-11-21T09:51:24.201Z] ----------------------------------------------------------------------
[debug] 
[debug] [2025-11-21T09:51:24.291Z] > command requires scopes: ["email","openid","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","https://www.googleapis.com/auth/cloud-platform"]
[debug] [2025-11-21T09:51:24.291Z] > authorizing via signed-in user (orel895@gmail.com)
[debug] [2025-11-21T09:51:24.291Z] [iam] checking project eyalamrami-1d69e for permissions ["datastore.indexes.create","datastore.indexes.delete","datastore.indexes.list","datastore.indexes.update","firebase.projects.get"]
[debug] [2025-11-21T09:51:24.292Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:51:24.292Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:51:24.293Z] >>> [apiv2][query] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions [none]
[debug] [2025-11-21T09:51:24.293Z] >>> [apiv2][(partial)header] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions x-goog-quota-user=projects/eyalamrami-1d69e
[debug] [2025-11-21T09:51:24.293Z] >>> [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions {"permissions":["datastore.indexes.create","datastore.indexes.delete","datastore.indexes.list","datastore.indexes.update","firebase.projects.get"]}
[debug] [2025-11-21T09:51:25.289Z] <<< [apiv2][status] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions 200
[debug] [2025-11-21T09:51:25.289Z] <<< [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions {"permissions":["datastore.indexes.create","datastore.indexes.delete","datastore.indexes.list","datastore.indexes.update","firebase.projects.get"]}
[info] 
[info] === Deploying to 'eyalamrami-1d69e'...
[info] 
[info] i  deploying firestore 
[info] i  firestore: ensuring required API firestore.googleapis.com is enabled... 
[info] i  firestore: ensuring required API firestore.googleapis.com is enabled... 
[debug] [2025-11-21T09:51:25.294Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:51:25.294Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:51:25.294Z] >>> [apiv2][query] GET https://firestore.googleapis.com/v1/projects/eyalamrami-1d69e/databases/(default) [none]
[debug] [2025-11-21T09:51:25.945Z] <<< [apiv2][status] GET https://firestore.googleapis.com/v1/projects/eyalamrami-1d69e/databases/(default) 200
[debug] [2025-11-21T09:51:25.945Z] <<< [apiv2][body] GET https://firestore.googleapis.com/v1/projects/eyalamrami-1d69e/databases/(default) {"name":"projects/eyalamrami-1d69e/databases/(default)","uid":"28c72577-e069-422d-b53f-9211ba17d04d","createTime":"2025-11-16T21:56:31.041581Z","updateTime":"2025-11-16T21:56:31.041581Z","locationId":"europe-west2","type":"FIRESTORE_NATIVE","concurrencyMode":"PESSIMISTIC","versionRetentionPeriod":"3600s","earliestVersionTime":"2025-11-21T08:51:26.003142Z","appEngineIntegrationMode":"DISABLED","keyPrefix":"g","pointInTimeRecoveryEnablement":"POINT_IN_TIME_RECOVERY_DISABLED","deleteProtectionState":"DELETE_PROTECTION_DISABLED","databaseEdition":"STANDARD","freeTier":true,"realtimeUpdatesMode":"REALTIME_UPDATES_MODE_ENABLED","etag":"INmZjY78gpEDMMXn/oLW95AD"}
[info] i  firestore: reading indexes from firestore.indexes.json... 
[info] i  cloud.firestore: checking firestore.rules for compilation errors... 
[debug] [2025-11-21T09:51:25.948Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:51:25.948Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:51:25.949Z] >>> [apiv2][query] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test [none]
[debug] [2025-11-21T09:51:25.949Z] >>> [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test [omitted]
[debug] [2025-11-21T09:51:26.752Z] <<< [apiv2][status] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test 200
[debug] [2025-11-21T09:51:26.753Z] <<< [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test {}
[info] ✔  cloud.firestore: rules file firestore.rules compiled successfully 
[debug] [2025-11-21T09:51:26.755Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:51:26.755Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:51:26.756Z] >>> [apiv2][query] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases pageSize=10&pageToken=
[debug] [2025-11-21T09:51:27.074Z] <<< [apiv2][status] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases 200
[debug] [2025-11-21T09:51:27.074Z] <<< [apiv2][body] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases {"releases":[{"name":"projects/eyalamrami-1d69e/releases/cloud.firestore","rulesetName":"projects/eyalamrami-1d69e/rulesets/96285181-c10e-4127-b9dc-b2ffc51f138c","createTime":"2025-11-16T21:56:37.010939Z","updateTime":"2025-11-21T09:48:04.842045Z"},{"name":"projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app","rulesetName":"projects/eyalamrami-1d69e/rulesets/7f0280e0-2522-44c4-9384-b8e22fdc6036","createTime":"2025-11-16T21:57:38.715272Z","updateTime":"2025-11-21T09:17:19.291220Z"}]}
[debug] [2025-11-21T09:51:27.085Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:51:27.085Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:51:27.086Z] >>> [apiv2][query] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets/96285181-c10e-4127-b9dc-b2ffc51f138c [none]
[debug] [2025-11-21T09:51:27.787Z] <<< [apiv2][status] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets/96285181-c10e-4127-b9dc-b2ffc51f138c 200
[debug] [2025-11-21T09:51:27.787Z] <<< [apiv2][body] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets/96285181-c10e-4127-b9dc-b2ffc51f138c [omitted]
[info] i  firestore: uploading rules firestore.rules... 
[debug] [2025-11-21T09:51:27.789Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:51:27.789Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:51:27.790Z] >>> [apiv2][query] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets [none]
[debug] [2025-11-21T09:51:27.790Z] >>> [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets [omitted]
[debug] [2025-11-21T09:51:28.708Z] <<< [apiv2][status] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets 200
[debug] [2025-11-21T09:51:28.708Z] <<< [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets {"name":"projects/eyalamrami-1d69e/rulesets/6648e03f-ad07-47cc-bc11-8afec325ce30","source":{"files":[{"content":"rules_version = '2';\nservice cloud.firestore {\n  match /databases/{database}/documents {\n    \n    // ========== HELPER FUNCTIONS ==========\n    \n    function isSignedIn() {\n      return request.auth != null;\n    }\n    \n    function isAdmin() {\n      return isSignedIn() &&\n             get(/databases/$(database)/documents/users/$(request.auth.uid)).data.role == 'admin';\n    }\n    \n    // ========== USERS COLLECTION ==========\n    match /users/{uid} {\n      // Users can read/write their own document\n      allow read: if request.auth != null && request.auth.uid == uid;\n      allow write: if request.auth != null && request.auth.uid == uid;\n      \n      // Admins can write role field\n      allow update: if isAdmin() && \n                    request.resource.data.diff(resource.data).affectedKeys().hasOnly(['role']);\n    }\n    \n    // ========== DAILY INSIGHTS COLLECTION ==========\n    match /dailyInsights/{dateId} {\n      // Everyone can read published insights\n      allow read: if true;\n      \n      // Only admins can write\n      allow write: if isAdmin();\n    }\n    \n    // ========== DAILY STORIES COLLECTION ==========\n    match /dailyStories/{dateId}/clips/{clipId} {\n      // Everyone can read stories\n      allow read: if true;\n      \n      // Only admins can write\n      allow write: if isAdmin();\n    }\n    \n    // ========== NOTIFICATIONS COLLECTION ==========\n    match /notifications/{notificationId} {\n      // Only admins can read/write\n      allow read, write: if isAdmin();\n    }\n    \n    // ========== FEEDS COLLECTION ==========\n    match /feeds/{feedId} {\n      // Everyone can read published feeds, admins can read all\n      allow read: if resource.data.published == true || isAdmin();\n      \n      // Only admins can write\n      allow write: if isAdmin();\n    }\n    \n    // ========== FAITH LESSONS COLLECTION ==========\n    match /faithLessons/{lessonId} {\n      // Public read for published lessons\n      allow read: if resource.data.published == true || isAdmin();\n      \n      // Only admins can write\n      allow write: if isAdmin();\n    }\n    \n    // ========== LESSONS COLLECTION ==========\n    match /lessons/{lessonId} {\n      // Public read for all (lessons should be accessible to everyone)\n      allow read: if true;\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== PODCASTS COLLECTION ==========\n    match /podcasts/{podcastId} {\n      // All signed-in users can read active podcasts\n      allow read: if isSignedIn() && (resource.data.isActive == true || isAdmin());\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== DAILY VIDEOS COLLECTION ==========\n    match /dailyVideos/{videoId} {\n      // All signed-in users can read videos\n      allow read: if isSignedIn();\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== NEWS COLLECTION ==========\n    match /news/{newsId} {\n      // Published news can be read by everyone (public)\n      allow read: if resource.data.isPublished == true;\n      // Admins can read all (including drafts)\n      allow read: if isAdmin();\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== ALERTS COLLECTION ==========\n    match /alerts/{alertId} {\n      // All signed-in users can read alerts\n      allow read: if isSignedIn();\n      // Only admins can create, update, delete\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== HOME CARDS COLLECTION ==========\n    match /homeCards/{cardId} {\n      // Public read for all\n      allow read: if true;\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== APP CONFIG COLLECTION ==========\n    match /appConfig/{configId} {\n      // Public read\n      allow read: if true;\n      // Only admins can modify\n      allow write: if isAdmin();\n    }\n\n    // ========== INSTITUTIONS COLLECTION ==========\n    match /institutions/{institutionId} {\n      // Public read for all\n      allow read: if true;\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== INSTITUTIONS CONTENT COLLECTION ==========\n    match /institutionsContent/{activityId} {\n      // All signed-in users can read institution content\n      allow read: if isSignedIn();\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== BOOKS COLLECTION ==========\n    match /books/{bookId} {\n      // All signed-in users can read books\n      allow read: if isSignedIn();\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== FLYERS COLLECTION ==========\n    match /flyers/{flyerId} {\n      // All signed-in users can read flyers\n      allow read: if isSignedIn();\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== COMMUNITY POSTS COLLECTION ==========\n    match /communityPosts/{postId} {\n      // All signed-in users can read community posts\n      allow read: if isSignedIn();\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== LEADS COLLECTION ==========\n    match /leads/{leadId} {\n      // Anyone can create a lead (for contact forms)\n      allow create: if true;\n      // Only admins can read leads\n      allow read, update, delete: if isAdmin();\n    }\n\n    // ========== FAITH STORIES COLLECTION ==========\n    match /faith_stories/{storyId} {\n      // Admins can read all stories\n      allow read: if isAdmin();\n      // Signed-in users can read active stories\n      allow read: if isSignedIn() && resource.data.isActive == true;\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== DEFAULT DENY ==========\n    match /{document=**} {\n      allow read, write: if false;\n    }\n  }\n}\n","name":"firestore.rules"}]},"createTime":"2025-11-21T09:51:28.705951Z","metadata":{"services":["cloud.firestore"]}}
[debug] [2025-11-21T09:51:28.708Z] [rules] created ruleset projects/eyalamrami-1d69e/rulesets/6648e03f-ad07-47cc-bc11-8afec325ce30
[debug] [2025-11-21T09:51:28.709Z] [rules] releasing cloud.firestore/(default) with ruleset projects/eyalamrami-1d69e/rulesets/6648e03f-ad07-47cc-bc11-8afec325ce30
[debug] [2025-11-21T09:51:28.709Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:51:28.709Z] Checked if tokens are valid: true, expires at: 1763719600914
[debug] [2025-11-21T09:51:28.709Z] >>> [apiv2][query] PATCH https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases/cloud.firestore/(default) [none]
[debug] [2025-11-21T09:51:28.709Z] >>> [apiv2][body] PATCH https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases/cloud.firestore/(default) {"release":{"name":"projects/eyalamrami-1d69e/releases/cloud.firestore/(default)","rulesetName":"projects/eyalamrami-1d69e/rulesets/6648e03f-ad07-47cc-bc11-8afec325ce30"}}
[debug] [2025-11-21T09:51:29.629Z] <<< [apiv2][status] PATCH https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases/cloud.firestore/(default) 200
[debug] [2025-11-21T09:51:29.629Z] <<< [apiv2][body] PATCH https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases/cloud.firestore/(default) {"name":"projects/eyalamrami-1d69e/releases/cloud.firestore","rulesetName":"projects/eyalamrami-1d69e/rulesets/6648e03f-ad07-47cc-bc11-8afec325ce30","createTime":"2025-11-16T21:56:37.010939Z","updateTime":"2025-11-21T09:51:29.669129Z"}
[debug] [2025-11-21T09:51:29.629Z] [rules] updated release projects/eyalamrami-1d69e/releases/cloud.firestore
[info] ✔  firestore: released rules firestore.rules to cloud.firestore 
[info] 
[info] ✔  Deploy complete! 
[info] 
[info] Project Console: https://console.firebase.google.com/project/eyalamrami-1d69e/overview
[debug] [2025-11-21T09:53:07.888Z] ----------------------------------------------------------------------
[debug] [2025-11-21T09:53:07.891Z] Command:       /opt/homebrew/Cellar/node/24.4.1/bin/node /opt/homebrew/bin/firebase deploy --only firestore:rules
[debug] [2025-11-21T09:53:07.891Z] CLI Version:   14.25.1
[debug] [2025-11-21T09:53:07.891Z] Platform:      darwin
[debug] [2025-11-21T09:53:07.891Z] Node Version:  v24.4.1
[debug] [2025-11-21T09:53:07.891Z] Time:          Fri Nov 21 2025 11:53:07 GMT+0200 (Israel Standard Time)
[debug] [2025-11-21T09:53:07.891Z] ----------------------------------------------------------------------
[debug] 
[debug] [2025-11-21T09:53:07.977Z] > command requires scopes: ["email","openid","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","https://www.googleapis.com/auth/cloud-platform"]
[debug] [2025-11-21T09:53:07.978Z] > authorizing via signed-in user (orel895@gmail.com)
[debug] [2025-11-21T09:53:07.978Z] [iam] checking project eyalamrami-1d69e for permissions ["datastore.indexes.create","datastore.indexes.delete","datastore.indexes.list","datastore.indexes.update","firebase.projects.get"]
[debug] [2025-11-21T09:53:07.978Z] Checked if tokens are valid: false, expires at: 1763719600914
[debug] [2025-11-21T09:53:07.978Z] Checked if tokens are valid: false, expires at: 1763719600914
[debug] [2025-11-21T09:53:07.978Z] > refreshing access token with scopes: []
[debug] [2025-11-21T09:53:07.980Z] >>> [apiv2][query] POST https://www.googleapis.com/oauth2/v3/token [none]
[debug] [2025-11-21T09:53:07.980Z] >>> [apiv2][body] POST https://www.googleapis.com/oauth2/v3/token [omitted]
[debug] [2025-11-21T09:53:08.189Z] <<< [apiv2][status] POST https://www.googleapis.com/oauth2/v3/token 200
[debug] [2025-11-21T09:53:08.190Z] <<< [apiv2][body] POST https://www.googleapis.com/oauth2/v3/token [omitted]
[debug] [2025-11-21T09:53:08.203Z] >>> [apiv2][query] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions [none]
[debug] [2025-11-21T09:53:08.203Z] >>> [apiv2][(partial)header] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions x-goog-quota-user=projects/eyalamrami-1d69e
[debug] [2025-11-21T09:53:08.203Z] >>> [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions {"permissions":["datastore.indexes.create","datastore.indexes.delete","datastore.indexes.list","datastore.indexes.update","firebase.projects.get"]}
[debug] [2025-11-21T09:53:09.155Z] <<< [apiv2][status] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions 200
[debug] [2025-11-21T09:53:09.155Z] <<< [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions {"permissions":["datastore.indexes.create","datastore.indexes.delete","datastore.indexes.list","datastore.indexes.update","firebase.projects.get"]}
[info] 
[info] === Deploying to 'eyalamrami-1d69e'...
[info] 
[info] i  deploying firestore 
[info] i  firestore: ensuring required API firestore.googleapis.com is enabled... 
[info] i  firestore: ensuring required API firestore.googleapis.com is enabled... 
[debug] [2025-11-21T09:53:09.157Z] Checked if tokens are valid: true, expires at: 1763722387190
[debug] [2025-11-21T09:53:09.157Z] Checked if tokens are valid: true, expires at: 1763722387190
[debug] [2025-11-21T09:53:09.157Z] >>> [apiv2][query] GET https://firestore.googleapis.com/v1/projects/eyalamrami-1d69e/databases/(default) [none]
[debug] [2025-11-21T09:53:09.701Z] <<< [apiv2][status] GET https://firestore.googleapis.com/v1/projects/eyalamrami-1d69e/databases/(default) 200
[debug] [2025-11-21T09:53:09.701Z] <<< [apiv2][body] GET https://firestore.googleapis.com/v1/projects/eyalamrami-1d69e/databases/(default) {"name":"projects/eyalamrami-1d69e/databases/(default)","uid":"28c72577-e069-422d-b53f-9211ba17d04d","createTime":"2025-11-16T21:56:31.041581Z","updateTime":"2025-11-16T21:56:31.041581Z","locationId":"europe-west2","type":"FIRESTORE_NATIVE","concurrencyMode":"PESSIMISTIC","versionRetentionPeriod":"3600s","earliestVersionTime":"2025-11-21T08:53:09.837873Z","appEngineIntegrationMode":"DISABLED","keyPrefix":"g","pointInTimeRecoveryEnablement":"POINT_IN_TIME_RECOVERY_DISABLED","deleteProtectionState":"DELETE_PROTECTION_DISABLED","databaseEdition":"STANDARD","freeTier":true,"realtimeUpdatesMode":"REALTIME_UPDATES_MODE_ENABLED","etag":"INHizr/8gpEDMMXn/oLW95AD"}
[info] i  firestore: reading indexes from firestore.indexes.json... 
[info] i  cloud.firestore: checking firestore.rules for compilation errors... 
[debug] [2025-11-21T09:53:09.706Z] Checked if tokens are valid: true, expires at: 1763722387190
[debug] [2025-11-21T09:53:09.706Z] Checked if tokens are valid: true, expires at: 1763722387190
[debug] [2025-11-21T09:53:09.707Z] >>> [apiv2][query] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test [none]
[debug] [2025-11-21T09:53:09.707Z] >>> [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test [omitted]
[debug] [2025-11-21T09:53:10.501Z] <<< [apiv2][status] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test 200
[debug] [2025-11-21T09:53:10.502Z] <<< [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test {}
[info] ✔  cloud.firestore: rules file firestore.rules compiled successfully 
[debug] [2025-11-21T09:53:10.503Z] Checked if tokens are valid: true, expires at: 1763722387190
[debug] [2025-11-21T09:53:10.503Z] Checked if tokens are valid: true, expires at: 1763722387190
[debug] [2025-11-21T09:53:10.504Z] >>> [apiv2][query] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases pageSize=10&pageToken=
[debug] [2025-11-21T09:53:11.184Z] <<< [apiv2][status] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases 200
[debug] [2025-11-21T09:53:11.184Z] <<< [apiv2][body] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases {"releases":[{"name":"projects/eyalamrami-1d69e/releases/cloud.firestore","rulesetName":"projects/eyalamrami-1d69e/rulesets/6648e03f-ad07-47cc-bc11-8afec325ce30","createTime":"2025-11-16T21:56:37.010939Z","updateTime":"2025-11-21T09:51:29.669129Z"},{"name":"projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app","rulesetName":"projects/eyalamrami-1d69e/rulesets/7f0280e0-2522-44c4-9384-b8e22fdc6036","createTime":"2025-11-16T21:57:38.715272Z","updateTime":"2025-11-21T09:17:19.291220Z"}]}
[debug] [2025-11-21T09:53:11.198Z] Checked if tokens are valid: true, expires at: 1763722387190
[debug] [2025-11-21T09:53:11.198Z] Checked if tokens are valid: true, expires at: 1763722387190
[debug] [2025-11-21T09:53:11.198Z] >>> [apiv2][query] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets/6648e03f-ad07-47cc-bc11-8afec325ce30 [none]
[debug] [2025-11-21T09:53:11.505Z] <<< [apiv2][status] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets/6648e03f-ad07-47cc-bc11-8afec325ce30 200
[debug] [2025-11-21T09:53:11.506Z] <<< [apiv2][body] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets/6648e03f-ad07-47cc-bc11-8afec325ce30 [omitted]
[info] i  firestore: uploading rules firestore.rules... 
[debug] [2025-11-21T09:53:11.507Z] Checked if tokens are valid: true, expires at: 1763722387190
[debug] [2025-11-21T09:53:11.507Z] Checked if tokens are valid: true, expires at: 1763722387190
[debug] [2025-11-21T09:53:11.508Z] >>> [apiv2][query] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets [none]
[debug] [2025-11-21T09:53:11.508Z] >>> [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets [omitted]
[debug] [2025-11-21T09:53:12.031Z] <<< [apiv2][status] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets 200
[debug] [2025-11-21T09:53:12.031Z] <<< [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets {"name":"projects/eyalamrami-1d69e/rulesets/69cd5007-0d7f-4614-8298-146bdab6a889","source":{"files":[{"content":"rules_version = '2';\nservice cloud.firestore {\n  match /databases/{database}/documents {\n    \n    // ========== HELPER FUNCTIONS ==========\n    \n    function isSignedIn() {\n      return request.auth != null;\n    }\n    \n    function isAdmin() {\n      return isSignedIn() &&\n             get(/databases/$(database)/documents/users/$(request.auth.uid)).data.role == 'admin';\n    }\n    \n    // ========== USERS COLLECTION ==========\n    match /users/{uid} {\n      // Users can read/write their own document\n      allow read: if request.auth != null && request.auth.uid == uid;\n      allow write: if request.auth != null && request.auth.uid == uid;\n      \n      // Admins can write role field\n      allow update: if isAdmin() && \n                    request.resource.data.diff(resource.data).affectedKeys().hasOnly(['role']);\n    }\n    \n    // ========== DAILY INSIGHTS COLLECTION ==========\n    match /dailyInsights/{dateId} {\n      // Everyone can read published insights\n      allow read: if true;\n      \n      // Only admins can write\n      allow write: if isAdmin();\n    }\n    \n    // ========== DAILY STORIES COLLECTION ==========\n    match /dailyStories/{dateId}/clips/{clipId} {\n      // Everyone can read stories\n      allow read: if true;\n      \n      // Only admins can write\n      allow write: if isAdmin();\n    }\n    \n    // ========== NOTIFICATIONS COLLECTION ==========\n    match /notifications/{notificationId} {\n      // Only admins can read/write\n      allow read, write: if isAdmin();\n    }\n    \n    // ========== FEEDS COLLECTION ==========\n    match /feeds/{feedId} {\n      // Everyone can read published feeds, admins can read all\n      allow read: if resource.data.published == true || isAdmin();\n      \n      // Only admins can write\n      allow write: if isAdmin();\n    }\n    \n    // ========== FAITH LESSONS COLLECTION ==========\n    match /faithLessons/{lessonId} {\n      // Public read for published lessons\n      allow read: if resource.data.published == true || isAdmin();\n      \n      // Only admins can write\n      allow write: if isAdmin();\n    }\n    \n    // ========== LESSONS COLLECTION ==========\n    match /lessons/{lessonId} {\n      // Public read for all (lessons should be accessible to everyone)\n      allow read: if true;\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== PODCASTS COLLECTION ==========\n    match /podcasts/{podcastId} {\n      // All signed-in users can read active podcasts\n      allow read: if isSignedIn() && (resource.data.isActive == true || isAdmin());\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== DAILY VIDEOS COLLECTION ==========\n    match /dailyVideos/{videoId} {\n      // All signed-in users can read videos\n      allow read: if isSignedIn();\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== NEWS COLLECTION ==========\n    match /news/{newsId} {\n      // Published news can be read by everyone (public)\n      allow read: if resource.data.isPublished == true;\n      // Admins can read all (including drafts)\n      allow read: if isAdmin();\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== ALERTS COLLECTION ==========\n    match /alerts/{alertId} {\n      // All signed-in users can read alerts\n      allow read: if isSignedIn();\n      // Only admins can create, update, delete\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== HOME CARDS COLLECTION ==========\n    match /homeCards/{cardId} {\n      // Public read for all\n      allow read: if true;\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== APP CONFIG COLLECTION ==========\n    match /appConfig/{configId} {\n      // Public read\n      allow read: if true;\n      // Only admins can modify\n      allow write: if isAdmin();\n    }\n\n    // ========== INSTITUTIONS COLLECTION ==========\n    match /institutions/{institutionId} {\n      // Public read for all\n      allow read: if true;\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== INSTITUTIONS CONTENT COLLECTION ==========\n    match /institutionsContent/{activityId} {\n      // All signed-in users can read institution content\n      allow read: if isSignedIn();\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== BOOKS COLLECTION ==========\n    match /books/{bookId} {\n      // All signed-in users can read books\n      allow read: if isSignedIn();\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== FLYERS COLLECTION ==========\n    match /flyers/{flyerId} {\n      // All signed-in users can read flyers\n      allow read: if isSignedIn();\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== COMMUNITY POSTS COLLECTION ==========\n    match /communityPosts/{postId} {\n      // Everyone can read active community posts (public)\n      allow read: if resource.data.isActive == true;\n      // Admins can read all (including inactive)\n      allow read: if isAdmin();\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== LEADS COLLECTION ==========\n    match /leads/{leadId} {\n      // Anyone can create a lead (for contact forms)\n      allow create: if true;\n      // Only admins can read leads\n      allow read, update, delete: if isAdmin();\n    }\n\n    // ========== FAITH STORIES COLLECTION ==========\n    match /faith_stories/{storyId} {\n      // Admins can read all stories\n      allow read: if isAdmin();\n      // Signed-in users can read active stories\n      allow read: if isSignedIn() && resource.data.isActive == true;\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== DEFAULT DENY ==========\n    match /{document=**} {\n      allow read, write: if false;\n    }\n  }\n}\n","name":"firestore.rules"}]},"createTime":"2025-11-21T09:53:12.019807Z","metadata":{"services":["cloud.firestore"]}}
[debug] [2025-11-21T09:53:12.031Z] [rules] created ruleset projects/eyalamrami-1d69e/rulesets/69cd5007-0d7f-4614-8298-146bdab6a889
[debug] [2025-11-21T09:53:12.032Z] [rules] releasing cloud.firestore/(default) with ruleset projects/eyalamrami-1d69e/rulesets/69cd5007-0d7f-4614-8298-146bdab6a889
[debug] [2025-11-21T09:53:12.032Z] Checked if tokens are valid: true, expires at: 1763722387190
[debug] [2025-11-21T09:53:12.032Z] Checked if tokens are valid: true, expires at: 1763722387190
[debug] [2025-11-21T09:53:12.032Z] >>> [apiv2][query] PATCH https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases/cloud.firestore/(default) [none]
[debug] [2025-11-21T09:53:12.032Z] >>> [apiv2][body] PATCH https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases/cloud.firestore/(default) {"release":{"name":"projects/eyalamrami-1d69e/releases/cloud.firestore/(default)","rulesetName":"projects/eyalamrami-1d69e/rulesets/69cd5007-0d7f-4614-8298-146bdab6a889"}}
[debug] [2025-11-21T09:53:12.885Z] <<< [apiv2][status] PATCH https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases/cloud.firestore/(default) 200
[debug] [2025-11-21T09:53:12.885Z] <<< [apiv2][body] PATCH https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases/cloud.firestore/(default) {"name":"projects/eyalamrami-1d69e/releases/cloud.firestore","rulesetName":"projects/eyalamrami-1d69e/rulesets/69cd5007-0d7f-4614-8298-146bdab6a889","createTime":"2025-11-16T21:56:37.010939Z","updateTime":"2025-11-21T09:53:12.951888Z"}
[debug] [2025-11-21T09:53:12.885Z] [rules] updated release projects/eyalamrami-1d69e/releases/cloud.firestore
[info] ✔  firestore: released rules firestore.rules to cloud.firestore 
[info] 
[info] ✔  Deploy complete! 
[info] 
[info] Project Console: https://console.firebase.google.com/project/eyalamrami-1d69e/overview
[debug] [2025-11-21T10:05:26.497Z] ----------------------------------------------------------------------
[debug] [2025-11-21T10:05:26.500Z] Command:       /opt/homebrew/Cellar/node/24.4.1/bin/node /opt/homebrew/bin/firebase deploy --only storage:rules
[debug] [2025-11-21T10:05:26.500Z] CLI Version:   14.25.1
[debug] [2025-11-21T10:05:26.500Z] Platform:      darwin
[debug] [2025-11-21T10:05:26.500Z] Node Version:  v24.4.1
[debug] [2025-11-21T10:05:26.500Z] Time:          Fri Nov 21 2025 12:05:26 GMT+0200 (Israel Standard Time)
[debug] [2025-11-21T10:05:26.500Z] ----------------------------------------------------------------------
[debug] 
[debug] [2025-11-21T10:05:26.587Z] > command requires scopes: ["email","openid","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","https://www.googleapis.com/auth/cloud-platform"]
[debug] [2025-11-21T10:05:26.588Z] > authorizing via signed-in user (orel895@gmail.com)
[debug] [2025-11-21T10:05:26.588Z] [iam] checking project eyalamrami-1d69e for permissions ["firebase.projects.get","firebaserules.releases.create","firebaserules.releases.update","firebaserules.rulesets.create"]
[debug] [2025-11-21T10:05:26.589Z] Checked if tokens are valid: true, expires at: 1763722387190
[debug] [2025-11-21T10:05:26.589Z] Checked if tokens are valid: true, expires at: 1763722387190
[debug] [2025-11-21T10:05:26.589Z] >>> [apiv2][query] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions [none]
[debug] [2025-11-21T10:05:26.589Z] >>> [apiv2][(partial)header] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions x-goog-quota-user=projects/eyalamrami-1d69e
[debug] [2025-11-21T10:05:26.589Z] >>> [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions {"permissions":["firebase.projects.get","firebaserules.releases.create","firebaserules.releases.update","firebaserules.rulesets.create"]}
[debug] [2025-11-21T10:05:27.565Z] <<< [apiv2][status] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions 200
[debug] [2025-11-21T10:05:27.565Z] <<< [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions {"permissions":["firebase.projects.get","firebaserules.releases.create","firebaserules.releases.update","firebaserules.rulesets.create"]}
[info] 
[info] === Deploying to 'eyalamrami-1d69e'...
[info] 
[info] i  deploying storage 
[info] i  storage: ensuring required API firebasestorage.googleapis.com is enabled... 
[debug] [2025-11-21T10:05:27.569Z] Checked if tokens are valid: true, expires at: 1763722387190
[debug] [2025-11-21T10:05:27.569Z] Checked if tokens are valid: true, expires at: 1763722387190
[debug] [2025-11-21T10:05:27.569Z] >>> [apiv2][query] GET https://firebasestorage.googleapis.com/v1alpha/projects/eyalamrami-1d69e/defaultBucket [none]
[debug] [2025-11-21T10:05:28.154Z] <<< [apiv2][status] GET https://firebasestorage.googleapis.com/v1alpha/projects/eyalamrami-1d69e/defaultBucket 200
[debug] [2025-11-21T10:05:28.155Z] <<< [apiv2][body] GET https://firebasestorage.googleapis.com/v1alpha/projects/eyalamrami-1d69e/defaultBucket {"name":"projects/eyalamrami-1d69e/defaultBucket","location":"EUROPE-WEST2","bucket":{"name":"projects/eyalamrami-1d69e/buckets/eyalamrami-1d69e.firebasestorage.app"},"storageClass":"REGIONAL"}
[error] 
[error] Error: Could not find rules for the following storage targets: rules
[debug] [2025-11-21T10:05:45.124Z] ----------------------------------------------------------------------
[debug] [2025-11-21T10:05:45.127Z] Command:       /opt/homebrew/Cellar/node/24.4.1/bin/node /opt/homebrew/bin/firebase deploy --only storage
[debug] [2025-11-21T10:05:45.127Z] CLI Version:   14.25.1
[debug] [2025-11-21T10:05:45.127Z] Platform:      darwin
[debug] [2025-11-21T10:05:45.127Z] Node Version:  v24.4.1
[debug] [2025-11-21T10:05:45.127Z] Time:          Fri Nov 21 2025 12:05:45 GMT+0200 (Israel Standard Time)
[debug] [2025-11-21T10:05:45.127Z] ----------------------------------------------------------------------
[debug] 
[debug] [2025-11-21T10:05:45.221Z] > command requires scopes: ["email","openid","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","https://www.googleapis.com/auth/cloud-platform"]
[debug] [2025-11-21T10:05:45.221Z] > authorizing via signed-in user (orel895@gmail.com)
[debug] [2025-11-21T10:05:45.222Z] [iam] checking project eyalamrami-1d69e for permissions ["firebase.projects.get","firebaserules.releases.create","firebaserules.releases.update","firebaserules.rulesets.create"]
[debug] [2025-11-21T10:05:45.222Z] Checked if tokens are valid: true, expires at: 1763722387190
[debug] [2025-11-21T10:05:45.222Z] Checked if tokens are valid: true, expires at: 1763722387190
[debug] [2025-11-21T10:05:45.223Z] >>> [apiv2][query] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions [none]
[debug] [2025-11-21T10:05:45.223Z] >>> [apiv2][(partial)header] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions x-goog-quota-user=projects/eyalamrami-1d69e
[debug] [2025-11-21T10:05:45.223Z] >>> [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions {"permissions":["firebase.projects.get","firebaserules.releases.create","firebaserules.releases.update","firebaserules.rulesets.create"]}
[debug] [2025-11-21T10:05:46.205Z] <<< [apiv2][status] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions 200
[debug] [2025-11-21T10:05:46.205Z] <<< [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions {"permissions":["firebase.projects.get","firebaserules.releases.create","firebaserules.releases.update","firebaserules.rulesets.create"]}
[info] 
[info] === Deploying to 'eyalamrami-1d69e'...
[info] 
[info] i  deploying storage 
[info] i  storage: ensuring required API firebasestorage.googleapis.com is enabled... 
[debug] [2025-11-21T10:05:46.207Z] Checked if tokens are valid: true, expires at: 1763722387190
[debug] [2025-11-21T10:05:46.207Z] Checked if tokens are valid: true, expires at: 1763722387190
[debug] [2025-11-21T10:05:46.208Z] >>> [apiv2][query] GET https://firebasestorage.googleapis.com/v1alpha/projects/eyalamrami-1d69e/defaultBucket [none]
[debug] [2025-11-21T10:05:46.868Z] <<< [apiv2][status] GET https://firebasestorage.googleapis.com/v1alpha/projects/eyalamrami-1d69e/defaultBucket 200
[debug] [2025-11-21T10:05:46.869Z] <<< [apiv2][body] GET https://firebasestorage.googleapis.com/v1alpha/projects/eyalamrami-1d69e/defaultBucket {"name":"projects/eyalamrami-1d69e/defaultBucket","location":"EUROPE-WEST2","bucket":{"name":"projects/eyalamrami-1d69e/buckets/eyalamrami-1d69e.firebasestorage.app"},"storageClass":"REGIONAL"}
[info] i  firebase.storage: checking storage.rules for compilation errors... 
[debug] [2025-11-21T10:05:46.872Z] Checked if tokens are valid: true, expires at: 1763722387190
[debug] [2025-11-21T10:05:46.872Z] Checked if tokens are valid: true, expires at: 1763722387190
[debug] [2025-11-21T10:05:46.872Z] >>> [apiv2][query] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test [none]
[debug] [2025-11-21T10:05:46.872Z] >>> [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test [omitted]
[debug] [2025-11-21T10:05:47.789Z] <<< [apiv2][status] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test 200
[debug] [2025-11-21T10:05:47.789Z] <<< [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test {"issues":[{"sourcePosition":{"fileName":"storage.rules","line":6,"column":14,"currentOffset":142,"endOffset":148},"description":"Unused function: isAdmin.","severity":"WARNING"},{"sourcePosition":{"fileName":"storage.rules","line":7,"column":14,"currentOffset":167,"endOffset":173},"description":"Invalid variable name: request.","severity":"WARNING"},{"sourcePosition":{"fileName":"storage.rules","line":8,"column":24,"currentOffset":215,"endOffset":217},"description":"Invalid function name: firestore.get.","severity":"WARNING"},{"sourcePosition":{"fileName":"storage.rules","line":8,"column":67,"currentOffset":258,"endOffset":264},"description":"Invalid variable name: request.","severity":"WARNING"},{"sourcePosition":{"fileName":"storage.rules","line":12,"column":14,"currentOffset":390,"endOffset":401},"description":"Unused function: isAdminClaim.","severity":"WARNING"},{"sourcePosition":{"fileName":"storage.rules","line":13,"column":14,"currentOffset":420,"endOffset":426},"description":"Invalid variable name: request.","severity":"WARNING"},{"sourcePosition":{"fileName":"storage.rules","line":13,"column":38,"currentOffset":444,"endOffset":450},"description":"Invalid variable name: request.","severity":"WARNING"},{"sourcePosition":{"fileName":"storage.rules","line":17,"column":14,"currentOffset":562,"endOffset":577},"description":"Unused function: isHardcodedAdmin.","severity":"WARNING"},{"sourcePosition":{"fileName":"storage.rules","line":18,"column":14,"currentOffset":596,"endOffset":602},"description":"Invalid variable name: request.","severity":"WARNING"},{"sourcePosition":{"fileName":"storage.rules","line":18,"column":38,"currentOffset":620,"endOffset":626},"description":"Invalid variable name: request.","severity":"WARNING"}]}
[warn] ⚠  [W] 6:14 - Unused function: isAdmin. 
[warn] ⚠  [W] 7:14 - Invalid variable name: request. 
[warn] ⚠  [W] 8:24 - Invalid function name: firestore.get. 
[warn] ⚠  [W] 8:67 - Invalid variable name: request. 
[warn] ⚠  [W] 12:14 - Unused function: isAdminClaim. 
[warn] ⚠  [W] 13:14 - Invalid variable name: request. 
[warn] ⚠  [W] 13:38 - Invalid variable name: request. 
[warn] ⚠  [W] 17:14 - Unused function: isHardcodedAdmin. 
[warn] ⚠  [W] 18:14 - Invalid variable name: request. 
[warn] ⚠  [W] 18:38 - Invalid variable name: request. 
[info] ✔  firebase.storage: rules file storage.rules compiled successfully 
[debug] [2025-11-21T10:05:47.791Z] Checked if tokens are valid: true, expires at: 1763722387190
[debug] [2025-11-21T10:05:47.791Z] Checked if tokens are valid: true, expires at: 1763722387190
[debug] [2025-11-21T10:05:47.791Z] >>> [apiv2][query] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases pageSize=10&pageToken=
[debug] [2025-11-21T10:05:48.457Z] <<< [apiv2][status] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases 200
[debug] [2025-11-21T10:05:48.457Z] <<< [apiv2][body] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases {"releases":[{"name":"projects/eyalamrami-1d69e/releases/cloud.firestore","rulesetName":"projects/eyalamrami-1d69e/rulesets/69cd5007-0d7f-4614-8298-146bdab6a889","createTime":"2025-11-16T21:56:37.010939Z","updateTime":"2025-11-21T09:53:12.951888Z"},{"name":"projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app","rulesetName":"projects/eyalamrami-1d69e/rulesets/7f0280e0-2522-44c4-9384-b8e22fdc6036","createTime":"2025-11-16T21:57:38.715272Z","updateTime":"2025-11-21T09:17:19.291220Z"}]}
[debug] [2025-11-21T10:05:48.482Z] Checked if tokens are valid: true, expires at: 1763722387190
[debug] [2025-11-21T10:05:48.482Z] Checked if tokens are valid: true, expires at: 1763722387190
[debug] [2025-11-21T10:05:48.482Z] >>> [apiv2][query] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets/7f0280e0-2522-44c4-9384-b8e22fdc6036 [none]
[debug] [2025-11-21T10:05:49.154Z] <<< [apiv2][status] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets/7f0280e0-2522-44c4-9384-b8e22fdc6036 200
[debug] [2025-11-21T10:05:49.154Z] <<< [apiv2][body] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets/7f0280e0-2522-44c4-9384-b8e22fdc6036 [omitted]
[info] i  storage: uploading rules storage.rules... 
[debug] [2025-11-21T10:05:49.155Z] Checked if tokens are valid: true, expires at: 1763722387190
[debug] [2025-11-21T10:05:49.155Z] Checked if tokens are valid: true, expires at: 1763722387190
[debug] [2025-11-21T10:05:49.156Z] >>> [apiv2][query] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets [none]
[debug] [2025-11-21T10:05:49.156Z] >>> [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets [omitted]
[debug] [2025-11-21T10:05:49.985Z] <<< [apiv2][status] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets 200
[debug] [2025-11-21T10:05:49.985Z] <<< [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets {"name":"projects/eyalamrami-1d69e/rulesets/c1233528-4ec5-4321-9e10-6dd88935fb68","source":{"files":[{"content":"rules_version = '2';\nservice firebase.storage {\n  match /b/{bucket}/o {\n    \n    // Helper function to check admin via Firestore\n    function isAdmin() {\n      return request.auth != null && \n             firestore.get(/databases/(default)/documents/users/$(request.auth.uid)).data.role == 'admin';\n    }\n    \n    // Helper function to check admin via custom claims (fallback)\n    function isAdminClaim() {\n      return request.auth != null && request.auth.token.admin == true;\n    }\n    \n    // Hardcoded admin UID for fallback (orel895@gmail.com)\n    function isHardcodedAdmin() {\n      return request.auth != null && request.auth.uid == 'tewQ0ZYs4bMeondJMSAS5T0XnTC3';\n    }\n    \n    // Combined admin check - try Firestore first, then custom claims, then hardcoded UID\n    // TEMPORARY FIX: Allow any authenticated user to write to unblock the admin panel\n    function isAdminUser() {\n      return request.auth != null; \n      // return isAdmin() || isAdminClaim() || isHardcodedAdmin();\n    }\n    \n    // ========== AUDIO DAILY ==========\n    match /audio/daily/{date}/{fileName} {\n      // Public read for daily audio\n      allow read: if true;\n      \n      // Only admins can write\n      allow write: if isAdminUser() &&\n                   request.resource.size < 20 * 1024 * 1024 && // Max 20MB\n                   request.resource.contentType.matches('audio/.*');\n    }\n    \n    // ========== VIDEO STORIES ==========\n    match /video/stories/{date}/{clipId} {\n      // Public read for story videos\n      allow read: if true;\n      \n      // Only admins can write (enforce .mp4 in validation)\n      allow write: if isAdminUser() &&\n                   request.resource.size < 100 * 1024 * 1024 && // Max 100MB\n                   request.resource.contentType.matches('video/.*') &&\n                   clipId.matches('.*\\\\.mp4$');\n    }\n    \n    // ========== VIDEO STORIES THUMBNAILS ==========\n    match /video/stories_thumbs/{date}/{clipId} {\n      // Public read for story thumbnails\n      allow read: if true;\n      \n      // Only admins can write (enforce .jpg in validation)\n      allow write: if isAdminUser() &&\n                   request.resource.size < 5 * 1024 * 1024 && // Max 5MB\n                   request.resource.contentType.matches('image/.*') &&\n                   clipId.matches('.*\\\\.jpg$');\n    }\n    \n    // ========== IMAGES (General) ==========\n    match /images/{allPaths=**} {\n      // Public read for images\n      allow read: if true;\n\n      // Only admins can write\n      allow write: if isAdminUser() &&\n                   request.resource.size < 10 * 1024 * 1024 && // Max 10MB\n                   request.resource.contentType.matches('image/.*');\n    }\n\n    // ========== LESSONS ==========\n    match /lessons/{lessonId}/{fileName} {\n      // Public read for lesson thumbnails\n      allow read: if true;\n\n      // Only admins can write\n      allow write: if isAdminUser() &&\n                   request.resource.size < 5 * 1024 * 1024 && // Max 5MB\n                   request.resource.contentType.matches('image/.*');\n    }\n\n    // ========== PODCASTS ==========\n    match /podcasts/{podcastId}/{fileName} {\n      // Public read for podcast audio and thumbnails\n      allow read: if true;\n\n      // Only admins can write audio files\n      allow write: if isAdminUser() &&\n                   fileName == 'audio.mp3' &&\n                   request.resource.size < 100 * 1024 * 1024 && // Max 100MB\n                   request.resource.contentType.matches('audio/.*');\n\n      // Only admins can write thumbnail images\n      allow write: if isAdminUser() &&\n                   fileName == 'thumbnail.jpg' &&\n                   request.resource.size < 5 * 1024 * 1024 && // Max 5MB\n                   request.resource.contentType.matches('image/.*');\n    }\n\n    // ========== DAILY VIDEOS ==========\n    match /dailyVideos/{videoId}/{fileName} {\n      // Public read for daily videos\n      allow read: if true;\n\n      // Only admins can write videos\n      allow write: if isAdminUser() &&\n                   fileName.matches('video.*') &&\n                   request.resource.size < 200 * 1024 * 1024 && // Max 200MB\n                   request.resource.contentType.matches('video/.*');\n\n      // Only admins can write thumbnails\n      allow write: if isAdminUser() &&\n                   fileName.matches('thumbnail.*') &&\n                   request.resource.size < 5 * 1024 * 1024 && // Max 5MB\n                   request.resource.contentType.matches('image/.*');\n    }\n\n    // ========== NEWS ==========\n    match /news/{newsId}/{fileName} {\n      // Public read for news images\n      allow read: if true;\n\n      // Only admins can write\n      allow write: if isAdminUser() &&\n                   request.resource.size < 10 * 1024 * 1024 && // Max 10MB\n                   request.resource.contentType.matches('image/.*');\n    }\n\n    // ========== BOOKS ==========\n    match /books/{bookId}/{fileName} {\n      // Public read for book covers\n      allow read: if true;\n\n      // Only admins can write\n      allow write: if isAdminUser() &&\n                   request.resource.size < 5 * 1024 * 1024 && // Max 5MB\n                   request.resource.contentType.matches('image/.*');\n    }\n\n    // ========== FLYERS ==========\n    match /flyers/{flyerId}/{fileName} {\n      // Public read for flyers\n      allow read: if true;\n\n      // Only admins can write PDFs\n      allow write: if isAdminUser() &&\n                   request.resource.size < 20 * 1024 * 1024 && // Max 20MB\n                   request.resource.contentType == 'application/pdf';\n\n      // Only admins can write images\n      allow write: if isAdminUser() &&\n                   request.resource.size < 10 * 1024 * 1024 && // Max 10MB\n                   request.resource.contentType.matches('image/.*');\n    }\n\n    // ========== COMMUNITY POSTS ==========\n    match /communityPosts/{postId}/{fileName} {\n      // Public read for community post images\n      allow read: if true;\n\n      // Only admins can write\n      allow write: if isAdminUser() &&\n                   request.resource.size < 10 * 1024 * 1024 && // Max 10MB\n                   request.resource.contentType.matches('image/.*');\n    }\n\n    // ========== INSTITUTIONS ==========\n    match /institutions/{institutionId}/{fileName} {\n      // Public read for institution images\n      allow read: if true;\n\n      // Only admins can write\n      allow write: if isAdminUser() &&\n                   request.resource.size < 10 * 1024 * 1024 && // Max 10MB\n                   request.resource.contentType.matches('image/.*');\n    }\n\n    // ========== HOME CARDS ==========\n    match /cards/{cardId}/{fileName} {\n      // Public read for card images\n      allow read: if true;\n\n      // Only admins can write\n      allow write: if isAdminUser() &&\n                   request.resource.size < 5 * 1024 * 1024 && // Max 5MB\n                   request.resource.contentType.matches('image/.*');\n    }\n\n    // ========== ALERTS ==========\n    match /alerts/{alertId}/{fileName} {\n      // Public read for alert images and audio\n      allow read: if true;\n\n      // Only admins can write images\n      allow write: if isAdminUser() &&\n                   fileName.matches('.*\\\\.(jpg|jpeg|png|gif)$') &&\n                   request.resource.size < 10 * 1024 * 1024 && // Max 10MB\n                   request.resource.contentType.matches('image/.*');\n\n      // Only admins can write audio files\n      allow write: if isAdminUser() &&\n                   fileName.matches('.*\\\\.(mp3|m4a|wav|aac)$') &&\n                   request.resource.size < 20 * 1024 * 1024 && // Max 20MB\n                   request.resource.contentType.matches('audio/.*');\n    }\n\n    // ========== DEFAULT DENY ==========\n    match /{allPaths=**} {\n      allow read, write: if false;\n    }\n  }\n}\n","name":"storage.rules"}]},"createTime":"2025-11-21T10:05:50.011503Z","metadata":{"services":["firebase.storage"]}}
[debug] [2025-11-21T10:05:49.986Z] [rules] created ruleset projects/eyalamrami-1d69e/rulesets/c1233528-4ec5-4321-9e10-6dd88935fb68
[debug] [2025-11-21T10:05:49.986Z] [rules] releasing firebase.storage/eyalamrami-1d69e.firebasestorage.app with ruleset projects/eyalamrami-1d69e/rulesets/c1233528-4ec5-4321-9e10-6dd88935fb68
[debug] [2025-11-21T10:05:49.987Z] Checked if tokens are valid: true, expires at: 1763722387190
[debug] [2025-11-21T10:05:49.987Z] Checked if tokens are valid: true, expires at: 1763722387190
[debug] [2025-11-21T10:05:49.987Z] >>> [apiv2][query] PATCH https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app [none]
[debug] [2025-11-21T10:05:49.988Z] >>> [apiv2][body] PATCH https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app {"release":{"name":"projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app","rulesetName":"projects/eyalamrami-1d69e/rulesets/c1233528-4ec5-4321-9e10-6dd88935fb68"}}
[debug] [2025-11-21T10:05:50.835Z] <<< [apiv2][status] PATCH https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app 200
[debug] [2025-11-21T10:05:50.835Z] <<< [apiv2][body] PATCH https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app {"name":"projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app","rulesetName":"projects/eyalamrami-1d69e/rulesets/c1233528-4ec5-4321-9e10-6dd88935fb68","createTime":"2025-11-16T21:57:38.715272Z","updateTime":"2025-11-21T10:05:50.867232Z"}
[debug] [2025-11-21T10:05:50.836Z] [rules] updated release projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app
[info] ✔  storage: released rules storage.rules to firebase.storage 
[info] 
[info] ✔  Deploy complete! 
[info] 
[info] Project Console: https://console.firebase.google.com/project/eyalamrami-1d69e/overview
[debug] [2025-11-21T10:08:00.592Z] ----------------------------------------------------------------------
[debug] [2025-11-21T10:08:00.594Z] Command:       /opt/homebrew/Cellar/node/24.4.1/bin/node /opt/homebrew/bin/firebase deploy --only storage
[debug] [2025-11-21T10:08:00.594Z] CLI Version:   14.25.1
[debug] [2025-11-21T10:08:00.594Z] Platform:      darwin
[debug] [2025-11-21T10:08:00.594Z] Node Version:  v24.4.1
[debug] [2025-11-21T10:08:00.594Z] Time:          Fri Nov 21 2025 12:08:00 GMT+0200 (Israel Standard Time)
[debug] [2025-11-21T10:08:00.594Z] ----------------------------------------------------------------------
[debug] 
[debug] [2025-11-21T10:08:00.696Z] > command requires scopes: ["email","openid","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","https://www.googleapis.com/auth/cloud-platform"]
[debug] [2025-11-21T10:08:00.697Z] > authorizing via signed-in user (orel895@gmail.com)
[debug] [2025-11-21T10:08:00.698Z] [iam] checking project eyalamrami-1d69e for permissions ["firebase.projects.get","firebaserules.releases.create","firebaserules.releases.update","firebaserules.rulesets.create"]
[debug] [2025-11-21T10:08:00.698Z] Checked if tokens are valid: true, expires at: 1763722387190
[debug] [2025-11-21T10:08:00.698Z] Checked if tokens are valid: true, expires at: 1763722387190
[debug] [2025-11-21T10:08:00.699Z] >>> [apiv2][query] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions [none]
[debug] [2025-11-21T10:08:00.699Z] >>> [apiv2][(partial)header] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions x-goog-quota-user=projects/eyalamrami-1d69e
[debug] [2025-11-21T10:08:00.699Z] >>> [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions {"permissions":["firebase.projects.get","firebaserules.releases.create","firebaserules.releases.update","firebaserules.rulesets.create"]}
[debug] [2025-11-21T10:08:01.681Z] <<< [apiv2][status] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions 200
[debug] [2025-11-21T10:08:01.682Z] <<< [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions {"permissions":["firebase.projects.get","firebaserules.releases.create","firebaserules.releases.update","firebaserules.rulesets.create"]}
[info] 
[info] === Deploying to 'eyalamrami-1d69e'...
[info] 
[info] i  deploying storage 
[info] i  storage: ensuring required API firebasestorage.googleapis.com is enabled... 
[debug] [2025-11-21T10:08:01.685Z] Checked if tokens are valid: true, expires at: 1763722387190
[debug] [2025-11-21T10:08:01.685Z] Checked if tokens are valid: true, expires at: 1763722387190
[debug] [2025-11-21T10:08:01.685Z] >>> [apiv2][query] GET https://firebasestorage.googleapis.com/v1alpha/projects/eyalamrami-1d69e/defaultBucket [none]
[debug] [2025-11-21T10:08:02.341Z] <<< [apiv2][status] GET https://firebasestorage.googleapis.com/v1alpha/projects/eyalamrami-1d69e/defaultBucket 200
[debug] [2025-11-21T10:08:02.341Z] <<< [apiv2][body] GET https://firebasestorage.googleapis.com/v1alpha/projects/eyalamrami-1d69e/defaultBucket {"name":"projects/eyalamrami-1d69e/defaultBucket","location":"EUROPE-WEST2","bucket":{"name":"projects/eyalamrami-1d69e/buckets/eyalamrami-1d69e.firebasestorage.app"},"storageClass":"REGIONAL"}
[info] i  firebase.storage: checking storage.rules for compilation errors... 
[debug] [2025-11-21T10:08:02.345Z] Checked if tokens are valid: true, expires at: 1763722387190
[debug] [2025-11-21T10:08:02.345Z] Checked if tokens are valid: true, expires at: 1763722387190
[debug] [2025-11-21T10:08:02.345Z] >>> [apiv2][query] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test [none]
[debug] [2025-11-21T10:08:02.345Z] >>> [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test [omitted]
[debug] [2025-11-21T10:08:03.195Z] <<< [apiv2][status] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test 200
[debug] [2025-11-21T10:08:03.195Z] <<< [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test {"issues":[{"sourcePosition":{"fileName":"storage.rules","line":6,"column":14,"currentOffset":142,"endOffset":148},"description":"Unused function: isAdmin.","severity":"WARNING"},{"sourcePosition":{"fileName":"storage.rules","line":7,"column":14,"currentOffset":167,"endOffset":173},"description":"Invalid variable name: request.","severity":"WARNING"},{"sourcePosition":{"fileName":"storage.rules","line":8,"column":24,"currentOffset":215,"endOffset":217},"description":"Invalid function name: firestore.get.","severity":"WARNING"},{"sourcePosition":{"fileName":"storage.rules","line":8,"column":67,"currentOffset":258,"endOffset":264},"description":"Invalid variable name: request.","severity":"WARNING"},{"sourcePosition":{"fileName":"storage.rules","line":12,"column":14,"currentOffset":390,"endOffset":401},"description":"Unused function: isAdminClaim.","severity":"WARNING"},{"sourcePosition":{"fileName":"storage.rules","line":13,"column":14,"currentOffset":420,"endOffset":426},"description":"Invalid variable name: request.","severity":"WARNING"},{"sourcePosition":{"fileName":"storage.rules","line":13,"column":38,"currentOffset":444,"endOffset":450},"description":"Invalid variable name: request.","severity":"WARNING"},{"sourcePosition":{"fileName":"storage.rules","line":17,"column":14,"currentOffset":562,"endOffset":577},"description":"Unused function: isHardcodedAdmin.","severity":"WARNING"},{"sourcePosition":{"fileName":"storage.rules","line":18,"column":14,"currentOffset":596,"endOffset":602},"description":"Invalid variable name: request.","severity":"WARNING"},{"sourcePosition":{"fileName":"storage.rules","line":18,"column":38,"currentOffset":620,"endOffset":626},"description":"Invalid variable name: request.","severity":"WARNING"}]}
[warn] ⚠  [W] 6:14 - Unused function: isAdmin. 
[warn] ⚠  [W] 7:14 - Invalid variable name: request. 
[warn] ⚠  [W] 8:24 - Invalid function name: firestore.get. 
[warn] ⚠  [W] 8:67 - Invalid variable name: request. 
[warn] ⚠  [W] 12:14 - Unused function: isAdminClaim. 
[warn] ⚠  [W] 13:14 - Invalid variable name: request. 
[warn] ⚠  [W] 13:38 - Invalid variable name: request. 
[warn] ⚠  [W] 17:14 - Unused function: isHardcodedAdmin. 
[warn] ⚠  [W] 18:14 - Invalid variable name: request. 
[warn] ⚠  [W] 18:38 - Invalid variable name: request. 
[info] ✔  firebase.storage: rules file storage.rules compiled successfully 
[debug] [2025-11-21T10:08:03.197Z] Checked if tokens are valid: true, expires at: 1763722387190
[debug] [2025-11-21T10:08:03.198Z] Checked if tokens are valid: true, expires at: 1763722387190
[debug] [2025-11-21T10:08:03.198Z] >>> [apiv2][query] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases pageSize=10&pageToken=
[debug] [2025-11-21T10:08:03.871Z] <<< [apiv2][status] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases 200
[debug] [2025-11-21T10:08:03.871Z] <<< [apiv2][body] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases {"releases":[{"name":"projects/eyalamrami-1d69e/releases/cloud.firestore","rulesetName":"projects/eyalamrami-1d69e/rulesets/69cd5007-0d7f-4614-8298-146bdab6a889","createTime":"2025-11-16T21:56:37.010939Z","updateTime":"2025-11-21T09:53:12.951888Z"},{"name":"projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app","rulesetName":"projects/eyalamrami-1d69e/rulesets/c1233528-4ec5-4321-9e10-6dd88935fb68","createTime":"2025-11-16T21:57:38.715272Z","updateTime":"2025-11-21T10:05:50.867232Z"}]}
[debug] [2025-11-21T10:08:03.883Z] Checked if tokens are valid: true, expires at: 1763722387190
[debug] [2025-11-21T10:08:03.883Z] Checked if tokens are valid: true, expires at: 1763722387190
[debug] [2025-11-21T10:08:03.883Z] >>> [apiv2][query] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets/c1233528-4ec5-4321-9e10-6dd88935fb68 [none]
[debug] [2025-11-21T10:08:04.558Z] <<< [apiv2][status] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets/c1233528-4ec5-4321-9e10-6dd88935fb68 200
[debug] [2025-11-21T10:08:04.558Z] <<< [apiv2][body] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets/c1233528-4ec5-4321-9e10-6dd88935fb68 [omitted]
[info] i  storage: latest version of storage.rules already up to date, skipping upload... 
[debug] [2025-11-21T10:08:04.559Z] [rules] releasing firebase.storage/eyalamrami-1d69e.firebasestorage.app with ruleset projects/eyalamrami-1d69e/rulesets/c1233528-4ec5-4321-9e10-6dd88935fb68
[debug] [2025-11-21T10:08:04.559Z] Checked if tokens are valid: true, expires at: 1763722387190
[debug] [2025-11-21T10:08:04.559Z] Checked if tokens are valid: true, expires at: 1763722387190
[debug] [2025-11-21T10:08:04.559Z] >>> [apiv2][query] PATCH https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app [none]
[debug] [2025-11-21T10:08:04.559Z] >>> [apiv2][body] PATCH https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app {"release":{"name":"projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app","rulesetName":"projects/eyalamrami-1d69e/rulesets/c1233528-4ec5-4321-9e10-6dd88935fb68"}}
[debug] [2025-11-21T10:08:05.439Z] <<< [apiv2][status] PATCH https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app 200
[debug] [2025-11-21T10:08:05.440Z] <<< [apiv2][body] PATCH https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app {"name":"projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app","rulesetName":"projects/eyalamrami-1d69e/rulesets/c1233528-4ec5-4321-9e10-6dd88935fb68","createTime":"2025-11-16T21:57:38.715272Z","updateTime":"2025-11-21T10:08:05.471990Z"}
[debug] [2025-11-21T10:08:05.440Z] [rules] updated release projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app
[info] ✔  storage: released rules storage.rules to firebase.storage 
[info] 
[info] ✔  Deploy complete! 
[info] 
[info] Project Console: https://console.firebase.google.com/project/eyalamrami-1d69e/overview
[debug] [2025-11-21T10:31:47.678Z] ----------------------------------------------------------------------
[debug] [2025-11-21T10:31:47.683Z] Command:       /opt/homebrew/Cellar/node/24.4.1/bin/node /opt/homebrew/bin/firebase deploy --only firestore:rules
[debug] [2025-11-21T10:31:47.683Z] CLI Version:   14.25.1
[debug] [2025-11-21T10:31:47.683Z] Platform:      darwin
[debug] [2025-11-21T10:31:47.683Z] Node Version:  v24.4.1
[debug] [2025-11-21T10:31:47.683Z] Time:          Fri Nov 21 2025 12:31:47 GMT+0200 (Israel Standard Time)
[debug] [2025-11-21T10:31:47.684Z] ----------------------------------------------------------------------
[debug] 
[debug] [2025-11-21T10:31:47.783Z] > command requires scopes: ["email","openid","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","https://www.googleapis.com/auth/cloud-platform"]
[debug] [2025-11-21T10:31:47.784Z] > authorizing via signed-in user (orel895@gmail.com)
[debug] [2025-11-21T10:31:47.784Z] [iam] checking project eyalamrami-1d69e for permissions ["datastore.indexes.create","datastore.indexes.delete","datastore.indexes.list","datastore.indexes.update","firebase.projects.get"]
[debug] [2025-11-21T10:31:47.784Z] Checked if tokens are valid: true, expires at: 1763722387190
[debug] [2025-11-21T10:31:47.784Z] Checked if tokens are valid: true, expires at: 1763722387190
[debug] [2025-11-21T10:31:47.785Z] >>> [apiv2][query] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions [none]
[debug] [2025-11-21T10:31:47.785Z] >>> [apiv2][(partial)header] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions x-goog-quota-user=projects/eyalamrami-1d69e
[debug] [2025-11-21T10:31:47.785Z] >>> [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions {"permissions":["datastore.indexes.create","datastore.indexes.delete","datastore.indexes.list","datastore.indexes.update","firebase.projects.get"]}
[debug] [2025-11-21T10:31:48.084Z] <<< [apiv2][status] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions 200
[debug] [2025-11-21T10:31:48.085Z] <<< [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions {"permissions":["datastore.indexes.create","datastore.indexes.delete","datastore.indexes.list","datastore.indexes.update","firebase.projects.get"]}
[info] 
[info] === Deploying to 'eyalamrami-1d69e'...
[info] 
[info] i  deploying firestore 
[info] i  firestore: ensuring required API firestore.googleapis.com is enabled... 
[info] i  firestore: ensuring required API firestore.googleapis.com is enabled... 
[debug] [2025-11-21T10:31:48.089Z] Checked if tokens are valid: true, expires at: 1763722387190
[debug] [2025-11-21T10:31:48.089Z] Checked if tokens are valid: true, expires at: 1763722387190
[debug] [2025-11-21T10:31:48.089Z] >>> [apiv2][query] GET https://firestore.googleapis.com/v1/projects/eyalamrami-1d69e/databases/(default) [none]
[debug] [2025-11-21T10:31:48.645Z] <<< [apiv2][status] GET https://firestore.googleapis.com/v1/projects/eyalamrami-1d69e/databases/(default) 200
[debug] [2025-11-21T10:31:48.645Z] <<< [apiv2][body] GET https://firestore.googleapis.com/v1/projects/eyalamrami-1d69e/databases/(default) {"name":"projects/eyalamrami-1d69e/databases/(default)","uid":"28c72577-e069-422d-b53f-9211ba17d04d","createTime":"2025-11-16T21:56:31.041581Z","updateTime":"2025-11-16T21:56:31.041581Z","locationId":"europe-west2","type":"FIRESTORE_NATIVE","concurrencyMode":"PESSIMISTIC","versionRetentionPeriod":"3600s","earliestVersionTime":"2025-11-21T09:31:48.747198Z","appEngineIntegrationMode":"DISABLED","keyPrefix":"g","pointInTimeRecoveryEnablement":"POINT_IN_TIME_RECOVERY_DISABLED","deleteProtectionState":"DELETE_PROTECTION_DISABLED","databaseEdition":"STANDARD","freeTier":true,"realtimeUpdatesMode":"REALTIME_UPDATES_MODE_ENABLED","etag":"IMjgrZGFg5EDMMXn/oLW95AD"}
[info] i  firestore: reading indexes from firestore.indexes.json... 
[info] i  cloud.firestore: checking firestore.rules for compilation errors... 
[debug] [2025-11-21T10:31:48.649Z] Checked if tokens are valid: true, expires at: 1763722387190
[debug] [2025-11-21T10:31:48.649Z] Checked if tokens are valid: true, expires at: 1763722387190
[debug] [2025-11-21T10:31:48.649Z] >>> [apiv2][query] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test [none]
[debug] [2025-11-21T10:31:48.649Z] >>> [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test [omitted]
[debug] [2025-11-21T10:31:49.539Z] <<< [apiv2][status] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test 200
[debug] [2025-11-21T10:31:49.539Z] <<< [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test {}
[info] ✔  cloud.firestore: rules file firestore.rules compiled successfully 
[debug] [2025-11-21T10:31:49.541Z] Checked if tokens are valid: true, expires at: 1763722387190
[debug] [2025-11-21T10:31:49.541Z] Checked if tokens are valid: true, expires at: 1763722387190
[debug] [2025-11-21T10:31:49.542Z] >>> [apiv2][query] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases pageSize=10&pageToken=
[debug] [2025-11-21T10:31:50.216Z] <<< [apiv2][status] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases 200
[debug] [2025-11-21T10:31:50.216Z] <<< [apiv2][body] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases {"releases":[{"name":"projects/eyalamrami-1d69e/releases/cloud.firestore","rulesetName":"projects/eyalamrami-1d69e/rulesets/69cd5007-0d7f-4614-8298-146bdab6a889","createTime":"2025-11-16T21:56:37.010939Z","updateTime":"2025-11-21T09:53:12.951888Z"},{"name":"projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app","rulesetName":"projects/eyalamrami-1d69e/rulesets/c1233528-4ec5-4321-9e10-6dd88935fb68","createTime":"2025-11-16T21:57:38.715272Z","updateTime":"2025-11-21T10:08:05.471990Z"}]}
[debug] [2025-11-21T10:31:50.233Z] Checked if tokens are valid: true, expires at: 1763722387190
[debug] [2025-11-21T10:31:50.233Z] Checked if tokens are valid: true, expires at: 1763722387190
[debug] [2025-11-21T10:31:50.233Z] >>> [apiv2][query] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets/69cd5007-0d7f-4614-8298-146bdab6a889 [none]
[debug] [2025-11-21T10:31:50.914Z] <<< [apiv2][status] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets/69cd5007-0d7f-4614-8298-146bdab6a889 200
[debug] [2025-11-21T10:31:50.914Z] <<< [apiv2][body] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets/69cd5007-0d7f-4614-8298-146bdab6a889 [omitted]
[info] i  firestore: uploading rules firestore.rules... 
[debug] [2025-11-21T10:31:50.916Z] Checked if tokens are valid: true, expires at: 1763722387190
[debug] [2025-11-21T10:31:50.916Z] Checked if tokens are valid: true, expires at: 1763722387190
[debug] [2025-11-21T10:31:50.917Z] >>> [apiv2][query] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets [none]
[debug] [2025-11-21T10:31:50.917Z] >>> [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets [omitted]
[debug] [2025-11-21T10:31:51.318Z] <<< [apiv2][status] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets 200
[debug] [2025-11-21T10:31:51.318Z] <<< [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets {"name":"projects/eyalamrami-1d69e/rulesets/c486d0b3-8834-45fa-89e2-0cda5df6d6c9","source":{"files":[{"content":"rules_version = '2';\nservice cloud.firestore {\n  match /databases/{database}/documents {\n    \n    // ========== HELPER FUNCTIONS ==========\n    \n    function isSignedIn() {\n      return request.auth != null;\n    }\n    \n    function isAdmin() {\n      return isSignedIn() &&\n             get(/databases/$(database)/documents/users/$(request.auth.uid)).data.role == 'admin';\n    }\n    \n    // ========== USERS COLLECTION ==========\n    match /users/{uid} {\n      // Users can read/write their own document\n      allow read: if request.auth != null && request.auth.uid == uid;\n      allow write: if request.auth != null && request.auth.uid == uid;\n      \n      // Admins can write role field\n      allow update: if isAdmin() && \n                    request.resource.data.diff(resource.data).affectedKeys().hasOnly(['role']);\n    }\n    \n    // ========== DAILY INSIGHTS COLLECTION ==========\n    match /dailyInsights/{dateId} {\n      // Everyone can read published insights\n      allow read: if true;\n      \n      // Only admins can write\n      allow write: if isAdmin();\n    }\n    \n    // ========== DAILY STORIES COLLECTION ==========\n    match /dailyStories/{dateId}/clips/{clipId} {\n      // Everyone can read stories\n      allow read: if true;\n      \n      // Only admins can write\n      allow write: if isAdmin();\n    }\n    \n    // ========== NOTIFICATIONS COLLECTION ==========\n    match /notifications/{notificationId} {\n      // Only admins can read/write\n      allow read, write: if isAdmin();\n    }\n    \n    // ========== FEEDS COLLECTION ==========\n    match /feeds/{feedId} {\n      // Everyone can read published feeds, admins can read all\n      allow read: if resource.data.published == true || isAdmin();\n      \n      // Only admins can write\n      allow write: if isAdmin();\n    }\n    \n    // ========== FAITH LESSONS COLLECTION ==========\n    match /faithLessons/{lessonId} {\n      // Public read for published lessons\n      allow read: if resource.data.published == true || isAdmin();\n      \n      // Only admins can write\n      allow write: if isAdmin();\n    }\n    \n    // ========== LESSONS COLLECTION ==========\n    match /lessons/{lessonId} {\n      // Public read for all (lessons should be accessible to everyone)\n      allow read: if true;\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== PODCASTS COLLECTION ==========\n    match /podcasts/{podcastId} {\n      // Everyone can read active podcasts (public)\n      allow read: if resource.data.isActive == true;\n      // Admins can read all (including inactive)\n      allow read: if isAdmin();\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== DAILY VIDEOS COLLECTION ==========\n    match /dailyVideos/{videoId} {\n      // All signed-in users can read videos\n      allow read: if isSignedIn();\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== NEWS COLLECTION ==========\n    match /news/{newsId} {\n      // Published news can be read by everyone (public)\n      allow read: if resource.data.isPublished == true;\n      // Admins can read all (including drafts)\n      allow read: if isAdmin();\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== ALERTS COLLECTION ==========\n    match /alerts/{alertId} {\n      // Everyone can read active alerts (public)\n      allow read: if resource.data.isActive == true;\n      // Admins can read all (including inactive)\n      allow read: if isAdmin();\n      // Only admins can create, update, delete\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== HOME CARDS COLLECTION ==========\n    match /homeCards/{cardId} {\n      // Public read for all\n      allow read: if true;\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== APP CONFIG COLLECTION ==========\n    match /appConfig/{configId} {\n      // Public read\n      allow read: if true;\n      // Only admins can modify\n      allow write: if isAdmin();\n    }\n\n    // ========== INSTITUTIONS COLLECTION ==========\n    match /institutions/{institutionId} {\n      // Public read for all\n      allow read: if true;\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== INSTITUTIONS CONTENT COLLECTION ==========\n    match /institutionsContent/{activityId} {\n      // All signed-in users can read institution content\n      allow read: if isSignedIn();\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== BOOKS COLLECTION ==========\n    match /books/{bookId} {\n      // All signed-in users can read books\n      allow read: if isSignedIn();\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== FLYERS COLLECTION ==========\n    match /flyers/{flyerId} {\n      // All signed-in users can read flyers\n      allow read: if isSignedIn();\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== COMMUNITY POSTS COLLECTION ==========\n    match /communityPosts/{postId} {\n      // Everyone can read active community posts (public)\n      allow read: if resource.data.isActive == true;\n      // Admins can read all (including inactive)\n      allow read: if isAdmin();\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== LEADS COLLECTION ==========\n    match /leads/{leadId} {\n      // Anyone can create a lead (for contact forms)\n      allow create: if true;\n      // Only admins can read leads\n      allow read, update, delete: if isAdmin();\n    }\n\n    // ========== FAITH STORIES COLLECTION ==========\n    match /faith_stories/{storyId} {\n      // Admins can read all stories\n      allow read: if isAdmin();\n      // Signed-in users can read active stories\n      allow read: if isSignedIn() && resource.data.isActive == true;\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== DEFAULT DENY ==========\n    match /{document=**} {\n      allow read, write: if false;\n    }\n  }\n}\n","name":"firestore.rules"}]},"createTime":"2025-11-21T10:31:51.345599Z","metadata":{"services":["cloud.firestore"]}}
[debug] [2025-11-21T10:31:51.318Z] [rules] created ruleset projects/eyalamrami-1d69e/rulesets/c486d0b3-8834-45fa-89e2-0cda5df6d6c9
[debug] [2025-11-21T10:31:51.318Z] [rules] releasing cloud.firestore/(default) with ruleset projects/eyalamrami-1d69e/rulesets/c486d0b3-8834-45fa-89e2-0cda5df6d6c9
[debug] [2025-11-21T10:31:51.318Z] Checked if tokens are valid: true, expires at: 1763722387190
[debug] [2025-11-21T10:31:51.318Z] Checked if tokens are valid: true, expires at: 1763722387190
[debug] [2025-11-21T10:31:51.319Z] >>> [apiv2][query] PATCH https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases/cloud.firestore/(default) [none]
[debug] [2025-11-21T10:31:51.319Z] >>> [apiv2][body] PATCH https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases/cloud.firestore/(default) {"release":{"name":"projects/eyalamrami-1d69e/releases/cloud.firestore/(default)","rulesetName":"projects/eyalamrami-1d69e/rulesets/c486d0b3-8834-45fa-89e2-0cda5df6d6c9"}}
[debug] [2025-11-21T10:31:51.832Z] <<< [apiv2][status] PATCH https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases/cloud.firestore/(default) 200
[debug] [2025-11-21T10:31:51.833Z] <<< [apiv2][body] PATCH https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases/cloud.firestore/(default) {"name":"projects/eyalamrami-1d69e/releases/cloud.firestore","rulesetName":"projects/eyalamrami-1d69e/rulesets/c486d0b3-8834-45fa-89e2-0cda5df6d6c9","createTime":"2025-11-16T21:56:37.010939Z","updateTime":"2025-11-21T10:31:51.865715Z"}
[debug] [2025-11-21T10:31:51.833Z] [rules] updated release projects/eyalamrami-1d69e/releases/cloud.firestore
[info] ✔  firestore: released rules firestore.rules to cloud.firestore 
[info] 
[info] ✔  Deploy complete! 
[info] 
[info] Project Console: https://console.firebase.google.com/project/eyalamrami-1d69e/overview
[debug] [2025-11-21T10:40:15.176Z] ----------------------------------------------------------------------
[debug] [2025-11-21T10:40:15.178Z] Command:       /opt/homebrew/Cellar/node/24.4.1/bin/node /opt/homebrew/bin/firebase deploy --only firestore:rules
[debug] [2025-11-21T10:40:15.178Z] CLI Version:   14.25.1
[debug] [2025-11-21T10:40:15.178Z] Platform:      darwin
[debug] [2025-11-21T10:40:15.178Z] Node Version:  v24.4.1
[debug] [2025-11-21T10:40:15.178Z] Time:          Fri Nov 21 2025 12:40:15 GMT+0200 (Israel Standard Time)
[debug] [2025-11-21T10:40:15.178Z] ----------------------------------------------------------------------
[debug] 
[debug] [2025-11-21T10:40:15.302Z] > command requires scopes: ["email","openid","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","https://www.googleapis.com/auth/cloud-platform"]
[debug] [2025-11-21T10:40:15.302Z] > authorizing via signed-in user (orel895@gmail.com)
[debug] [2025-11-21T10:40:15.302Z] [iam] checking project eyalamrami-1d69e for permissions ["datastore.indexes.create","datastore.indexes.delete","datastore.indexes.list","datastore.indexes.update","firebase.projects.get"]
[debug] [2025-11-21T10:40:15.303Z] Checked if tokens are valid: false, expires at: 1763722387190
[debug] [2025-11-21T10:40:15.304Z] Checked if tokens are valid: false, expires at: 1763722387190
[debug] [2025-11-21T10:40:15.304Z] > refreshing access token with scopes: []
[debug] [2025-11-21T10:40:15.306Z] >>> [apiv2][query] POST https://www.googleapis.com/oauth2/v3/token [none]
[debug] [2025-11-21T10:40:15.306Z] >>> [apiv2][body] POST https://www.googleapis.com/oauth2/v3/token [omitted]
[debug] [2025-11-21T10:40:15.503Z] <<< [apiv2][status] POST https://www.googleapis.com/oauth2/v3/token 200
[debug] [2025-11-21T10:40:15.504Z] <<< [apiv2][body] POST https://www.googleapis.com/oauth2/v3/token [omitted]
[debug] [2025-11-21T10:40:15.517Z] >>> [apiv2][query] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions [none]
[debug] [2025-11-21T10:40:15.517Z] >>> [apiv2][(partial)header] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions x-goog-quota-user=projects/eyalamrami-1d69e
[debug] [2025-11-21T10:40:15.517Z] >>> [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions {"permissions":["datastore.indexes.create","datastore.indexes.delete","datastore.indexes.list","datastore.indexes.update","firebase.projects.get"]}
[debug] [2025-11-21T10:40:16.488Z] <<< [apiv2][status] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions 200
[debug] [2025-11-21T10:40:16.488Z] <<< [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions {"permissions":["datastore.indexes.create","datastore.indexes.delete","datastore.indexes.list","datastore.indexes.update","firebase.projects.get"]}
[info] 
[info] === Deploying to 'eyalamrami-1d69e'...
[info] 
[info] i  deploying firestore 
[info] i  firestore: ensuring required API firestore.googleapis.com is enabled... 
[info] i  firestore: ensuring required API firestore.googleapis.com is enabled... 
[debug] [2025-11-21T10:40:16.493Z] Checked if tokens are valid: true, expires at: 1763725214504
[debug] [2025-11-21T10:40:16.493Z] Checked if tokens are valid: true, expires at: 1763725214504
[debug] [2025-11-21T10:40:16.493Z] >>> [apiv2][query] GET https://firestore.googleapis.com/v1/projects/eyalamrami-1d69e/databases/(default) [none]
[debug] [2025-11-21T10:40:17.074Z] <<< [apiv2][status] GET https://firestore.googleapis.com/v1/projects/eyalamrami-1d69e/databases/(default) 200
[debug] [2025-11-21T10:40:17.074Z] <<< [apiv2][body] GET https://firestore.googleapis.com/v1/projects/eyalamrami-1d69e/databases/(default) {"name":"projects/eyalamrami-1d69e/databases/(default)","uid":"28c72577-e069-422d-b53f-9211ba17d04d","createTime":"2025-11-16T21:56:31.041581Z","updateTime":"2025-11-16T21:56:31.041581Z","locationId":"europe-west2","type":"FIRESTORE_NATIVE","concurrencyMode":"PESSIMISTIC","versionRetentionPeriod":"3600s","earliestVersionTime":"2025-11-21T09:40:17.177796Z","appEngineIntegrationMode":"DISABLED","keyPrefix":"g","pointInTimeRecoveryEnablement":"POINT_IN_TIME_RECOVERY_DISABLED","deleteProtectionState":"DELETE_PROTECTION_DISABLED","databaseEdition":"STANDARD","freeTier":true,"realtimeUpdatesMode":"REALTIME_UPDATES_MODE_ENABLED","etag":"IMnz5YOHg5EDMMXn/oLW95AD"}
[info] i  firestore: reading indexes from firestore.indexes.json... 
[info] i  cloud.firestore: checking firestore.rules for compilation errors... 
[debug] [2025-11-21T10:40:17.078Z] Checked if tokens are valid: true, expires at: 1763725214504
[debug] [2025-11-21T10:40:17.078Z] Checked if tokens are valid: true, expires at: 1763725214504
[debug] [2025-11-21T10:40:17.078Z] >>> [apiv2][query] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test [none]
[debug] [2025-11-21T10:40:17.079Z] >>> [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test [omitted]
[debug] [2025-11-21T10:40:17.948Z] <<< [apiv2][status] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test 200
[debug] [2025-11-21T10:40:17.949Z] <<< [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test {}
[info] ✔  cloud.firestore: rules file firestore.rules compiled successfully 
[debug] [2025-11-21T10:40:17.951Z] Checked if tokens are valid: true, expires at: 1763725214504
[debug] [2025-11-21T10:40:17.951Z] Checked if tokens are valid: true, expires at: 1763725214504
[debug] [2025-11-21T10:40:17.952Z] >>> [apiv2][query] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases pageSize=10&pageToken=
[debug] [2025-11-21T10:40:18.635Z] <<< [apiv2][status] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases 200
[debug] [2025-11-21T10:40:18.635Z] <<< [apiv2][body] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases {"releases":[{"name":"projects/eyalamrami-1d69e/releases/cloud.firestore","rulesetName":"projects/eyalamrami-1d69e/rulesets/c486d0b3-8834-45fa-89e2-0cda5df6d6c9","createTime":"2025-11-16T21:56:37.010939Z","updateTime":"2025-11-21T10:31:51.865715Z"},{"name":"projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app","rulesetName":"projects/eyalamrami-1d69e/rulesets/c1233528-4ec5-4321-9e10-6dd88935fb68","createTime":"2025-11-16T21:57:38.715272Z","updateTime":"2025-11-21T10:08:05.471990Z"}]}
[debug] [2025-11-21T10:40:18.649Z] Checked if tokens are valid: true, expires at: 1763725214504
[debug] [2025-11-21T10:40:18.649Z] Checked if tokens are valid: true, expires at: 1763725214504
[debug] [2025-11-21T10:40:18.649Z] >>> [apiv2][query] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets/c486d0b3-8834-45fa-89e2-0cda5df6d6c9 [none]
[debug] [2025-11-21T10:40:19.363Z] <<< [apiv2][status] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets/c486d0b3-8834-45fa-89e2-0cda5df6d6c9 200
[debug] [2025-11-21T10:40:19.363Z] <<< [apiv2][body] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets/c486d0b3-8834-45fa-89e2-0cda5df6d6c9 [omitted]
[info] i  firestore: uploading rules firestore.rules... 
[debug] [2025-11-21T10:40:19.365Z] Checked if tokens are valid: true, expires at: 1763725214504
[debug] [2025-11-21T10:40:19.365Z] Checked if tokens are valid: true, expires at: 1763725214504
[debug] [2025-11-21T10:40:19.366Z] >>> [apiv2][query] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets [none]
[debug] [2025-11-21T10:40:19.366Z] >>> [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets [omitted]
[debug] [2025-11-21T10:40:20.207Z] <<< [apiv2][status] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets 200
[debug] [2025-11-21T10:40:20.207Z] <<< [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets {"name":"projects/eyalamrami-1d69e/rulesets/85775f06-7868-4a44-97b7-63a1e1fa3f32","source":{"files":[{"content":"rules_version = '2';\nservice cloud.firestore {\n  match /databases/{database}/documents {\n    \n    // ========== HELPER FUNCTIONS ==========\n    \n    function isSignedIn() {\n      return request.auth != null;\n    }\n    \n    function isAdmin() {\n      return isSignedIn() &&\n             get(/databases/$(database)/documents/users/$(request.auth.uid)).data.role == 'admin';\n    }\n    \n    // ========== USERS COLLECTION ==========\n    match /users/{uid} {\n      // Users can read/write their own document\n      allow read: if request.auth != null && request.auth.uid == uid;\n      allow write: if request.auth != null && request.auth.uid == uid;\n      \n      // Admins can write role field\n      allow update: if isAdmin() && \n                    request.resource.data.diff(resource.data).affectedKeys().hasOnly(['role']);\n    }\n    \n    // ========== DAILY INSIGHTS COLLECTION ==========\n    match /dailyInsights/{dateId} {\n      // Everyone can read published insights\n      allow read: if true;\n      \n      // Only admins can write\n      allow write: if isAdmin();\n    }\n    \n    // ========== DAILY STORIES COLLECTION ==========\n    match /dailyStories/{dateId}/clips/{clipId} {\n      // Everyone can read stories\n      allow read: if true;\n      \n      // Only admins can write\n      allow write: if isAdmin();\n    }\n    \n    // ========== NOTIFICATIONS COLLECTION ==========\n    match /notifications/{notificationId} {\n      // Only admins can read/write\n      allow read, write: if isAdmin();\n    }\n    \n    // ========== FEEDS COLLECTION ==========\n    match /feeds/{feedId} {\n      // Everyone can read published feeds, admins can read all\n      allow read: if resource.data.published == true || isAdmin();\n      \n      // Only admins can write\n      allow write: if isAdmin();\n    }\n    \n    // ========== FAITH LESSONS COLLECTION ==========\n    match /faithLessons/{lessonId} {\n      // Public read for published lessons\n      allow read: if resource.data.published == true || isAdmin();\n      \n      // Only admins can write\n      allow write: if isAdmin();\n    }\n    \n    // ========== LESSONS COLLECTION ==========\n    match /lessons/{lessonId} {\n      // Public read for all (lessons should be accessible to everyone)\n      allow read: if true;\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== PODCASTS COLLECTION ==========\n    match /podcasts/{podcastId} {\n      // Everyone can read active podcasts (public)\n      allow read: if resource.data.isActive == true;\n      // Admins can read all (including inactive)\n      allow read: if isAdmin();\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== DAILY VIDEOS COLLECTION ==========\n    match /dailyVideos/{videoId} {\n      // All signed-in users can read videos\n      allow read: if isSignedIn();\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== NEWS COLLECTION ==========\n    match /news/{newsId} {\n      // Published news can be read by everyone (public)\n      allow read: if resource.data.isPublished == true;\n      // Admins can read all (including drafts)\n      allow read: if isAdmin();\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== ALERTS COLLECTION ==========\n    match /alerts/{alertId} {\n      // Everyone can read active alerts (public)\n      allow read: if resource.data.isActive == true;\n      // Admins can read all (including inactive)\n      allow read: if isAdmin();\n      // Only admins can create, update, delete\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== HOME CARDS COLLECTION ==========\n    match /homeCards/{cardId} {\n      // Public read for all\n      allow read: if true;\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== APP CONFIG COLLECTION ==========\n    match /appConfig/{configId} {\n      // Public read\n      allow read: if true;\n      // Only admins can modify\n      allow write: if isAdmin();\n    }\n\n    // ========== INSTITUTIONS COLLECTION ==========\n    match /institutions/{institutionId} {\n      // Public read for all\n      allow read: if true;\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== INSTITUTIONS CONTENT COLLECTION ==========\n    match /institutionsContent/{activityId} {\n      // All signed-in users can read institution content\n      allow read: if isSignedIn();\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== BOOKS COLLECTION ==========\n    match /books/{bookId} {\n      // All signed-in users can read books\n      allow read: if isSignedIn();\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== FLYERS COLLECTION ==========\n    match /flyers/{flyerId} {\n      // Everyone can read active flyers (public)\n      // Default to true if isActive field is missing (backward compatibility)\n      allow read: if resource.data.isActive != false;\n      // Admins can read all (including inactive)\n      allow read: if isAdmin();\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== COMMUNITY POSTS COLLECTION ==========\n    match /communityPosts/{postId} {\n      // Everyone can read active community posts (public)\n      allow read: if resource.data.isActive == true;\n      // Admins can read all (including inactive)\n      allow read: if isAdmin();\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== LEADS COLLECTION ==========\n    match /leads/{leadId} {\n      // Anyone can create a lead (for contact forms)\n      allow create: if true;\n      // Only admins can read leads\n      allow read, update, delete: if isAdmin();\n    }\n\n    // ========== FAITH STORIES COLLECTION ==========\n    match /faith_stories/{storyId} {\n      // Admins can read all stories\n      allow read: if isAdmin();\n      // Signed-in users can read active stories\n      allow read: if isSignedIn() && resource.data.isActive == true;\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== DEFAULT DENY ==========\n    match /{document=**} {\n      allow read, write: if false;\n    }\n  }\n}\n","name":"firestore.rules"}]},"createTime":"2025-11-21T10:40:20.243007Z","metadata":{"services":["cloud.firestore"]}}
[debug] [2025-11-21T10:40:20.207Z] [rules] created ruleset projects/eyalamrami-1d69e/rulesets/85775f06-7868-4a44-97b7-63a1e1fa3f32
[debug] [2025-11-21T10:40:20.208Z] [rules] releasing cloud.firestore/(default) with ruleset projects/eyalamrami-1d69e/rulesets/85775f06-7868-4a44-97b7-63a1e1fa3f32
[debug] [2025-11-21T10:40:20.208Z] Checked if tokens are valid: true, expires at: 1763725214504
[debug] [2025-11-21T10:40:20.208Z] Checked if tokens are valid: true, expires at: 1763725214504
[debug] [2025-11-21T10:40:20.209Z] >>> [apiv2][query] PATCH https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases/cloud.firestore/(default) [none]
[debug] [2025-11-21T10:40:20.209Z] >>> [apiv2][body] PATCH https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases/cloud.firestore/(default) {"release":{"name":"projects/eyalamrami-1d69e/releases/cloud.firestore/(default)","rulesetName":"projects/eyalamrami-1d69e/rulesets/85775f06-7868-4a44-97b7-63a1e1fa3f32"}}
[debug] [2025-11-21T10:40:21.100Z] <<< [apiv2][status] PATCH https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases/cloud.firestore/(default) 200
[debug] [2025-11-21T10:40:21.100Z] <<< [apiv2][body] PATCH https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases/cloud.firestore/(default) {"name":"projects/eyalamrami-1d69e/releases/cloud.firestore","rulesetName":"projects/eyalamrami-1d69e/rulesets/85775f06-7868-4a44-97b7-63a1e1fa3f32","createTime":"2025-11-16T21:56:37.010939Z","updateTime":"2025-11-21T10:40:21.137191Z"}
[debug] [2025-11-21T10:40:21.100Z] [rules] updated release projects/eyalamrami-1d69e/releases/cloud.firestore
[info] ✔  firestore: released rules firestore.rules to cloud.firestore 
[info] 
[info] ✔  Deploy complete! 
[info] 
[info] Project Console: https://console.firebase.google.com/project/eyalamrami-1d69e/overview
[debug] [2025-11-21T10:40:58.932Z] ----------------------------------------------------------------------
[debug] [2025-11-21T10:40:58.934Z] Command:       /opt/homebrew/Cellar/node/24.4.1/bin/node /opt/homebrew/bin/firebase deploy --only firestore:indexes
[debug] [2025-11-21T10:40:58.934Z] CLI Version:   14.25.1
[debug] [2025-11-21T10:40:58.934Z] Platform:      darwin
[debug] [2025-11-21T10:40:58.934Z] Node Version:  v24.4.1
[debug] [2025-11-21T10:40:58.934Z] Time:          Fri Nov 21 2025 12:40:58 GMT+0200 (Israel Standard Time)
[debug] [2025-11-21T10:40:58.943Z] ----------------------------------------------------------------------
[debug] 
[debug] [2025-11-21T10:40:59.030Z] > command requires scopes: ["email","openid","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","https://www.googleapis.com/auth/cloud-platform"]
[debug] [2025-11-21T10:40:59.031Z] > authorizing via signed-in user (orel895@gmail.com)
[debug] [2025-11-21T10:40:59.031Z] [iam] checking project eyalamrami-1d69e for permissions ["datastore.indexes.create","datastore.indexes.delete","datastore.indexes.list","datastore.indexes.update","firebase.projects.get"]
[debug] [2025-11-21T10:40:59.032Z] Checked if tokens are valid: true, expires at: 1763725214504
[debug] [2025-11-21T10:40:59.032Z] Checked if tokens are valid: true, expires at: 1763725214504
[debug] [2025-11-21T10:40:59.032Z] >>> [apiv2][query] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions [none]
[debug] [2025-11-21T10:40:59.032Z] >>> [apiv2][(partial)header] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions x-goog-quota-user=projects/eyalamrami-1d69e
[debug] [2025-11-21T10:40:59.032Z] >>> [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions {"permissions":["datastore.indexes.create","datastore.indexes.delete","datastore.indexes.list","datastore.indexes.update","firebase.projects.get"]}
[debug] [2025-11-21T10:41:00.015Z] <<< [apiv2][status] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions 200
[debug] [2025-11-21T10:41:00.016Z] <<< [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions {"permissions":["datastore.indexes.create","datastore.indexes.delete","datastore.indexes.list","datastore.indexes.update","firebase.projects.get"]}
[info] 
[info] === Deploying to 'eyalamrami-1d69e'...
[info] 
[info] i  deploying firestore 
[info] i  firestore: ensuring required API firestore.googleapis.com is enabled... 
[info] i  firestore: ensuring required API firestore.googleapis.com is enabled... 
[debug] [2025-11-21T10:41:00.034Z] Checked if tokens are valid: true, expires at: 1763725214504
[debug] [2025-11-21T10:41:00.034Z] Checked if tokens are valid: true, expires at: 1763725214504
[debug] [2025-11-21T10:41:00.034Z] >>> [apiv2][query] GET https://firestore.googleapis.com/v1/projects/eyalamrami-1d69e/databases/(default) [none]
[debug] [2025-11-21T10:41:00.575Z] <<< [apiv2][status] GET https://firestore.googleapis.com/v1/projects/eyalamrami-1d69e/databases/(default) 200
[debug] [2025-11-21T10:41:00.575Z] <<< [apiv2][body] GET https://firestore.googleapis.com/v1/projects/eyalamrami-1d69e/databases/(default) {"name":"projects/eyalamrami-1d69e/databases/(default)","uid":"28c72577-e069-422d-b53f-9211ba17d04d","createTime":"2025-11-16T21:56:31.041581Z","updateTime":"2025-11-16T21:56:31.041581Z","locationId":"europe-west2","type":"FIRESTORE_NATIVE","concurrencyMode":"PESSIMISTIC","versionRetentionPeriod":"3600s","earliestVersionTime":"2025-11-21T09:41:00.680846Z","appEngineIntegrationMode":"DISABLED","keyPrefix":"g","pointInTimeRecoveryEnablement":"POINT_IN_TIME_RECOVERY_DISABLED","deleteProtectionState":"DELETE_PROTECTION_DISABLED","databaseEdition":"STANDARD","freeTier":true,"realtimeUpdatesMode":"REALTIME_UPDATES_MODE_ENABLED","etag":"IN2OxZiHg5EDMMXn/oLW95AD"}
[info] i  firestore: reading indexes from firestore.indexes.json... 
[info] i  cloud.firestore: checking firestore.rules for compilation errors... 
[debug] [2025-11-21T10:41:00.578Z] Checked if tokens are valid: true, expires at: 1763725214504
[debug] [2025-11-21T10:41:00.578Z] Checked if tokens are valid: true, expires at: 1763725214504
[debug] [2025-11-21T10:41:00.578Z] >>> [apiv2][query] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test [none]
[debug] [2025-11-21T10:41:00.578Z] >>> [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test [omitted]
[debug] [2025-11-21T10:41:00.936Z] <<< [apiv2][status] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test 200
[debug] [2025-11-21T10:41:00.938Z] <<< [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test {}
[info] ✔  cloud.firestore: rules file firestore.rules compiled successfully 
[info] i  firestore: deploying indexes... 
[debug] [2025-11-21T10:41:00.943Z] Checked if tokens are valid: true, expires at: 1763725214504
[debug] [2025-11-21T10:41:00.943Z] Checked if tokens are valid: true, expires at: 1763725214504
[debug] [2025-11-21T10:41:00.943Z] >>> [apiv2][query] GET https://firestore.googleapis.com/v1/projects/eyalamrami-1d69e/databases/(default)/collectionGroups/-/indexes [none]
[debug] [2025-11-21T10:41:01.080Z] <<< [apiv2][status] GET https://firestore.googleapis.com/v1/projects/eyalamrami-1d69e/databases/(default)/collectionGroups/-/indexes 200
[debug] [2025-11-21T10:41:01.081Z] <<< [apiv2][body] GET https://firestore.googleapis.com/v1/projects/eyalamrami-1d69e/databases/(default)/collectionGroups/-/indexes {"indexes":[{"name":"projects/eyalamrami-1d69e/databases/(default)/collectionGroups/news/indexes/CICAgNiav4AK","queryScope":"COLLECTION","fields":[{"fieldPath":"isPublished","order":"ASCENDING"},{"fieldPath":"publishedAt","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}],"state":"READY","density":"SPARSE_ALL"},{"name":"projects/eyalamrami-1d69e/databases/(default)/collectionGroups/feeds/indexes/CICAgJim14AK","queryScope":"COLLECTION","fields":[{"fieldPath":"published","order":"ASCENDING"},{"fieldPath":"createdAt","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}],"state":"READY","density":"SPARSE_ALL"},{"name":"projects/eyalamrami-1d69e/databases/(default)/collectionGroups/dailyInsights/indexes/CICAgOjXh4EK","queryScope":"COLLECTION","fields":[{"fieldPath":"published","order":"ASCENDING"},{"fieldPath":"createdAt","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}],"state":"READY","density":"SPARSE_ALL"},{"name":"projects/eyalamrami-1d69e/databases/(default)/collectionGroups/lessons/indexes/CICAgJj7z4EK","queryScope":"COLLECTION","fields":[{"fieldPath":"category","order":"ASCENDING"},{"fieldPath":"order","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}],"state":"READY","density":"SPARSE_ALL"},{"name":"projects/eyalamrami-1d69e/databases/(default)/collectionGroups/podcasts/indexes/CICAgNjpgYIK","queryScope":"COLLECTION","fields":[{"fieldPath":"isActive","order":"ASCENDING"},{"fieldPath":"order","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}],"state":"READY","density":"SPARSE_ALL"},{"name":"projects/eyalamrami-1d69e/databases/(default)/collectionGroups/alerts/indexes/CICAgJjF9oIK","queryScope":"COLLECTION","fields":[{"fieldPath":"isActive","order":"ASCENDING"},{"fieldPath":"createdAt","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}],"state":"READY","density":"SPARSE_ALL"},{"name":"projects/eyalamrami-1d69e/databases/(default)/collectionGroups/notifications/indexes/CICAgJiUpoMK","queryScope":"COLLECTION","fields":[{"fieldPath":"status","order":"ASCENDING"},{"fieldPath":"createdAt","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}],"state":"READY","density":"SPARSE_ALL"},{"name":"projects/eyalamrami-1d69e/databases/(default)/collectionGroups/lessons/indexes/CICAgNi47oMK","queryScope":"COLLECTION","fields":[{"fieldPath":"category","order":"ASCENDING"},{"fieldPath":"createdAt","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}],"state":"READY","density":"SPARSE_ALL"},{"name":"projects/eyalamrami-1d69e/databases/(default)/collectionGroups/dailyVideos/indexes/CICAgJjmnIgK","queryScope":"COLLECTION","fields":[{"fieldPath":"isActive","order":"ASCENDING"},{"fieldPath":"createdAt","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}],"state":"READY","density":"SPARSE_ALL"},{"name":"projects/eyalamrami-1d69e/databases/(default)/collectionGroups/homeCards/indexes/CICAgNi4o4sK","queryScope":"COLLECTION","fields":[{"fieldPath":"isActive","order":"ASCENDING"},{"fieldPath":"order","order":"ASCENDING"},{"fieldPath":"__name__","order":"ASCENDING"}],"state":"READY","density":"SPARSE_ALL"},{"name":"projects/eyalamrami-1d69e/databases/(default)/collectionGroups/faithLessons/indexes/CICAgOi3kJAK","queryScope":"COLLECTION","fields":[{"fieldPath":"category","order":"ASCENDING"},{"fieldPath":"priority","order":"ASCENDING"},{"fieldPath":"__name__","order":"ASCENDING"}],"state":"READY","density":"SPARSE_ALL"},{"name":"projects/eyalamrami-1d69e/databases/(default)/collectionGroups/news/indexes/CICAgJjmiJEK","queryScope":"COLLECTION","fields":[{"fieldPath":"category","order":"ASCENDING"},{"fieldPath":"publishedAt","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}],"state":"READY","density":"SPARSE_ALL"},{"name":"projects/eyalamrami-1d69e/databases/(default)/collectionGroups/podcasts/indexes/CICAgNi4-ZIK","queryScope":"COLLECTION","fields":[{"fieldPath":"isActive","order":"ASCENDING"},{"fieldPath":"createdAt","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}],"state":"READY","density":"SPARSE_ALL"}]}
[debug] [2025-11-21T10:41:01.081Z] Checked if tokens are valid: true, expires at: 1763725214504
[debug] [2025-11-21T10:41:01.082Z] Checked if tokens are valid: true, expires at: 1763725214504
[debug] [2025-11-21T10:41:01.082Z] >>> [apiv2][query] GET https://firestore.googleapis.com/v1/projects/eyalamrami-1d69e/databases/(default)/collectionGroups/-/fields?filter=indexConfig.usesAncestorConfig=false OR ttlConfig:* [none]
[debug] [2025-11-21T10:41:01.190Z] <<< [apiv2][status] GET https://firestore.googleapis.com/v1/projects/eyalamrami-1d69e/databases/(default)/collectionGroups/-/fields?filter=indexConfig.usesAncestorConfig=false OR ttlConfig:* 200
[debug] [2025-11-21T10:41:01.190Z] <<< [apiv2][body] GET https://firestore.googleapis.com/v1/projects/eyalamrami-1d69e/databases/(default)/collectionGroups/-/fields?filter=indexConfig.usesAncestorConfig=false OR ttlConfig:* {"fields":[{"name":"projects/eyalamrami-1d69e/databases/(default)/collectionGroups/__default__/fields/*","indexConfig":{"indexes":[{"queryScope":"COLLECTION","fields":[{"fieldPath":"*","order":"ASCENDING"}],"state":"READY"},{"queryScope":"COLLECTION","fields":[{"fieldPath":"*","order":"DESCENDING"}],"state":"READY"},{"queryScope":"COLLECTION","fields":[{"fieldPath":"*","arrayConfig":"CONTAINS"}],"state":"READY"}]}}]}
[debug] [2025-11-21T10:41:01.190Z] Checked if tokens are valid: true, expires at: 1763725214504
[debug] [2025-11-21T10:41:01.190Z] Checked if tokens are valid: true, expires at: 1763725214504
[debug] [2025-11-21T10:41:01.190Z] >>> [apiv2][query] GET https://firestore.googleapis.com/v1/projects/eyalamrami-1d69e/databases/(default) [none]
[debug] [2025-11-21T10:41:01.320Z] <<< [apiv2][status] GET https://firestore.googleapis.com/v1/projects/eyalamrami-1d69e/databases/(default) 200
[debug] [2025-11-21T10:41:01.320Z] <<< [apiv2][body] GET https://firestore.googleapis.com/v1/projects/eyalamrami-1d69e/databases/(default) {"name":"projects/eyalamrami-1d69e/databases/(default)","uid":"28c72577-e069-422d-b53f-9211ba17d04d","createTime":"2025-11-16T21:56:31.041581Z","updateTime":"2025-11-16T21:56:31.041581Z","locationId":"europe-west2","type":"FIRESTORE_NATIVE","concurrencyMode":"PESSIMISTIC","versionRetentionPeriod":"3600s","earliestVersionTime":"2025-11-21T09:41:01.419923Z","appEngineIntegrationMode":"DISABLED","keyPrefix":"g","pointInTimeRecoveryEnablement":"POINT_IN_TIME_RECOVERY_DISABLED","deleteProtectionState":"DELETE_PROTECTION_DISABLED","databaseEdition":"STANDARD","freeTier":true,"realtimeUpdatesMode":"REALTIME_UPDATES_MODE_ENABLED","etag":"INyb8piHg5EDMMXn/oLW95AD"}
[debug] [2025-11-21T10:41:01.323Z] Skipping existing index: {"collectionGroup":"dailyInsights","queryScope":"COLLECTION","fields":[{"fieldPath":"published","order":"ASCENDING"},{"fieldPath":"createdAt","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}]}
[debug] [2025-11-21T10:41:01.324Z] Skipping existing index: {"collectionGroup":"notifications","queryScope":"COLLECTION","fields":[{"fieldPath":"status","order":"ASCENDING"},{"fieldPath":"createdAt","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}]}
[debug] [2025-11-21T10:41:01.324Z] Skipping existing index: {"collectionGroup":"faithLessons","queryScope":"COLLECTION","fields":[{"fieldPath":"category","order":"ASCENDING"},{"fieldPath":"priority","order":"ASCENDING"},{"fieldPath":"__name__","order":"ASCENDING"}]}
[debug] [2025-11-21T10:41:01.324Z] Skipping existing index: {"collectionGroup":"feeds","queryScope":"COLLECTION","fields":[{"fieldPath":"published","order":"ASCENDING"},{"fieldPath":"createdAt","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}]}
[debug] [2025-11-21T10:41:01.324Z] Skipping existing index: {"collectionGroup":"alerts","queryScope":"COLLECTION","fields":[{"fieldPath":"isActive","order":"ASCENDING"},{"fieldPath":"createdAt","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}]}
[debug] [2025-11-21T10:41:01.325Z] Skipping existing index: {"collectionGroup":"lessons","queryScope":"COLLECTION","fields":[{"fieldPath":"category","order":"ASCENDING"},{"fieldPath":"order","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}]}
[debug] [2025-11-21T10:41:01.325Z] Skipping existing index: {"collectionGroup":"lessons","queryScope":"COLLECTION","fields":[{"fieldPath":"category","order":"ASCENDING"},{"fieldPath":"createdAt","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}]}
[debug] [2025-11-21T10:41:01.325Z] Skipping existing index: {"collectionGroup":"news","queryScope":"COLLECTION","fields":[{"fieldPath":"isPublished","order":"ASCENDING"},{"fieldPath":"publishedAt","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}]}
[debug] [2025-11-21T10:41:01.325Z] Skipping existing index: {"collectionGroup":"news","queryScope":"COLLECTION","fields":[{"fieldPath":"category","order":"ASCENDING"},{"fieldPath":"publishedAt","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}]}
[debug] [2025-11-21T10:41:01.325Z] Skipping existing index: {"collectionGroup":"podcasts","queryScope":"COLLECTION","fields":[{"fieldPath":"isActive","order":"ASCENDING"},{"fieldPath":"order","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}]}
[debug] [2025-11-21T10:41:01.326Z] Skipping existing index: {"collectionGroup":"podcasts","queryScope":"COLLECTION","fields":[{"fieldPath":"isActive","order":"ASCENDING"},{"fieldPath":"createdAt","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}]}
[debug] [2025-11-21T10:41:01.326Z] Skipping existing index: {"collectionGroup":"dailyVideos","queryScope":"COLLECTION","fields":[{"fieldPath":"isActive","order":"ASCENDING"},{"fieldPath":"createdAt","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}]}
[debug] [2025-11-21T10:41:01.326Z] Skipping existing index: {"collectionGroup":"homeCards","queryScope":"COLLECTION","fields":[{"fieldPath":"isActive","order":"ASCENDING"},{"fieldPath":"order","order":"ASCENDING"},{"fieldPath":"__name__","order":"ASCENDING"}]}
[debug] [2025-11-21T10:41:01.326Z] Creating new index: {"collectionGroup":"flyers","queryScope":"COLLECTION","fields":[{"fieldPath":"isActive","order":"ASCENDING"},{"fieldPath":"date","order":"DESCENDING"}]}
[debug] [2025-11-21T10:41:01.326Z] Checked if tokens are valid: true, expires at: 1763725214504
[debug] [2025-11-21T10:41:01.326Z] Checked if tokens are valid: true, expires at: 1763725214504
[debug] [2025-11-21T10:41:01.327Z] >>> [apiv2][query] POST https://firestore.googleapis.com/v1/projects/eyalamrami-1d69e/databases/(default)/collectionGroups/flyers/indexes [none]
[debug] [2025-11-21T10:41:01.327Z] >>> [apiv2][body] POST https://firestore.googleapis.com/v1/projects/eyalamrami-1d69e/databases/(default)/collectionGroups/flyers/indexes {"fields":[{"fieldPath":"isActive","order":"ASCENDING"},{"fieldPath":"date","order":"DESCENDING"}],"queryScope":"COLLECTION"}
[debug] [2025-11-21T10:41:01.532Z] <<< [apiv2][status] POST https://firestore.googleapis.com/v1/projects/eyalamrami-1d69e/databases/(default)/collectionGroups/flyers/indexes 200
[debug] [2025-11-21T10:41:01.533Z] <<< [apiv2][body] POST https://firestore.googleapis.com/v1/projects/eyalamrami-1d69e/databases/(default)/collectionGroups/flyers/indexes {"name":"projects/eyalamrami-1d69e/databases/(default)/operations/S0VJb3JpTmdBQ0lDDCoDIDY3YzgzZWJjOWRjOC1mNjhhLTU4NzQtMWQzYS1kYTM4NTk3NyQac2VuaWxlcGlwCQpBEg","metadata":{"@type":"type.googleapis.com/google.firestore.admin.v1.IndexOperationMetadata","startTime":"2025-11-21T10:41:01.617960Z","index":"projects/eyalamrami-1d69e/databases/(default)/collectionGroups/flyers/indexes/CICAgNiroIEK","state":"INITIALIZING"}}
[info] ✔  firestore: deployed indexes in firestore.indexes.json successfully for (default) database 
[info] 
[info] ✔  Deploy complete! 
[info] 
[info] Project Console: https://console.firebase.google.com/project/eyalamrami-1d69e/overview
[debug] [2025-11-21T10:41:43.744Z] ----------------------------------------------------------------------
[debug] [2025-11-21T10:41:43.746Z] Command:       /opt/homebrew/Cellar/node/24.4.1/bin/node /opt/homebrew/bin/firebase deploy --only firestore:indexes
[debug] [2025-11-21T10:41:43.746Z] CLI Version:   14.25.1
[debug] [2025-11-21T10:41:43.746Z] Platform:      darwin
[debug] [2025-11-21T10:41:43.746Z] Node Version:  v24.4.1
[debug] [2025-11-21T10:41:43.746Z] Time:          Fri Nov 21 2025 12:41:43 GMT+0200 (Israel Standard Time)
[debug] [2025-11-21T10:41:43.746Z] ----------------------------------------------------------------------
[debug] 
[debug] [2025-11-21T10:41:43.837Z] > command requires scopes: ["email","openid","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","https://www.googleapis.com/auth/cloud-platform"]
[debug] [2025-11-21T10:41:43.838Z] > authorizing via signed-in user (orel895@gmail.com)
[debug] [2025-11-21T10:41:43.838Z] [iam] checking project eyalamrami-1d69e for permissions ["datastore.indexes.create","datastore.indexes.delete","datastore.indexes.list","datastore.indexes.update","firebase.projects.get"]
[debug] [2025-11-21T10:41:43.839Z] Checked if tokens are valid: true, expires at: 1763725214504
[debug] [2025-11-21T10:41:43.839Z] Checked if tokens are valid: true, expires at: 1763725214504
[debug] [2025-11-21T10:41:43.839Z] >>> [apiv2][query] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions [none]
[debug] [2025-11-21T10:41:43.839Z] >>> [apiv2][(partial)header] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions x-goog-quota-user=projects/eyalamrami-1d69e
[debug] [2025-11-21T10:41:43.839Z] >>> [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions {"permissions":["datastore.indexes.create","datastore.indexes.delete","datastore.indexes.list","datastore.indexes.update","firebase.projects.get"]}
[debug] [2025-11-21T10:41:44.970Z] <<< [apiv2][status] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions 200
[debug] [2025-11-21T10:41:44.971Z] <<< [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions {"permissions":["datastore.indexes.create","datastore.indexes.delete","datastore.indexes.list","datastore.indexes.update","firebase.projects.get"]}
[info] 
[info] === Deploying to 'eyalamrami-1d69e'...
[info] 
[info] i  deploying firestore 
[info] i  firestore: ensuring required API firestore.googleapis.com is enabled... 
[info] i  firestore: ensuring required API firestore.googleapis.com is enabled... 
[debug] [2025-11-21T10:41:45.053Z] Checked if tokens are valid: true, expires at: 1763725214504
[debug] [2025-11-21T10:41:45.055Z] Checked if tokens are valid: true, expires at: 1763725214504
[debug] [2025-11-21T10:41:45.059Z] >>> [apiv2][query] GET https://firestore.googleapis.com/v1/projects/eyalamrami-1d69e/databases/(default) [none]
[debug] [2025-11-21T10:41:45.601Z] <<< [apiv2][status] GET https://firestore.googleapis.com/v1/projects/eyalamrami-1d69e/databases/(default) 200
[debug] [2025-11-21T10:41:45.601Z] <<< [apiv2][body] GET https://firestore.googleapis.com/v1/projects/eyalamrami-1d69e/databases/(default) {"name":"projects/eyalamrami-1d69e/databases/(default)","uid":"28c72577-e069-422d-b53f-9211ba17d04d","createTime":"2025-11-16T21:56:31.041581Z","updateTime":"2025-11-16T21:56:31.041581Z","locationId":"europe-west2","type":"FIRESTORE_NATIVE","concurrencyMode":"PESSIMISTIC","versionRetentionPeriod":"3600s","earliestVersionTime":"2025-11-21T09:41:45.707521Z","appEngineIntegrationMode":"DISABLED","keyPrefix":"g","pointInTimeRecoveryEnablement":"POINT_IN_TIME_RECOVERY_DISABLED","deleteProtectionState":"DELETE_PROTECTION_DISABLED","databaseEdition":"STANDARD","freeTier":true,"realtimeUpdatesMode":"REALTIME_UPDATES_MODE_ENABLED","etag":"IISpga6Hg5EDMMXn/oLW95AD"}
[info] i  firestore: reading indexes from firestore.indexes.json... 
[info] i  cloud.firestore: checking firestore.rules for compilation errors... 
[debug] [2025-11-21T10:41:45.602Z] Checked if tokens are valid: true, expires at: 1763725214504
[debug] [2025-11-21T10:41:45.602Z] Checked if tokens are valid: true, expires at: 1763725214504
[debug] [2025-11-21T10:41:45.602Z] >>> [apiv2][query] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test [none]
[debug] [2025-11-21T10:41:45.602Z] >>> [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test [omitted]
[debug] [2025-11-21T10:41:46.403Z] <<< [apiv2][status] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test 200
[debug] [2025-11-21T10:41:46.404Z] <<< [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test {}
[info] ✔  cloud.firestore: rules file firestore.rules compiled successfully 
[info] i  firestore: deploying indexes... 
[debug] [2025-11-21T10:41:46.406Z] Checked if tokens are valid: true, expires at: 1763725214504
[debug] [2025-11-21T10:41:46.406Z] Checked if tokens are valid: true, expires at: 1763725214504
[debug] [2025-11-21T10:41:46.406Z] >>> [apiv2][query] GET https://firestore.googleapis.com/v1/projects/eyalamrami-1d69e/databases/(default)/collectionGroups/-/indexes [none]
[debug] [2025-11-21T10:41:46.532Z] <<< [apiv2][status] GET https://firestore.googleapis.com/v1/projects/eyalamrami-1d69e/databases/(default)/collectionGroups/-/indexes 200
[debug] [2025-11-21T10:41:46.533Z] <<< [apiv2][body] GET https://firestore.googleapis.com/v1/projects/eyalamrami-1d69e/databases/(default)/collectionGroups/-/indexes {"indexes":[{"name":"projects/eyalamrami-1d69e/databases/(default)/collectionGroups/news/indexes/CICAgNiav4AK","queryScope":"COLLECTION","fields":[{"fieldPath":"isPublished","order":"ASCENDING"},{"fieldPath":"publishedAt","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}],"state":"READY","density":"SPARSE_ALL"},{"name":"projects/eyalamrami-1d69e/databases/(default)/collectionGroups/feeds/indexes/CICAgJim14AK","queryScope":"COLLECTION","fields":[{"fieldPath":"published","order":"ASCENDING"},{"fieldPath":"createdAt","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}],"state":"READY","density":"SPARSE_ALL"},{"name":"projects/eyalamrami-1d69e/databases/(default)/collectionGroups/dailyInsights/indexes/CICAgOjXh4EK","queryScope":"COLLECTION","fields":[{"fieldPath":"published","order":"ASCENDING"},{"fieldPath":"createdAt","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}],"state":"READY","density":"SPARSE_ALL"},{"name":"projects/eyalamrami-1d69e/databases/(default)/collectionGroups/flyers/indexes/CICAgNiroIEK","queryScope":"COLLECTION","fields":[{"fieldPath":"isActive","order":"ASCENDING"},{"fieldPath":"date","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}],"state":"CREATING","density":"SPARSE_ALL"},{"name":"projects/eyalamrami-1d69e/databases/(default)/collectionGroups/lessons/indexes/CICAgJj7z4EK","queryScope":"COLLECTION","fields":[{"fieldPath":"category","order":"ASCENDING"},{"fieldPath":"order","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}],"state":"READY","density":"SPARSE_ALL"},{"name":"projects/eyalamrami-1d69e/databases/(default)/collectionGroups/podcasts/indexes/CICAgNjpgYIK","queryScope":"COLLECTION","fields":[{"fieldPath":"isActive","order":"ASCENDING"},{"fieldPath":"order","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}],"state":"READY","density":"SPARSE_ALL"},{"name":"projects/eyalamrami-1d69e/databases/(default)/collectionGroups/alerts/indexes/CICAgJjF9oIK","queryScope":"COLLECTION","fields":[{"fieldPath":"isActive","order":"ASCENDING"},{"fieldPath":"createdAt","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}],"state":"READY","density":"SPARSE_ALL"},{"name":"projects/eyalamrami-1d69e/databases/(default)/collectionGroups/notifications/indexes/CICAgJiUpoMK","queryScope":"COLLECTION","fields":[{"fieldPath":"status","order":"ASCENDING"},{"fieldPath":"createdAt","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}],"state":"READY","density":"SPARSE_ALL"},{"name":"projects/eyalamrami-1d69e/databases/(default)/collectionGroups/lessons/indexes/CICAgNi47oMK","queryScope":"COLLECTION","fields":[{"fieldPath":"category","order":"ASCENDING"},{"fieldPath":"createdAt","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}],"state":"READY","density":"SPARSE_ALL"},{"name":"projects/eyalamrami-1d69e/databases/(default)/collectionGroups/dailyVideos/indexes/CICAgJjmnIgK","queryScope":"COLLECTION","fields":[{"fieldPath":"isActive","order":"ASCENDING"},{"fieldPath":"createdAt","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}],"state":"READY","density":"SPARSE_ALL"},{"name":"projects/eyalamrami-1d69e/databases/(default)/collectionGroups/homeCards/indexes/CICAgNi4o4sK","queryScope":"COLLECTION","fields":[{"fieldPath":"isActive","order":"ASCENDING"},{"fieldPath":"order","order":"ASCENDING"},{"fieldPath":"__name__","order":"ASCENDING"}],"state":"READY","density":"SPARSE_ALL"},{"name":"projects/eyalamrami-1d69e/databases/(default)/collectionGroups/faithLessons/indexes/CICAgOi3kJAK","queryScope":"COLLECTION","fields":[{"fieldPath":"category","order":"ASCENDING"},{"fieldPath":"priority","order":"ASCENDING"},{"fieldPath":"__name__","order":"ASCENDING"}],"state":"READY","density":"SPARSE_ALL"},{"name":"projects/eyalamrami-1d69e/databases/(default)/collectionGroups/news/indexes/CICAgJjmiJEK","queryScope":"COLLECTION","fields":[{"fieldPath":"category","order":"ASCENDING"},{"fieldPath":"publishedAt","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}],"state":"READY","density":"SPARSE_ALL"},{"name":"projects/eyalamrami-1d69e/databases/(default)/collectionGroups/podcasts/indexes/CICAgNi4-ZIK","queryScope":"COLLECTION","fields":[{"fieldPath":"isActive","order":"ASCENDING"},{"fieldPath":"createdAt","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}],"state":"READY","density":"SPARSE_ALL"}]}
[debug] [2025-11-21T10:41:46.533Z] Checked if tokens are valid: true, expires at: 1763725214504
[debug] [2025-11-21T10:41:46.533Z] Checked if tokens are valid: true, expires at: 1763725214504
[debug] [2025-11-21T10:41:46.533Z] >>> [apiv2][query] GET https://firestore.googleapis.com/v1/projects/eyalamrami-1d69e/databases/(default)/collectionGroups/-/fields?filter=indexConfig.usesAncestorConfig=false OR ttlConfig:* [none]
[debug] [2025-11-21T10:41:46.646Z] <<< [apiv2][status] GET https://firestore.googleapis.com/v1/projects/eyalamrami-1d69e/databases/(default)/collectionGroups/-/fields?filter=indexConfig.usesAncestorConfig=false OR ttlConfig:* 200
[debug] [2025-11-21T10:41:46.646Z] <<< [apiv2][body] GET https://firestore.googleapis.com/v1/projects/eyalamrami-1d69e/databases/(default)/collectionGroups/-/fields?filter=indexConfig.usesAncestorConfig=false OR ttlConfig:* {"fields":[{"name":"projects/eyalamrami-1d69e/databases/(default)/collectionGroups/__default__/fields/*","indexConfig":{"indexes":[{"queryScope":"COLLECTION","fields":[{"fieldPath":"*","order":"ASCENDING"}],"state":"READY"},{"queryScope":"COLLECTION","fields":[{"fieldPath":"*","order":"DESCENDING"}],"state":"READY"},{"queryScope":"COLLECTION","fields":[{"fieldPath":"*","arrayConfig":"CONTAINS"}],"state":"READY"}]}}]}
[debug] [2025-11-21T10:41:46.646Z] Checked if tokens are valid: true, expires at: 1763725214504
[debug] [2025-11-21T10:41:46.646Z] Checked if tokens are valid: true, expires at: 1763725214504
[debug] [2025-11-21T10:41:46.646Z] >>> [apiv2][query] GET https://firestore.googleapis.com/v1/projects/eyalamrami-1d69e/databases/(default) [none]
[debug] [2025-11-21T10:41:46.745Z] <<< [apiv2][status] GET https://firestore.googleapis.com/v1/projects/eyalamrami-1d69e/databases/(default) 200
[debug] [2025-11-21T10:41:46.745Z] <<< [apiv2][body] GET https://firestore.googleapis.com/v1/projects/eyalamrami-1d69e/databases/(default) {"name":"projects/eyalamrami-1d69e/databases/(default)","uid":"28c72577-e069-422d-b53f-9211ba17d04d","createTime":"2025-11-16T21:56:31.041581Z","updateTime":"2025-11-16T21:56:31.041581Z","locationId":"europe-west2","type":"FIRESTORE_NATIVE","concurrencyMode":"PESSIMISTIC","versionRetentionPeriod":"3600s","earliestVersionTime":"2025-11-21T09:41:46.853367Z","appEngineIntegrationMode":"DISABLED","keyPrefix":"g","pointInTimeRecoveryEnablement":"POINT_IN_TIME_RECOVERY_DISABLED","deleteProtectionState":"DELETE_PROTECTION_DISABLED","databaseEdition":"STANDARD","freeTier":true,"realtimeUpdatesMode":"REALTIME_UPDATES_MODE_ENABLED","etag":"INeix66Hg5EDMMXn/oLW95AD"}
[debug] [2025-11-21T10:41:46.746Z] Skipping existing index: {"collectionGroup":"dailyInsights","queryScope":"COLLECTION","fields":[{"fieldPath":"published","order":"ASCENDING"},{"fieldPath":"createdAt","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}]}
[debug] [2025-11-21T10:41:46.747Z] Skipping existing index: {"collectionGroup":"notifications","queryScope":"COLLECTION","fields":[{"fieldPath":"status","order":"ASCENDING"},{"fieldPath":"createdAt","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}]}
[debug] [2025-11-21T10:41:46.747Z] Skipping existing index: {"collectionGroup":"faithLessons","queryScope":"COLLECTION","fields":[{"fieldPath":"category","order":"ASCENDING"},{"fieldPath":"priority","order":"ASCENDING"},{"fieldPath":"__name__","order":"ASCENDING"}]}
[debug] [2025-11-21T10:41:46.747Z] Skipping existing index: {"collectionGroup":"feeds","queryScope":"COLLECTION","fields":[{"fieldPath":"published","order":"ASCENDING"},{"fieldPath":"createdAt","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}]}
[debug] [2025-11-21T10:41:46.747Z] Skipping existing index: {"collectionGroup":"alerts","queryScope":"COLLECTION","fields":[{"fieldPath":"isActive","order":"ASCENDING"},{"fieldPath":"createdAt","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}]}
[debug] [2025-11-21T10:41:46.747Z] Skipping existing index: {"collectionGroup":"lessons","queryScope":"COLLECTION","fields":[{"fieldPath":"category","order":"ASCENDING"},{"fieldPath":"order","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}]}
[debug] [2025-11-21T10:41:46.747Z] Skipping existing index: {"collectionGroup":"lessons","queryScope":"COLLECTION","fields":[{"fieldPath":"category","order":"ASCENDING"},{"fieldPath":"createdAt","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}]}
[debug] [2025-11-21T10:41:46.747Z] Skipping existing index: {"collectionGroup":"news","queryScope":"COLLECTION","fields":[{"fieldPath":"isPublished","order":"ASCENDING"},{"fieldPath":"publishedAt","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}]}
[debug] [2025-11-21T10:41:46.747Z] Skipping existing index: {"collectionGroup":"news","queryScope":"COLLECTION","fields":[{"fieldPath":"category","order":"ASCENDING"},{"fieldPath":"publishedAt","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}]}
[debug] [2025-11-21T10:41:46.747Z] Skipping existing index: {"collectionGroup":"podcasts","queryScope":"COLLECTION","fields":[{"fieldPath":"isActive","order":"ASCENDING"},{"fieldPath":"order","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}]}
[debug] [2025-11-21T10:41:46.747Z] Skipping existing index: {"collectionGroup":"podcasts","queryScope":"COLLECTION","fields":[{"fieldPath":"isActive","order":"ASCENDING"},{"fieldPath":"createdAt","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}]}
[debug] [2025-11-21T10:41:46.747Z] Skipping existing index: {"collectionGroup":"dailyVideos","queryScope":"COLLECTION","fields":[{"fieldPath":"isActive","order":"ASCENDING"},{"fieldPath":"createdAt","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}]}
[debug] [2025-11-21T10:41:46.748Z] Skipping existing index: {"collectionGroup":"homeCards","queryScope":"COLLECTION","fields":[{"fieldPath":"isActive","order":"ASCENDING"},{"fieldPath":"order","order":"ASCENDING"},{"fieldPath":"__name__","order":"ASCENDING"}]}
[debug] [2025-11-21T10:41:46.748Z] Skipping existing index: {"collectionGroup":"flyers","queryScope":"COLLECTION","fields":[{"fieldPath":"isActive","order":"ASCENDING"},{"fieldPath":"date","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}]}
[info] ✔  firestore: deployed indexes in firestore.indexes.json successfully for (default) database 
[info] 
[info] ✔  Deploy complete! 
[info] 
[info] Project Console: https://console.firebase.google.com/project/eyalamrami-1d69e/overview
[debug] [2025-11-21T10:44:12.327Z] ----------------------------------------------------------------------
[debug] [2025-11-21T10:44:12.329Z] Command:       /opt/homebrew/Cellar/node/24.4.1/bin/node /opt/homebrew/bin/firebase firestore:indexes
[debug] [2025-11-21T10:44:12.329Z] CLI Version:   14.25.1
[debug] [2025-11-21T10:44:12.330Z] Platform:      darwin
[debug] [2025-11-21T10:44:12.330Z] Node Version:  v24.4.1
[debug] [2025-11-21T10:44:12.330Z] Time:          Fri Nov 21 2025 12:44:12 GMT+0200 (Israel Standard Time)
[debug] [2025-11-21T10:44:12.330Z] ----------------------------------------------------------------------
[debug] 
[debug] [2025-11-21T10:44:12.414Z] > command requires scopes: ["email","openid","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","https://www.googleapis.com/auth/cloud-platform"]
[debug] [2025-11-21T10:44:12.415Z] > authorizing via signed-in user (orel895@gmail.com)
[debug] [2025-11-21T10:44:12.415Z] [iam] checking project eyalamrami-1d69e for permissions ["datastore.indexes.list","firebase.projects.get"]
[debug] [2025-11-21T10:44:12.415Z] Checked if tokens are valid: true, expires at: 1763725214504
[debug] [2025-11-21T10:44:12.416Z] Checked if tokens are valid: true, expires at: 1763725214504
[debug] [2025-11-21T10:44:12.416Z] >>> [apiv2][query] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions [none]
[debug] [2025-11-21T10:44:12.416Z] >>> [apiv2][(partial)header] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions x-goog-quota-user=projects/eyalamrami-1d69e
[debug] [2025-11-21T10:44:12.416Z] >>> [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions {"permissions":["datastore.indexes.list","firebase.projects.get"]}
[debug] [2025-11-21T10:44:13.395Z] <<< [apiv2][status] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions 200
[debug] [2025-11-21T10:44:13.396Z] <<< [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions {"permissions":["datastore.indexes.list","firebase.projects.get"]}
[debug] [2025-11-21T10:44:13.396Z] Checked if tokens are valid: true, expires at: 1763725214504
[debug] [2025-11-21T10:44:13.396Z] Checked if tokens are valid: true, expires at: 1763725214504
[debug] [2025-11-21T10:44:13.397Z] >>> [apiv2][query] GET https://firestore.googleapis.com/v1/projects/eyalamrami-1d69e/databases/(default)/collectionGroups/-/indexes [none]
[debug] [2025-11-21T10:44:13.943Z] <<< [apiv2][status] GET https://firestore.googleapis.com/v1/projects/eyalamrami-1d69e/databases/(default)/collectionGroups/-/indexes 200
[debug] [2025-11-21T10:44:13.944Z] <<< [apiv2][body] GET https://firestore.googleapis.com/v1/projects/eyalamrami-1d69e/databases/(default)/collectionGroups/-/indexes {"indexes":[{"name":"projects/eyalamrami-1d69e/databases/(default)/collectionGroups/news/indexes/CICAgNiav4AK","queryScope":"COLLECTION","fields":[{"fieldPath":"isPublished","order":"ASCENDING"},{"fieldPath":"publishedAt","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}],"state":"READY","density":"SPARSE_ALL"},{"name":"projects/eyalamrami-1d69e/databases/(default)/collectionGroups/feeds/indexes/CICAgJim14AK","queryScope":"COLLECTION","fields":[{"fieldPath":"published","order":"ASCENDING"},{"fieldPath":"createdAt","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}],"state":"READY","density":"SPARSE_ALL"},{"name":"projects/eyalamrami-1d69e/databases/(default)/collectionGroups/dailyInsights/indexes/CICAgOjXh4EK","queryScope":"COLLECTION","fields":[{"fieldPath":"published","order":"ASCENDING"},{"fieldPath":"createdAt","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}],"state":"READY","density":"SPARSE_ALL"},{"name":"projects/eyalamrami-1d69e/databases/(default)/collectionGroups/flyers/indexes/CICAgNiroIEK","queryScope":"COLLECTION","fields":[{"fieldPath":"isActive","order":"ASCENDING"},{"fieldPath":"date","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}],"state":"READY","density":"SPARSE_ALL"},{"name":"projects/eyalamrami-1d69e/databases/(default)/collectionGroups/lessons/indexes/CICAgJj7z4EK","queryScope":"COLLECTION","fields":[{"fieldPath":"category","order":"ASCENDING"},{"fieldPath":"order","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}],"state":"READY","density":"SPARSE_ALL"},{"name":"projects/eyalamrami-1d69e/databases/(default)/collectionGroups/podcasts/indexes/CICAgNjpgYIK","queryScope":"COLLECTION","fields":[{"fieldPath":"isActive","order":"ASCENDING"},{"fieldPath":"order","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}],"state":"READY","density":"SPARSE_ALL"},{"name":"projects/eyalamrami-1d69e/databases/(default)/collectionGroups/alerts/indexes/CICAgJjF9oIK","queryScope":"COLLECTION","fields":[{"fieldPath":"isActive","order":"ASCENDING"},{"fieldPath":"createdAt","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}],"state":"READY","density":"SPARSE_ALL"},{"name":"projects/eyalamrami-1d69e/databases/(default)/collectionGroups/notifications/indexes/CICAgJiUpoMK","queryScope":"COLLECTION","fields":[{"fieldPath":"status","order":"ASCENDING"},{"fieldPath":"createdAt","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}],"state":"READY","density":"SPARSE_ALL"},{"name":"projects/eyalamrami-1d69e/databases/(default)/collectionGroups/lessons/indexes/CICAgNi47oMK","queryScope":"COLLECTION","fields":[{"fieldPath":"category","order":"ASCENDING"},{"fieldPath":"createdAt","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}],"state":"READY","density":"SPARSE_ALL"},{"name":"projects/eyalamrami-1d69e/databases/(default)/collectionGroups/dailyVideos/indexes/CICAgJjmnIgK","queryScope":"COLLECTION","fields":[{"fieldPath":"isActive","order":"ASCENDING"},{"fieldPath":"createdAt","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}],"state":"READY","density":"SPARSE_ALL"},{"name":"projects/eyalamrami-1d69e/databases/(default)/collectionGroups/homeCards/indexes/CICAgNi4o4sK","queryScope":"COLLECTION","fields":[{"fieldPath":"isActive","order":"ASCENDING"},{"fieldPath":"order","order":"ASCENDING"},{"fieldPath":"__name__","order":"ASCENDING"}],"state":"READY","density":"SPARSE_ALL"},{"name":"projects/eyalamrami-1d69e/databases/(default)/collectionGroups/faithLessons/indexes/CICAgOi3kJAK","queryScope":"COLLECTION","fields":[{"fieldPath":"category","order":"ASCENDING"},{"fieldPath":"priority","order":"ASCENDING"},{"fieldPath":"__name__","order":"ASCENDING"}],"state":"READY","density":"SPARSE_ALL"},{"name":"projects/eyalamrami-1d69e/databases/(default)/collectionGroups/news/indexes/CICAgJjmiJEK","queryScope":"COLLECTION","fields":[{"fieldPath":"category","order":"ASCENDING"},{"fieldPath":"publishedAt","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}],"state":"READY","density":"SPARSE_ALL"},{"name":"projects/eyalamrami-1d69e/databases/(default)/collectionGroups/podcasts/indexes/CICAgNi4-ZIK","queryScope":"COLLECTION","fields":[{"fieldPath":"isActive","order":"ASCENDING"},{"fieldPath":"createdAt","order":"DESCENDING"},{"fieldPath":"__name__","order":"DESCENDING"}],"state":"READY","density":"SPARSE_ALL"}]}
[debug] [2025-11-21T10:44:13.944Z] Checked if tokens are valid: true, expires at: 1763725214504
[debug] [2025-11-21T10:44:13.944Z] Checked if tokens are valid: true, expires at: 1763725214504
[debug] [2025-11-21T10:44:13.944Z] >>> [apiv2][query] GET https://firestore.googleapis.com/v1/projects/eyalamrami-1d69e/databases/(default)/collectionGroups/-/fields?filter=indexConfig.usesAncestorConfig=false OR ttlConfig:* [none]
[debug] [2025-11-21T10:44:14.077Z] <<< [apiv2][status] GET https://firestore.googleapis.com/v1/projects/eyalamrami-1d69e/databases/(default)/collectionGroups/-/fields?filter=indexConfig.usesAncestorConfig=false OR ttlConfig:* 200
[debug] [2025-11-21T10:44:14.078Z] <<< [apiv2][body] GET https://firestore.googleapis.com/v1/projects/eyalamrami-1d69e/databases/(default)/collectionGroups/-/fields?filter=indexConfig.usesAncestorConfig=false OR ttlConfig:* {"fields":[{"name":"projects/eyalamrami-1d69e/databases/(default)/collectionGroups/__default__/fields/*","indexConfig":{"indexes":[{"queryScope":"COLLECTION","fields":[{"fieldPath":"*","order":"ASCENDING"}],"state":"READY"},{"queryScope":"COLLECTION","fields":[{"fieldPath":"*","order":"DESCENDING"}],"state":"READY"},{"queryScope":"COLLECTION","fields":[{"fieldPath":"*","arrayConfig":"CONTAINS"}],"state":"READY"}]}}]}
[info] {
  "indexes": [
    {
      "collectionGroup": "alerts",
      "queryScope": "COLLECTION",
      "fields": [
        {
          "fieldPath": "isActive",
          "order": "ASCENDING"
        },
        {
          "fieldPath": "createdAt",
          "order": "DESCENDING"
        },
        {
          "fieldPath": "__name__",
          "order": "DESCENDING"
        }
      ],
      "density": "SPARSE_ALL"
    },
    {
      "collectionGroup": "dailyInsights",
      "queryScope": "COLLECTION",
      "fields": [
        {
          "fieldPath": "published",
          "order": "ASCENDING"
        },
        {
          "fieldPath": "createdAt",
          "order": "DESCENDING"
        },
        {
          "fieldPath": "__name__",
          "order": "DESCENDING"
        }
      ],
      "density": "SPARSE_ALL"
    },
    {
      "collectionGroup": "dailyVideos",
      "queryScope": "COLLECTION",
      "fields": [
        {
          "fieldPath": "isActive",
          "order": "ASCENDING"
        },
        {
          "fieldPath": "createdAt",
          "order": "DESCENDING"
        },
        {
          "fieldPath": "__name__",
          "order": "DESCENDING"
        }
      ],
      "density": "SPARSE_ALL"
    },
    {
      "collectionGroup": "faithLessons",
      "queryScope": "COLLECTION",
      "fields": [
        {
          "fieldPath": "category",
          "order": "ASCENDING"
        },
        {
          "fieldPath": "priority",
          "order": "ASCENDING"
        },
        {
          "fieldPath": "__name__",
          "order": "ASCENDING"
        }
      ],
      "density": "SPARSE_ALL"
    },
    {
      "collectionGroup": "feeds",
      "queryScope": "COLLECTION",
      "fields": [
        {
          "fieldPath": "published",
          "order": "ASCENDING"
        },
        {
          "fieldPath": "createdAt",
          "order": "DESCENDING"
        },
        {
          "fieldPath": "__name__",
          "order": "DESCENDING"
        }
      ],
      "density": "SPARSE_ALL"
    },
    {
      "collectionGroup": "flyers",
      "queryScope": "COLLECTION",
      "fields": [
        {
          "fieldPath": "isActive",
          "order": "ASCENDING"
        },
        {
          "fieldPath": "date",
          "order": "DESCENDING"
        },
        {
          "fieldPath": "__name__",
          "order": "DESCENDING"
        }
      ],
      "density": "SPARSE_ALL"
    },
    {
      "collectionGroup": "homeCards",
      "queryScope": "COLLECTION",
      "fields": [
        {
          "fieldPath": "isActive",
          "order": "ASCENDING"
        },
        {
          "fieldPath": "order",
          "order": "ASCENDING"
        },
        {
          "fieldPath": "__name__",
          "order": "ASCENDING"
        }
      ],
      "density": "SPARSE_ALL"
    },
    {
      "collectionGroup": "lessons",
      "queryScope": "COLLECTION",
      "fields": [
        {
          "fieldPath": "category",
          "order": "ASCENDING"
        },
        {
          "fieldPath": "createdAt",
          "order": "DESCENDING"
        },
        {
          "fieldPath": "__name__",
          "order": "DESCENDING"
        }
      ],
      "density": "SPARSE_ALL"
    },
    {
      "collectionGroup": "lessons",
      "queryScope": "COLLECTION",
      "fields": [
        {
          "fieldPath": "category",
          "order": "ASCENDING"
        },
        {
          "fieldPath": "order",
          "order": "DESCENDING"
        },
        {
          "fieldPath": "__name__",
          "order": "DESCENDING"
        }
      ],
      "density": "SPARSE_ALL"
    },
    {
      "collectionGroup": "news",
      "queryScope": "COLLECTION",
      "fields": [
        {
          "fieldPath": "category",
          "order": "ASCENDING"
        },
        {
          "fieldPath": "publishedAt",
          "order": "DESCENDING"
        },
        {
          "fieldPath": "__name__",
          "order": "DESCENDING"
        }
      ],
      "density": "SPARSE_ALL"
    },
    {
      "collectionGroup": "news",
      "queryScope": "COLLECTION",
      "fields": [
        {
          "fieldPath": "isPublished",
          "order": "ASCENDING"
        },
        {
          "fieldPath": "publishedAt",
          "order": "DESCENDING"
        },
        {
          "fieldPath": "__name__",
          "order": "DESCENDING"
        }
      ],
      "density": "SPARSE_ALL"
    },
    {
      "collectionGroup": "notifications",
      "queryScope": "COLLECTION",
      "fields": [
        {
          "fieldPath": "status",
          "order": "ASCENDING"
        },
        {
          "fieldPath": "createdAt",
          "order": "DESCENDING"
        },
        {
          "fieldPath": "__name__",
          "order": "DESCENDING"
        }
      ],
      "density": "SPARSE_ALL"
    },
    {
      "collectionGroup": "podcasts",
      "queryScope": "COLLECTION",
      "fields": [
        {
          "fieldPath": "isActive",
          "order": "ASCENDING"
        },
        {
          "fieldPath": "createdAt",
          "order": "DESCENDING"
        },
        {
          "fieldPath": "__name__",
          "order": "DESCENDING"
        }
      ],
      "density": "SPARSE_ALL"
    },
    {
      "collectionGroup": "podcasts",
      "queryScope": "COLLECTION",
      "fields": [
        {
          "fieldPath": "isActive",
          "order": "ASCENDING"
        },
        {
          "fieldPath": "order",
          "order": "DESCENDING"
        },
        {
          "fieldPath": "__name__",
          "order": "DESCENDING"
        }
      ],
      "density": "SPARSE_ALL"
    }
  ],
  "fieldOverrides": []
}
[debug] [2025-11-21T10:45:57.549Z] ----------------------------------------------------------------------
[debug] [2025-11-21T10:45:57.551Z] Command:       /opt/homebrew/Cellar/node/24.4.1/bin/node /opt/homebrew/bin/firebase deploy --only firestore:rules
[debug] [2025-11-21T10:45:57.551Z] CLI Version:   14.25.1
[debug] [2025-11-21T10:45:57.551Z] Platform:      darwin
[debug] [2025-11-21T10:45:57.551Z] Node Version:  v24.4.1
[debug] [2025-11-21T10:45:57.551Z] Time:          Fri Nov 21 2025 12:45:57 GMT+0200 (Israel Standard Time)
[debug] [2025-11-21T10:45:57.551Z] ----------------------------------------------------------------------
[debug] 
[debug] [2025-11-21T10:45:57.647Z] > command requires scopes: ["email","openid","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","https://www.googleapis.com/auth/cloud-platform"]
[debug] [2025-11-21T10:45:57.648Z] > authorizing via signed-in user (orel895@gmail.com)
[debug] [2025-11-21T10:45:57.648Z] [iam] checking project eyalamrami-1d69e for permissions ["datastore.indexes.create","datastore.indexes.delete","datastore.indexes.list","datastore.indexes.update","firebase.projects.get"]
[debug] [2025-11-21T10:45:57.649Z] Checked if tokens are valid: true, expires at: 1763725214504
[debug] [2025-11-21T10:45:57.649Z] Checked if tokens are valid: true, expires at: 1763725214504
[debug] [2025-11-21T10:45:57.649Z] >>> [apiv2][query] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions [none]
[debug] [2025-11-21T10:45:57.649Z] >>> [apiv2][(partial)header] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions x-goog-quota-user=projects/eyalamrami-1d69e
[debug] [2025-11-21T10:45:57.649Z] >>> [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions {"permissions":["datastore.indexes.create","datastore.indexes.delete","datastore.indexes.list","datastore.indexes.update","firebase.projects.get"]}
[debug] [2025-11-21T10:45:58.650Z] <<< [apiv2][status] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions 200
[debug] [2025-11-21T10:45:58.650Z] <<< [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/eyalamrami-1d69e:testIamPermissions {"permissions":["datastore.indexes.create","datastore.indexes.delete","datastore.indexes.list","datastore.indexes.update","firebase.projects.get"]}
[info] 
[info] === Deploying to 'eyalamrami-1d69e'...
[info] 
[info] i  deploying firestore 
[info] i  firestore: ensuring required API firestore.googleapis.com is enabled... 
[info] i  firestore: ensuring required API firestore.googleapis.com is enabled... 
[debug] [2025-11-21T10:45:58.654Z] Checked if tokens are valid: true, expires at: 1763725214504
[debug] [2025-11-21T10:45:58.654Z] Checked if tokens are valid: true, expires at: 1763725214504
[debug] [2025-11-21T10:45:58.654Z] >>> [apiv2][query] GET https://firestore.googleapis.com/v1/projects/eyalamrami-1d69e/databases/(default) [none]
[debug] [2025-11-21T10:45:59.181Z] <<< [apiv2][status] GET https://firestore.googleapis.com/v1/projects/eyalamrami-1d69e/databases/(default) 200
[debug] [2025-11-21T10:45:59.181Z] <<< [apiv2][body] GET https://firestore.googleapis.com/v1/projects/eyalamrami-1d69e/databases/(default) {"name":"projects/eyalamrami-1d69e/databases/(default)","uid":"28c72577-e069-422d-b53f-9211ba17d04d","createTime":"2025-11-16T21:56:31.041581Z","updateTime":"2025-11-16T21:56:31.041581Z","locationId":"europe-west2","type":"FIRESTORE_NATIVE","concurrencyMode":"PESSIMISTIC","versionRetentionPeriod":"3600s","earliestVersionTime":"2025-11-21T09:45:59.289454Z","appEngineIntegrationMode":"DISABLED","keyPrefix":"g","pointInTimeRecoveryEnablement":"POINT_IN_TIME_RECOVERY_DISABLED","deleteProtectionState":"DELETE_PROTECTION_DISABLED","databaseEdition":"STANDARD","freeTier":true,"realtimeUpdatesMode":"REALTIME_UPDATES_MODE_ENABLED","etag":"IPXf9qaIg5EDMMXn/oLW95AD"}
[info] i  firestore: reading indexes from firestore.indexes.json... 
[info] i  cloud.firestore: checking firestore.rules for compilation errors... 
[debug] [2025-11-21T10:45:59.183Z] Checked if tokens are valid: true, expires at: 1763725214504
[debug] [2025-11-21T10:45:59.183Z] Checked if tokens are valid: true, expires at: 1763725214504
[debug] [2025-11-21T10:45:59.183Z] >>> [apiv2][query] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test [none]
[debug] [2025-11-21T10:45:59.183Z] >>> [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test [omitted]
[debug] [2025-11-21T10:45:59.592Z] <<< [apiv2][status] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test 200
[debug] [2025-11-21T10:45:59.592Z] <<< [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e:test {}
[info] ✔  cloud.firestore: rules file firestore.rules compiled successfully 
[debug] [2025-11-21T10:45:59.594Z] Checked if tokens are valid: true, expires at: 1763725214504
[debug] [2025-11-21T10:45:59.594Z] Checked if tokens are valid: true, expires at: 1763725214504
[debug] [2025-11-21T10:45:59.594Z] >>> [apiv2][query] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases pageSize=10&pageToken=
[debug] [2025-11-21T10:45:59.910Z] <<< [apiv2][status] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases 200
[debug] [2025-11-21T10:45:59.910Z] <<< [apiv2][body] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases {"releases":[{"name":"projects/eyalamrami-1d69e/releases/cloud.firestore","rulesetName":"projects/eyalamrami-1d69e/rulesets/85775f06-7868-4a44-97b7-63a1e1fa3f32","createTime":"2025-11-16T21:56:37.010939Z","updateTime":"2025-11-21T10:40:21.137191Z"},{"name":"projects/eyalamrami-1d69e/releases/firebase.storage/eyalamrami-1d69e.firebasestorage.app","rulesetName":"projects/eyalamrami-1d69e/rulesets/c1233528-4ec5-4321-9e10-6dd88935fb68","createTime":"2025-11-16T21:57:38.715272Z","updateTime":"2025-11-21T10:08:05.471990Z"}]}
[debug] [2025-11-21T10:45:59.934Z] Checked if tokens are valid: true, expires at: 1763725214504
[debug] [2025-11-21T10:45:59.934Z] Checked if tokens are valid: true, expires at: 1763725214504
[debug] [2025-11-21T10:45:59.934Z] >>> [apiv2][query] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets/85775f06-7868-4a44-97b7-63a1e1fa3f32 [none]
[debug] [2025-11-21T10:46:00.742Z] <<< [apiv2][status] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets/85775f06-7868-4a44-97b7-63a1e1fa3f32 200
[debug] [2025-11-21T10:46:00.742Z] <<< [apiv2][body] GET https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets/85775f06-7868-4a44-97b7-63a1e1fa3f32 [omitted]
[info] i  firestore: uploading rules firestore.rules... 
[debug] [2025-11-21T10:46:00.744Z] Checked if tokens are valid: true, expires at: 1763725214504
[debug] [2025-11-21T10:46:00.744Z] Checked if tokens are valid: true, expires at: 1763725214504
[debug] [2025-11-21T10:46:00.744Z] >>> [apiv2][query] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets [none]
[debug] [2025-11-21T10:46:00.744Z] >>> [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets [omitted]
[debug] [2025-11-21T10:46:01.592Z] <<< [apiv2][status] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets 200
[debug] [2025-11-21T10:46:01.592Z] <<< [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/rulesets {"name":"projects/eyalamrami-1d69e/rulesets/90cb5922-f5b7-418c-ad64-57bbcb21b82d","source":{"files":[{"content":"rules_version = '2';\nservice cloud.firestore {\n  match /databases/{database}/documents {\n    \n    // ========== HELPER FUNCTIONS ==========\n    \n    function isSignedIn() {\n      return request.auth != null;\n    }\n    \n    function isAdmin() {\n      return isSignedIn() &&\n             get(/databases/$(database)/documents/users/$(request.auth.uid)).data.role == 'admin';\n    }\n    \n    // ========== USERS COLLECTION ==========\n    match /users/{uid} {\n      // Users can read/write their own document\n      allow read: if request.auth != null && request.auth.uid == uid;\n      allow write: if request.auth != null && request.auth.uid == uid;\n      \n      // Admins can write role field\n      allow update: if isAdmin() && \n                    request.resource.data.diff(resource.data).affectedKeys().hasOnly(['role']);\n    }\n    \n    // ========== DAILY INSIGHTS COLLECTION ==========\n    match /dailyInsights/{dateId} {\n      // Everyone can read published insights\n      allow read: if true;\n      \n      // Only admins can write\n      allow write: if isAdmin();\n    }\n    \n    // ========== DAILY STORIES COLLECTION ==========\n    match /dailyStories/{dateId}/clips/{clipId} {\n      // Everyone can read stories\n      allow read: if true;\n      \n      // Only admins can write\n      allow write: if isAdmin();\n    }\n    \n    // ========== NOTIFICATIONS COLLECTION ==========\n    match /notifications/{notificationId} {\n      // Only admins can read/write\n      allow read, write: if isAdmin();\n    }\n    \n    // ========== FEEDS COLLECTION ==========\n    match /feeds/{feedId} {\n      // Everyone can read published feeds, admins can read all\n      allow read: if resource.data.published == true || isAdmin();\n      \n      // Only admins can write\n      allow write: if isAdmin();\n    }\n    \n    // ========== FAITH LESSONS COLLECTION ==========\n    match /faithLessons/{lessonId} {\n      // Public read for published lessons\n      allow read: if resource.data.published == true || isAdmin();\n      \n      // Only admins can write\n      allow write: if isAdmin();\n    }\n    \n    // ========== LESSONS COLLECTION ==========\n    match /lessons/{lessonId} {\n      // Public read for all (lessons should be accessible to everyone)\n      allow read: if true;\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== PODCASTS COLLECTION ==========\n    match /podcasts/{podcastId} {\n      // Everyone can read active podcasts (public)\n      allow read: if resource.data.isActive == true;\n      // Admins can read all (including inactive)\n      allow read: if isAdmin();\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== DAILY VIDEOS COLLECTION ==========\n    match /dailyVideos/{videoId} {\n      // Everyone can read active videos (public)\n      // Default to true if isActive field is missing (backward compatibility)\n      allow read: if resource.data.isActive != false;\n      // Admins can read all (including inactive)\n      allow read: if isAdmin();\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== NEWS COLLECTION ==========\n    match /news/{newsId} {\n      // Published news can be read by everyone (public)\n      allow read: if resource.data.isPublished == true;\n      // Admins can read all (including drafts)\n      allow read: if isAdmin();\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== ALERTS COLLECTION ==========\n    match /alerts/{alertId} {\n      // Everyone can read active alerts (public)\n      allow read: if resource.data.isActive == true;\n      // Admins can read all (including inactive)\n      allow read: if isAdmin();\n      // Only admins can create, update, delete\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== HOME CARDS COLLECTION ==========\n    match /homeCards/{cardId} {\n      // Public read for all\n      allow read: if true;\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== APP CONFIG COLLECTION ==========\n    match /appConfig/{configId} {\n      // Public read\n      allow read: if true;\n      // Only admins can modify\n      allow write: if isAdmin();\n    }\n\n    // ========== INSTITUTIONS COLLECTION ==========\n    match /institutions/{institutionId} {\n      // Public read for all\n      allow read: if true;\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== INSTITUTIONS CONTENT COLLECTION ==========\n    match /institutionsContent/{activityId} {\n      // All signed-in users can read institution content\n      allow read: if isSignedIn();\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== BOOKS COLLECTION ==========\n    match /books/{bookId} {\n      // All signed-in users can read books\n      allow read: if isSignedIn();\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== FLYERS COLLECTION ==========\n    match /flyers/{flyerId} {\n      // Everyone can read active flyers (public)\n      // Default to true if isActive field is missing (backward compatibility)\n      allow read: if resource.data.isActive != false;\n      // Admins can read all (including inactive)\n      allow read: if isAdmin();\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== COMMUNITY POSTS COLLECTION ==========\n    match /communityPosts/{postId} {\n      // Everyone can read active community posts (public)\n      allow read: if resource.data.isActive == true;\n      // Admins can read all (including inactive)\n      allow read: if isAdmin();\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== LEADS COLLECTION ==========\n    match /leads/{leadId} {\n      // Anyone can create a lead (for contact forms)\n      allow create: if true;\n      // Only admins can read leads\n      allow read, update, delete: if isAdmin();\n    }\n\n    // ========== FAITH STORIES COLLECTION ==========\n    match /faith_stories/{storyId} {\n      // Admins can read all stories\n      allow read: if isAdmin();\n      // Signed-in users can read active stories\n      allow read: if isSignedIn() && resource.data.isActive == true;\n      // Only admins can modify\n      allow create, update, delete: if isAdmin();\n    }\n\n    // ========== DEFAULT DENY ==========\n    match /{document=**} {\n      allow read, write: if false;\n    }\n  }\n}\n","name":"firestore.rules"}]},"createTime":"2025-11-21T10:46:01.610015Z","metadata":{"services":["cloud.firestore"]}}
[debug] [2025-11-21T10:46:01.592Z] [rules] created ruleset projects/eyalamrami-1d69e/rulesets/90cb5922-f5b7-418c-ad64-57bbcb21b82d
[debug] [2025-11-21T10:46:01.593Z] [rules] releasing cloud.firestore/(default) with ruleset projects/eyalamrami-1d69e/rulesets/90cb5922-f5b7-418c-ad64-57bbcb21b82d
[debug] [2025-11-21T10:46:01.593Z] Checked if tokens are valid: true, expires at: 1763725214504
[debug] [2025-11-21T10:46:01.593Z] Checked if tokens are valid: true, expires at: 1763725214504
[debug] [2025-11-21T10:46:01.594Z] >>> [apiv2][query] PATCH https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases/cloud.firestore/(default) [none]
[debug] [2025-11-21T10:46:01.594Z] >>> [apiv2][body] PATCH https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases/cloud.firestore/(default) {"release":{"name":"projects/eyalamrami-1d69e/releases/cloud.firestore/(default)","rulesetName":"projects/eyalamrami-1d69e/rulesets/90cb5922-f5b7-418c-ad64-57bbcb21b82d"}}
[debug] [2025-11-21T10:46:02.006Z] <<< [apiv2][status] PATCH https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases/cloud.firestore/(default) 200
[debug] [2025-11-21T10:46:02.007Z] <<< [apiv2][body] PATCH https://firebaserules.googleapis.com/v1/projects/eyalamrami-1d69e/releases/cloud.firestore/(default) {"name":"projects/eyalamrami-1d69e/releases/cloud.firestore","rulesetName":"projects/eyalamrami-1d69e/rulesets/90cb5922-f5b7-418c-ad64-57bbcb21b82d","createTime":"2025-11-16T21:56:37.010939Z","updateTime":"2025-11-21T10:46:02.044282Z"}
[debug] [2025-11-21T10:46:02.007Z] [rules] updated release projects/eyalamrami-1d69e/releases/cloud.firestore
[info] ✔  firestore: released rules firestore.rules to cloud.firestore 
[info] 
[info] ✔  Deploy complete! 
[info] 
[info] Project Console: https://console.firebase.google.com/project/eyalamrami-1d69e/overview
